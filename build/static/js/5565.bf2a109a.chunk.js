"use strict";(self.webpackChunkreact_admin=self.webpackChunkreact_admin||[]).push([[5565,5841,8222],{4162:(e,t,o)=>{o.d(t,{A:()=>u});var r=o(58168),n=o(98587),l=o(63462),a=o(95006),i=o(46004),s=o(9523);const d=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],c=["component","slots","slotProps"],p=["component"];function u(e,t){const{className:o,elementType:u,ownerState:v,externalForwardedProps:m,getSlotOwnerState:f,internalForwardedProps:h}=t,A=(0,n.A)(t,d),{component:x,slots:y={[e]:void 0},slotProps:g={[e]:void 0}}=m,j=(0,n.A)(m,c),C=y[e]||u,S=(0,i.A)(g[e],v),b=(0,s.A)((0,r.A)({className:o},A,{externalForwardedProps:"root"===e?j:void 0,externalSlotProps:S})),{props:{component:R},internalRef:w}=b,N=(0,n.A)(b.props,p),k=(0,l.A)(w,null==S?void 0:S.ref,t.ref),I=f?f(N):{},M=(0,r.A)({},v,I),P="root"===e?R||x:R,O=(0,a.A)(C,(0,r.A)({},"root"===e&&!x&&!y[e]&&h,"root"!==e&&!y[e]&&h,N,P&&{as:P},{ref:k}),M);return Object.keys(I).forEach((e=>{delete O[e]})),[C,O]}},17555:(e,t,o)=>{var r=o(24994);t.A=void 0;var n=r(o(40039)),l=o(70579);t.A=(0,n.default)((0,l.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1z"}),"Lock")},68957:(e,t,o)=>{o.r(t),o.d(t,{default:()=>N});var r=o(89379),n=o(80045),l=o(65043),a=o(26240),i=o(46946),s=o(94496),d=o(42788),c=o(72882),p=o(97334),u=o(83462),v=o(4219),m=o(97368),f=o(39336),h=o(71861),A=o(92064),x=o(48292),y=o(9551),g=o(70579);const j=function(e){let{open:t,onClose:o,receipt:r,onConfirm:n,loading:a,theme:j}=e;const[C,S]=(0,l.useState)(""),[b,R]=(0,l.useState)(""),w=()=>{S(""),R(""),o()};return(0,g.jsxs)(u.A,{open:t,onClose:(e,t)=>{"backdropClick"!==t&&"escapeKeyDown"!==t&&w()},maxWidth:"sm",fullWidth:!0,disableEnforceFocus:!0,children:[(0,g.jsx)(v.A,{children:"Reversal Request"}),(0,g.jsxs)(m.A,{children:[(0,g.jsxs)(i.A,{mb:3,p:2,borderRadius:2,sx:{boxShadow:"inset 0px 0px 3px 2px #0000008a"},bgcolor:"light"===j.palette.mode&&"#f9f9f9",children:[(0,g.jsx)(s.A,{variant:"h6",gutterBottom:!0,children:"\ud83d\udcc4 Receipt Summary"}),(0,g.jsxs)(i.A,{display:"flex",justifyContent:"space-between",py:.5,children:[(0,g.jsx)(s.A,{color:"text.secondary",children:"Receipt No:"}),(0,g.jsx)(s.A,{fontWeight:600,children:null===r||void 0===r?void 0:r.referenceNo})]}),(0,g.jsxs)(i.A,{display:"flex",justifyContent:"space-between",py:.5,children:[(0,g.jsx)(s.A,{color:"text.secondary",children:"Patient Name:"}),(0,g.jsx)(s.A,{fontWeight:600,children:null===r||void 0===r?void 0:r.patientName})]}),(0,g.jsxs)(i.A,{display:"flex",justifyContent:"space-between",py:.5,children:[(0,g.jsx)(s.A,{color:"text.secondary",children:"Payment Reason:"}),(0,g.jsx)(s.A,{fontWeight:500,children:null===r||void 0===r?void 0:r.paymentReason})]}),(0,g.jsxs)(i.A,{display:"flex",justifyContent:"space-between",py:.5,children:[(0,g.jsx)(s.A,{color:"text.secondary",children:"Amount Paid:"}),(0,g.jsx)(s.A,{fontWeight:700,color:"green",children:(0,y.formatAccounting)(null===r||void 0===r?void 0:r.paymentAmount)})]}),(0,g.jsxs)(i.A,{display:"flex",justifyContent:"space-between",py:.5,children:[(0,g.jsx)(s.A,{color:"text.secondary",children:"Date:"}),(0,g.jsx)(s.A,{fontStyle:"italic",fontWeight:500,children:(0,x.renderETDateAtCell)(null===r||void 0===r?void 0:r.registeredOn)})]})]}),(0,g.jsx)(f.A,{}),(0,g.jsx)(i.A,{mt:5,children:(0,g.jsx)(d.A,{label:"Reason for Reversal",multiline:!0,fullWidth:!0,rows:3,required:!0,onChange:e=>(e=>{try{S(e.target.value)}catch(b){console.error("This is handle change error: ",b)}})(e),InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===j.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===j.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===j.palette.mode?"#fff":"#000"},color:"dark"===j.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===j.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===j.palette.mode?"#fff":"#000"}}}})}),b&&(0,g.jsx)(i.A,{mt:2,children:(0,g.jsx)(h.A,{severity:"error",children:b})})]}),(0,g.jsxs)(A.A,{children:[(0,g.jsx)(c.A,{onClick:w,color:"inherit",children:"Cancel"}),(0,g.jsx)(c.A,{variant:"contained",color:"error",onClick:()=>(()=>{try{if(!C.trim())return void R("Reversal reason is required.");if(C.length<10)return void R("Please describe it using more than 10 characters.");if(!/^[a-zA-Z0-9\u1200-\u137F\s]+$/.test(e=C)&&e.length>0)return void R("Please insert letters or numbers only.");const t={paymentRefNo:null===r||void 0===r?void 0:r.referenceNo,paymentType:(null===r||void 0===r?void 0:r.paymentType)||"-",cardNumber:(null===r||void 0===r?void 0:r.patientCardNumber)||"-",amount:[{amount:-(null===r||void 0===r?void 0:r.paymentAmount)||0,purpose:(null===r||void 0===r?void 0:r.paymentReason)||"-"}],description:C||"-",channel:(null===r||void 0===r?void 0:r.paymentChannel)||"-",organization:(null===r||void 0===r?void 0:r.patientWorkingPlace)||"-",paymentVerifingID:(null===r||void 0===r?void 0:r.paymentVerifingID)||"-",patientWorkID:(null===r||void 0===r?void 0:r.patientWorkID)||"-",reverse:!0};n(t)}catch(b){console.error(b)}var e})(),children:a?(0,g.jsx)(p.A,{size:24,color:"inherit"}):"Confirm Reversal"})]})]})};var C=o(57488),S=(o(92342),o(77265)),b=o(17555),R=o(51325);const w=["rowId"],N=()=>{const[e,t]=(0,l.useState)(""),[o,u]=(0,l.useState)([]),[v,m]=(0,l.useState)(null),[f,h]=(0,l.useState)(!1),[A,N]=(0,l.useState)(!1),[k,I]=(0,l.useState)(!1),[M,P]=(0,l.useState)(""),[O,z]=(0,l.useState)(!1),T=(0,a.A)(),W=/^[a-zA-Z0-9-]+$/,L=[{field:"referenceNo",headerName:"Receipt No",flex:1},{field:"patientCardNumber",headerName:"Card Number",flex:1},{field:"patientName",headerName:"Patient",flex:1},{field:"paymentAmount",headerName:"Amount",flex:1,renderCell:e=>{var t;return(0,y.formatAccounting2)(null===e||void 0===e||null===(t=e.row)||void 0===t?void 0:t.paymentAmount)}},{field:"paymentType",headerName:"Type",flex:1},{field:"paymentReason",headerName:"Reason",flex:1},{field:"registeredOn",headerName:"Date",flex:1,renderCell:e=>{var t;return(0,x.renderETDateAtCell)(null===e||void 0===e||null===(t=e.row)||void 0===t?void 0:t.registeredOn)}},{field:"Status",headerName:"Status",flex:1,renderCell:e=>{var t;return(null===e||void 0===e||null===(t=e.row)||void 0===t?void 0:t.isReversed)&&(0,g.jsxs)("p",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start",padding:0,marginTop:"0",color:"red",gap:"3px"},children:[(0,g.jsx)(b.A,{color:"error",fontSize:"small"}),(0,g.jsx)("span",{children:"Reversed"})]})}}];return(0,g.jsxs)(i.A,{p:3,children:[(0,g.jsx)(s.A,{variant:"h5",gutterBottom:!0,children:"Receipt Reversal"}),(0,g.jsxs)(i.A,{display:"flex",alignItems:"center",gap:2,mb:2,children:[(0,g.jsx)(d.A,{label:"Search by Reference",variant:"outlined",size:"small",value:e,onChange:e=>{var o;t(e.target.value),o=e.target.value,!W.test(o)&&(null===o||void 0===o?void 0:o.length)>0?P("Please Insert Valid Receipt Number."):P("")},error:!!M,helperText:M,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},color:"dark"===T.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===T.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===T.palette.mode?"#fff":"#000"}}}}),(0,g.jsx)(c.A,{variant:"contained",color:"light"===T.palette.mode?"primary":"secondary",disabled:A,onClick:()=>(async()=>{try{var t,o;if(N(!0),(null===e||void 0===e?void 0:e.length)<=0)return void C.oR.error("Please Insert Reference Number First.");if(M)return void C.oR.error("Please Insert (VALID) Reference Number.");u([]);const l=await S.A.put("/Payment/payment-by-refno",{paymentId:e}),a=(null===l||void 0===l||null===(t=l.data)||void 0===t?void 0:t.length)>0?null===l||void 0===l||null===(o=l.data)||void 0===o?void 0:o.map((e=>{let{rowId:t}=e,o=(0,n.A)(e,w);return(0,r.A)({id:t},o)})):[];if((null===a||void 0===a?void 0:a.length)<=0)return void C.oR.info("Data not found.");u(a)}catch(i){var l,a;console.error("This is search error: ",i),C.oR.error((null===i||void 0===i||null===(l=i.response)||void 0===l||null===(a=l.data)||void 0===a?void 0:a.msg)||"Unable to search.")}finally{N(!1)}})(),children:A?(0,g.jsx)(p.A,{size:24,color:"inherit"}):"Search"})]}),(0,g.jsx)(i.A,{justifySelf:"flex-end",sx:{margin:"10px"},children:O?(0,g.jsx)(p.A,{size:24,color:"inherit"}):(0,g.jsx)(c.A,{variant:"contained",color:"warning",onClick:()=>(async()=>{try{if(z(!0),(null===o||void 0===o?void 0:o.length)<=0)return void C.oR.error("No Data.");const e=await o.reduce(((e,t)=>{for(const o in t)"paymentAmount"===o?e.paymentAmount=(e.paymentAmount||0)+t.paymentAmount:"paymentReason"===o?e.paymentReason=e.paymentReason?e.paymentReason+", "+t.paymentReason:t.paymentReason:e[o]=e[o]||t[o];return e}),{});return m(e),z(!1),void h(!0)}catch(e){console.error("This is handle Open Modal handler Error: ",e)}finally{z(!1)}})(),disabled:O||(null===o||void 0===o?void 0:o.some((e=>!0===e.isReversed))),children:"Reverse"})}),(0,g.jsx)(R.A,{rows:o,columns:L,loading:A}),(0,g.jsx)(j,{open:f,onClose:()=>{h(!1),m(null),I(!1)},receipt:v,onConfirm:async e=>{try{I(!0);const o=await S.A.post("/Payment/add-payment",e,{headers:{"Content-Type":"application/json"}});200===(null===o||void 0===o?void 0:o.status)&&(C.oR.success("Transaction Reversed Successfully."),h(!1),u([]),t(""))}catch(n){var o,r;console.error("This is reversal handler error: ",n),C.oR.error((null===n||void 0===n||null===(o=n.response)||void 0===o||null===(r=o.data)||void 0===r?void 0:r.msg)||"Something went wrong! Unable to reverse.")}finally{I(!1)}},loading:k,theme:T}),(0,g.jsx)(C.N9,{})]})}},70962:(e,t,o)=>{o.d(t,{A:()=>a,X:()=>l});var r=o(92532),n=o(72372);function l(e){return(0,n.Ay)("MuiAlert",e)}const a=(0,r.A)("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"])},71861:(e,t,o)=>{o.d(t,{A:()=>I});var r=o(98587),n=o(58168),l=o(65043),a=o(58387),i=o(98610),s=o(67266),d=o(34535),c=o(98206),p=o(4162),u=o(6803),v=o(65204),m=o(70962),f=o(71716),h=o(66734),A=o(70579);const x=(0,h.A)((0,A.jsx)("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),y=(0,h.A)((0,A.jsx)("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),g=(0,h.A)((0,A.jsx)("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),j=(0,h.A)((0,A.jsx)("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined");var C=o(16871);const S=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],b=(0,d.Ay)(v.A,{name:"MuiAlert",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[o.variant],t["".concat(o.variant).concat((0,u.A)(o.color||o.severity))]]}})((e=>{let{theme:t}=e;const o="light"===t.palette.mode?s.e$:s.a,r="light"===t.palette.mode?s.a:s.e$;return(0,n.A)({},t.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(t.palette).filter((e=>{let[,t]=e;return t.main&&t.light})).map((e=>{let[n]=e;return{props:{colorSeverity:n,variant:"standard"},style:{color:t.vars?t.vars.palette.Alert["".concat(n,"Color")]:o(t.palette[n].light,.6),backgroundColor:t.vars?t.vars.palette.Alert["".concat(n,"StandardBg")]:r(t.palette[n].light,.9),["& .".concat(m.A.icon)]:t.vars?{color:t.vars.palette.Alert["".concat(n,"IconColor")]}:{color:t.palette[n].main}}}})),...Object.entries(t.palette).filter((e=>{let[,t]=e;return t.main&&t.light})).map((e=>{let[r]=e;return{props:{colorSeverity:r,variant:"outlined"},style:{color:t.vars?t.vars.palette.Alert["".concat(r,"Color")]:o(t.palette[r].light,.6),border:"1px solid ".concat((t.vars||t).palette[r].light),["& .".concat(m.A.icon)]:t.vars?{color:t.vars.palette.Alert["".concat(r,"IconColor")]}:{color:t.palette[r].main}}}})),...Object.entries(t.palette).filter((e=>{let[,t]=e;return t.main&&t.dark})).map((e=>{let[o]=e;return{props:{colorSeverity:o,variant:"filled"},style:(0,n.A)({fontWeight:t.typography.fontWeightMedium},t.vars?{color:t.vars.palette.Alert["".concat(o,"FilledColor")],backgroundColor:t.vars.palette.Alert["".concat(o,"FilledBg")]}:{backgroundColor:"dark"===t.palette.mode?t.palette[o].dark:t.palette[o].main,color:t.palette.getContrastText(t.palette[o].main)})}}))]})})),R=(0,d.Ay)("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(e,t)=>t.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),w=(0,d.Ay)("div",{name:"MuiAlert",slot:"Message",overridesResolver:(e,t)=>t.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),N=(0,d.Ay)("div",{name:"MuiAlert",slot:"Action",overridesResolver:(e,t)=>t.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),k={success:(0,A.jsx)(x,{fontSize:"inherit"}),warning:(0,A.jsx)(y,{fontSize:"inherit"}),error:(0,A.jsx)(g,{fontSize:"inherit"}),info:(0,A.jsx)(j,{fontSize:"inherit"})},I=l.forwardRef((function(e,t){const o=(0,c.b)({props:e,name:"MuiAlert"}),{action:l,children:s,className:d,closeText:v="Close",color:h,components:x={},componentsProps:y={},icon:g,iconMapping:j=k,onClose:I,role:M="alert",severity:P="success",slotProps:O={},slots:z={},variant:T="standard"}=o,W=(0,r.A)(o,S),L=(0,n.A)({},o,{color:h,severity:P,variant:T,colorSeverity:h||P}),D=(e=>{const{variant:t,color:o,severity:r,classes:n}=e,l={root:["root","color".concat((0,u.A)(o||r)),"".concat(t).concat((0,u.A)(o||r)),"".concat(t)],icon:["icon"],message:["message"],action:["action"]};return(0,i.A)(l,m.X,n)})(L),F={slots:(0,n.A)({closeButton:x.CloseButton,closeIcon:x.CloseIcon},z),slotProps:(0,n.A)({},y,O)},[E,V]=(0,p.A)("closeButton",{elementType:f.A,externalForwardedProps:F,ownerState:L}),[B,H]=(0,p.A)("closeIcon",{elementType:C.A,externalForwardedProps:F,ownerState:L});return(0,A.jsxs)(b,(0,n.A)({role:M,elevation:0,ownerState:L,className:(0,a.A)(D.root,d),ref:t},W,{children:[!1!==g?(0,A.jsx)(R,{ownerState:L,className:D.icon,children:g||j[P]||k[P]}):null,(0,A.jsx)(w,{ownerState:L,className:D.message,children:s}),null!=l?(0,A.jsx)(N,{ownerState:L,className:D.action,children:l}):null,null==l&&I?(0,A.jsx)(N,{ownerState:L,className:D.action,children:(0,A.jsx)(E,(0,n.A)({size:"small","aria-label":v,title:v,color:"inherit",onClick:I},V,{children:(0,A.jsx)(B,(0,n.A)({fontSize:"small"},H))}))}):null]}))}))}}]);
//# sourceMappingURL=5565.bf2a109a.chunk.js.map