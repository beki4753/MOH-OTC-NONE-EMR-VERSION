"use strict";(self.webpackChunkreact_admin=self.webpackChunkreact_admin||[]).push([[603,4383,5841,8222],{63777:(e,t,o)=>{o.d(t,{Ig:()=>d,LU:()=>l,b2:()=>c});var r=o(89379),a=o(65043),n=o(85557);const l=e=>(0,r.A)({},"dark"===e?{grey:{100:"#e0e0e0",200:"#c2c2c2",300:"#a3a3a3",400:"#858585",500:"#666666",600:"#525252",700:"#3d3d3d",800:"#292929",900:"#141414"},primary:{100:"#d0d1d5",200:"#a1a4ab",300:"#727681",400:"#1F2A40",500:"#141b2d",600:"#101624",700:"#0c101b",800:"#080b12",900:"#040509"},greenAccent:{100:"#dbf5ee",200:"#b7ebde",300:"#94e2cd",400:"#70d8bd",500:"#4cceac",600:"#3da58a",700:"#2e7c67",800:"#1e5245",900:"#0f2922"},redAccent:{100:"#f8dcdb",200:"#f1b9b7",300:"#e99592",400:"#e2726e",500:"#db4f4a",600:"#af3f3b",700:"#832f2c",800:"#58201e",900:"#2c100f"},blueAccent:{100:"#e1e2fe",200:"#c3c6fd",300:"#a4a9fc",400:"#868dfb",500:"#6870fa",600:"#535ac8",700:"#3e4396",800:"#2a2d64",900:"#151632"}}:{grey:{100:"#141414",200:"#292929",300:"#3d3d3d",400:"#525252",500:"#666666",600:"#858585",700:"#a3a3a3",800:"#c2c2c2",900:"#e0e0e0"},primary:{100:"#040509",200:"#080b12",300:"#0c101b",400:"#f2f0f0",500:"#141b2d",600:"#1F2A40",700:"#727681",800:"#a1a4ab",900:"#d0d1d5"},greenAccent:{100:"#0f2922",200:"#1e5245",300:"#2e7c67",400:"#3da58a",500:"#4cceac",600:"#70d8bd",700:"#94e2cd",800:"#b7ebde",900:"#dbf5ee"},redAccent:{100:"#2c100f",200:"#58201e",300:"#832f2c",400:"#af3f3b",500:"#db4f4a",600:"#e2726e",700:"#e99592",800:"#f1b9b7",900:"#f8dcdb"},blueAccent:{100:"#151632",200:"#2a2d64",300:"#3e4396",400:"#535ac8",500:"#6870fa",600:"#868dfb",700:"#a4a9fc",800:"#c3c6fd",900:"#e1e2fe"}}),d=(0,a.createContext)({toggleColorMode:()=>{}}),c=()=>{const[e,t]=(0,a.useState)("light"),o=(0,a.useMemo)((()=>({toggleColorMode:()=>t((e=>"light"===e?"dark":"light"))})),[]);return[(0,a.useMemo)((()=>(0,n.A)((e=>{const t=l(e);return{palette:(0,r.A)({mode:e},"dark"===e?{primary:{main:t.primary[500]},secondary:{main:t.greenAccent[500]},neutral:{dark:t.grey[700],main:t.grey[500],light:t.grey[100]},background:{default:t.primary[500]}}:{primary:{main:t.primary[100]},secondary:{main:t.greenAccent[500]},neutral:{dark:t.grey[700],main:t.grey[500],light:t.grey[100]},background:{default:"#fcfcfc"}}),typography:{fontFamily:["Source Sans Pro","sans-serif"].join(","),fontSize:12,h1:{fontFamily:["Source Sans Pro","sans-serif"].join(","),fontSize:40},h2:{fontFamily:["Source Sans Pro","sans-serif"].join(","),fontSize:32},h3:{fontFamily:["Source Sans Pro","sans-serif"].join(","),fontSize:24},h4:{fontFamily:["Source Sans Pro","sans-serif"].join(","),fontSize:20},h5:{fontFamily:["Source Sans Pro","sans-serif"].join(","),fontSize:16},h6:{fontFamily:["Source Sans Pro","sans-serif"].join(","),fontSize:14}}}})(e))),[e]),o]}},88810:(e,t,o)=>{o.r(t),o.d(t,{convertToEthDateWithTime:()=>k,default:()=>T});var r=o(89379),a=o(80045),n=o(65043),l=o(26240),d=o(46946),c=o(94496),i=o(65204),s=o(99784),u=o(1273),f=o(72882),m=o(61976),h=o(11238),g=o(77265),v=o(83074),p=o(57488),b=(o(92342),o(9551)),y=o(27073),A=o.n(y),S=o(81451),D=o(48292),x=o(63777),C=o(70579);const w=["collectionId"],j=(0,v.N8)();function k(e){try{if(!e)return"";const t=new Date(e.replace("T"," ")+" GMT+0300 (East Africa Time)");return S.N.fromEuropeanDate(t).toFullDateTimeString()}catch(t){return console.error("Ethiopian DateTime Conversion Error:",t),"Invalid Ethiopian Date"}}const T=()=>{const[e,t]=(0,n.useState)(""),[o,v]=(0,n.useState)(""),[y,S]=(0,n.useState)(!1),[T,E]=(0,n.useState)([]),[I,N]=(0,n.useState)([]),R=(0,l.A)(),F=(0,x.LU)(R.palette.mode),P={sdate:t,edate:v},z=(e,t)=>{try{const o=t instanceof Date?t:new Date(t);if(isNaN(o.getTime()))return console.error("Invalid date provided to handleChangeTime:",t),void p.oR.error("Invalid date selected.");const r=o.getTimezoneOffset(),a=new Date(o.getTime()-6e4*r).toISOString().split("T")[0];P[e](a)}catch(o){console.error("Date Picker Change Error:",o),p.oR.error("Unable to select the date properly.")}};(0,n.useEffect)((()=>{y&&(()=>{try{if(I.length>0){const e=null===I||void 0===I?void 0:I.filter((e=>!(y&&e.collectedAmount<Math.max(...null===I||void 0===I?void 0:I.map((e=>null===e||void 0===e?void 0:e.collectedAmount))))));E(e)}else p.oR.info("There is No High Amount!"),E([])}catch(e){return console.error(e),[]}})()}),[y]);return(0,C.jsxs)(d.A,{sx:{mx:"auto",p:{xs:2,sm:3},mt:4,borderRadius:2,boxShadow:3,marginInline:"15px"},children:[(0,C.jsx)(c.A,{variant:"h5",gutterBottom:!0,children:"Collection Report"}),(0,C.jsx)("form",{onSubmit:async t=>{try{var n;t.preventDefault();const l=await g.A.put("/Collection/Get-all-Collection",{startDate:e,endDate:o,user:null===j||void 0===j?void 0:j.name,isCollected:0});if((null===l||void 0===l?void 0:l.data.length)<=0)return void p.oR.info("Report not found!");const d=(null===l||void 0===l?void 0:l.data.length)>0&&(null===l||void 0===l||null===(n=l.data)||void 0===n?void 0:n.map((e=>{let{collectionId:t}=e,o=(0,a.A)(e,w);return(0,r.A)({id:t},o)})))||[];N(d)}catch(c){var l,d;console.error("Error fetching report data:",c),p.oR.error((null===c||void 0===c||null===(l=c.response)||void 0===l||null===(d=l.data)||void 0===d?void 0:d.msg)||"Internal Server Error!")}},children:(0,C.jsxs)(i.A,{sx:{padding:2,marginBottom:2,display:"flex",alignItems:"center",gap:2},children:[(0,C.jsx)(A(),{label:"Start Date",value:e.length>0?new Date(e):null,onChange:e=>{z("sdate",e),S(!1)},InputLabelProps:{shrink:!0},required:!0}),(0,C.jsx)(A(),{label:"End Date",value:(null===o||void 0===o?void 0:o.length)>0?new Date(o):null,onChange:e=>{z("edate",e),S(!1)},InputLabelProps:{shrink:!0},required:!0}),(0,C.jsx)(s.A,{control:(0,C.jsx)(u.A,{checked:y,onChange:e=>S(e.target.checked)}),label:"Show High Amount"}),(0,C.jsx)(f.A,{variant:"contained",color:"secondary",type:"submit",children:"Request Report"})]})}),(0,C.jsxs)(c.A,{variant:"h6",sx:{textAlign:"right",mb:1,fontWeight:"bold",color:F.greenAccent[500]},children:["Total Collected:"," ",(0,b.formatAccounting2)((y?T:I).reduce(((e,t)=>e+(t.collectedAmount||0)),0))]}),(0,C.jsx)(i.A,{sx:{height:400,marginBottom:2},children:(0,C.jsx)(m.z,{rows:y?T:I,columns:[{field:"id",headerName:"ID",width:40},{field:"fromDate",headerName:"Start Date",width:150,renderCell:e=>{var t;return(0,D.renderETDateAtCell)(null===e||void 0===e||null===(t=e.row)||void 0===t?void 0:t.fromDate)}},{field:"toDate",headerName:"End Date",width:140,renderCell:e=>{var t;return(0,D.renderETDateAtCell)(null===e||void 0===e||null===(t=e.row)||void 0===t?void 0:t.toDate)}},{field:"collectedAmount",headerName:"Amount",width:130,renderCell:e=>(0,b.formatAccounting2)(e.row.collectedAmount)},{field:"collectedBy",headerName:"Collector",width:200},{field:"casher",headerName:"Cashier",width:200},{field:"collectedOn",headerName:"Collected Date",width:170,renderCell:e=>{var t;return k(null===e||void 0===e||null===(t=e.row)||void 0===t?void 0:t.collectedOn)}}],autoHeight:!0,sx:{minWidth:320}})}),(0,C.jsx)(f.A,{variant:"contained",color:"primary",sx:{color:e=>e.palette.getContrastText(e.palette.primary.main),backgroundColor:e=>e.palette.secondary.main,"&:hover":{backgroundColor:e=>e.palette.primary.dark}},onClick:()=>(()=>{try{const t=T.length>0?T:I,r=null===t||void 0===t?void 0:t.map((e=>{let{collectedOn:t,createdOn:o,createdBy:r,id:a,collectedBy:n,collecterID:l,toDate:d,fromDate:c,collectedAmount:i,casher:s}=e;return{fromDate:(0,D.renderETDateAtCell)(c),toDate:(0,D.renderETDateAtCell)(d),collectedOn:k(t),collectedBy:n,collecterID:l,collectedAmount:i,casher:s,createdOn:o,createdBy:r}})),a=h.Wp.json_to_sheet(r),n=h.Wp.book_new();h.Wp.book_append_sheet(n,a,"Collection Report of ".concat(null===j||void 0===j?void 0:j.name)),h._h(n,"Collection_Report from ".concat(e," to ").concat(o,".xlsx"))}catch(t){console.error(t)}})(),children:"Export to Excel"}),(0,C.jsx)(p.N9,{})]})}}}]);
//# sourceMappingURL=4383.8225f2dc.chunk.js.map