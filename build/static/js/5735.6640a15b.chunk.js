"use strict";(self.webpackChunkreact_admin=self.webpackChunkreact_admin||[]).push([[2135,5735],{1291:(e,t,o)=>{o.r(t),o.d(t,{default:()=>i});var r=o(46946),a=o(37660),l=o(54582),n=o(70579);const i=()=>(0,n.jsxs)(r.A,{m:"20px",children:[(0,n.jsx)(a.A,{title:"Bar Chart",subtitle:"Simple Bar Chart"}),(0,n.jsx)(r.A,{height:"75vh",children:(0,n.jsx)(l.A,{})})]})},1302:(e,t,o)=>{o.r(t),o.d(t,{default:()=>R});var r=o(89379),a=o(65043),l=o(46946),n=o(65204),i=o(94496),d=o(8591),s=o(42788),c=o(56894),u=o(97334),p=o(39336),m=o(71716),f=o(72882),h=o(584),v=o(88911),x=o(69392),g=o(71062),A=o(26240),b=o(22505),y=o(63471),j=o(77265),C=o(61976),k=o(57488),O=(o(92342),o(74802)),I=o(47030),w=o(605),N=o(27631),S=o(9551),M=o(83074),P=o(70579);const D={medication:"",dosage:"",frequency:"",duration:"",instructions:""},R=()=>{const e=(0,A.A)(),[t,o]=(0,a.useState)(""),[R,T]=(0,a.useState)(""),[E,W]=(0,a.useState)(""),[L,q]=(0,a.useState)(!1),[z,B]=(0,a.useState)(!1),[F,U]=(0,a.useState)([D]),[H,G]=(0,a.useState)([D]),[Y,_]=(0,a.useState)([]),[Z,$]=(0,a.useState)(null),[K,V]=(0,a.useState)(!1),X="#3b8ada",Q="dark"===e.palette.mode?e.palette.background.paper:"#f5f8fd",J=()=>{V(!1),$(null)},ee=(e,t,o)=>{U((a=>a.map(((a,l)=>l===e?(0,r.A)((0,r.A)({},a),{},{[t]:o}):a)))),te(e,t,o)},te=(e,t,o)=>{!/^[A-Za-z0-9\s._]+$/.test(o)&&(null===o||void 0===o?void 0:o.length)>0?G((o=>o.map(((o,a)=>a===e?(0,r.A)((0,r.A)({},o),{},{[t]:"Only letters, numbers and spaces allowed."}):o)))):G((o=>o.map(((o,a)=>a===e?(0,r.A)((0,r.A)({},o),{},{[t]:""}):o))))},oe=async()=>{try{var e,t;const o=await j.A.get("/Request/doctor/get-request/Pharmacy"),r=(null===o||void 0===o||null===(e=o.data)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.value)||[],a=await(async e=>{try{const t=[];return e.forEach((e=>{const o=e.createdOn,r=e.patientCardNumber;if(!o||!r||!Array.isArray(e.requestedItems))return;let a=t.find((e=>e.patientCardNumber===r&&e.date===o));a||(a={patientCardNumber:r,date:o,patientInfo:{patientFirstName:e.patientFirstName,patientMiddleName:e.patientMiddleName,patientLastName:e.patientLastName,patientGender:e.patientGender},services:[]},t.push(a)),e.requestedItems.forEach((e=>{var t;const o=null===(t=e.requestedServices)||void 0===t?void 0:t.trim().toLowerCase();if(!o)return;const r=a.services.find((e=>e.requestedServices.trim().toLowerCase()===o));if(r){r.details.push(e);const t=parseInt(e.procedeureCount)||0;r.totalCount+=t}else a.services.push({requestedServices:e.requestedServices,totalCount:parseInt(e.procedeureCount)||0,details:[e]})}))})),t.sort(((e,t)=>new Date(t.date)-new Date(e.date))),t}catch(t){return console.error("Error during grouping:",t),[]}})(r),l=a.map(((e,t)=>{var o,r,a,l;return{id:t+1,cardNumber:e.patientCardNumber,date:e.date,patientName:[null===(o=e.patientInfo)||void 0===o?void 0:o.patientFirstName,null===(r=e.patientInfo)||void 0===r?void 0:r.patientMiddleName,null===(a=e.patientInfo)||void 0===a?void 0:a.patientLastName].filter(Boolean).join(" "),gender:null===(l=e.patientInfo)||void 0===l?void 0:l.patientGender,services:e.services}}));_(l)}catch(o){console.error("Error fetching pharmacy requests:",o)}};(0,a.useEffect)((()=>{oe()}),[]);return(0,P.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",p:2,background:"dark"===e.palette.mode?"linear-gradient(135deg, rgba(46, 138, 201, 0.1))":"linear-gradient(135deg, ".concat(e.palette.grey[100],", ").concat(e.palette.grey[300],")"),marginInline:"10px"},children:[(0,P.jsxs)(n.A,{elevation:6,sx:{width:"100%",p:4,borderRadius:3,backgroundColor:e.palette.background.paper},children:[(0,P.jsx)(i.A,{variant:"h4",align:"center",fontWeight:700,sx:{mb:4,color:"dark"===e.palette.mode?"#fff":"#000"},children:"Electronic Prescription"}),(0,P.jsxs)(d.Ay,{container:!0,spacing:3,children:[(0,P.jsx)(d.Ay,{item:!0,xs:12,md:6,children:(0,P.jsx)(s.A,{label:"Patient Card Number",value:t,onChange:e=>{var t;o(e.target.value),W(""),t=e.target.value,!/^[0-9a-zA-Z\s\_\-]{5,}$/.test(t)&&(null===t||void 0===t?void 0:t.length)>0?T("Please enter valid MRN (5+ digits)."):T("")},onBlur:async()=>{try{if(q(!0),t.length<=0||(null===E||void 0===E?void 0:E.length)>0||R)return;const e=await(0,M.rA)(t);e?W(e):(k.oR.error("Card Number Not Registered."),W(""))}catch(e){console.error("This is fetchPatientNames Error: ",e),k.oR.error("Error fetching patient info."),W("")}finally{q(!1)}},fullWidth:!0,error:!!R,helperText:R,InputProps:{endAdornment:L&&(0,P.jsx)(c.A,{position:"end",children:(0,P.jsx)(u.A,{size:24,color:"inherit"})}),sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},color:"dark"===e.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===e.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===e.palette.mode?"#fff":"#000"}}},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),(0,P.jsx)(d.Ay,{item:!0,xs:12,md:6,children:(0,P.jsx)(s.A,{label:"Patient Name",value:E,fullWidth:!0,disabled:!0,sx:{"& .MuiOutlinedInput-root":{borderRadius:2,backgroundColor:e.palette.action.disabledBackground}}})})]}),(0,P.jsx)(p.A,{sx:{my:4,color:"dark"===e.palette.mode?"#fff":"#000"}}),(0,P.jsx)(i.A,{variant:"h6",fontWeight:600,sx:{mb:2},children:"Prescription Medications"}),F.map(((t,o)=>{var r,a,n,i,c,u,p,f,h,v;return(0,P.jsx)(l.A,{sx:{mb:3,p:2,border:"1px solid ".concat(e.palette.divider),borderRadius:2,backgroundColor:e.palette.background.default},children:(0,P.jsxs)(d.Ay,{container:!0,spacing:2,children:[(0,P.jsx)(d.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,P.jsx)(s.A,{label:"Medication",value:t.medication,onChange:e=>ee(o,"medication",e.target.value),error:!(null===(r=H[o])||void 0===r||!r.medication),helperText:null===(a=H[o])||void 0===a?void 0:a.medication,fullWidth:!0,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},color:"dark"===e.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===e.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===e.palette.mode?"#fff":"#000"}}},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),(0,P.jsx)(d.Ay,{item:!0,xs:12,sm:6,md:2,children:(0,P.jsx)(s.A,{label:"Dosage",value:t.dosage,onChange:e=>ee(o,"dosage",e.target.value),fullWidth:!0,error:!(null===(n=H[o])||void 0===n||!n.dosage),helperText:null===(i=H[o])||void 0===i?void 0:i.dosage,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},color:"dark"===e.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===e.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===e.palette.mode?"#fff":"#000"}}},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),(0,P.jsx)(d.Ay,{item:!0,xs:12,sm:6,md:2,children:(0,P.jsx)(s.A,{label:"Frequency",value:t.frequency,onChange:e=>ee(o,"frequency",e.target.value),fullWidth:!0,error:!(null===(c=H[o])||void 0===c||!c.frequency),helperText:null===(u=H[o])||void 0===u?void 0:u.frequency,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},color:"dark"===e.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===e.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===e.palette.mode?"#fff":"#000"}}},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),(0,P.jsx)(d.Ay,{item:!0,xs:12,sm:6,md:2,children:(0,P.jsx)(s.A,{label:"Duration",value:t.duration,onChange:e=>ee(o,"duration",e.target.value),fullWidth:!0,error:!(null===(p=H[o])||void 0===p||!p.duration),helperText:null===(f=H[o])||void 0===f?void 0:f.duration,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},color:"dark"===e.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===e.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===e.palette.mode?"#fff":"#000"}}},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),(0,P.jsx)(d.Ay,{item:!0,xs:12,md:3,children:(0,P.jsxs)(l.A,{sx:{display:"flex",alignItems:"center"},children:[(0,P.jsx)(s.A,{label:"Instructions",value:t.instructions,onChange:e=>ee(o,"instructions",e.target.value),fullWidth:!0,error:!(null===(h=H[o])||void 0===h||!h.instructions),helperText:null===(v=H[o])||void 0===v?void 0:v.instructions,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},color:"dark"===e.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===e.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===e.palette.mode?"#fff":"#000"}}},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}}),F.length>1&&(0,P.jsx)(m.A,{onClick:()=>(e=>{F.length<=1?k.oR.warning("At least one medication is required."):(U((t=>t.filter(((t,o)=>o!==e)))),G((t=>t.filter(((t,o)=>o!==e)))))})(o),color:"error",sx:{ml:1},children:(0,P.jsx)(y.A,{})})]})})]})},o)})),(0,P.jsx)(f.A,{onClick:()=>{U([...F,D]),G([...H,D])},startIcon:(0,P.jsx)(b.A,{}),variant:"outlined",sx:e=>({mb:4,borderRadius:2,textTransform:"none",borderColor:"dark"===e.palette.mode?"#fff":e.palette.primary.main,color:"dark"===e.palette.mode?"#fff":e.palette.primary.main,"&:hover":{backgroundColor:"dark"===e.palette.mode?"rgba(255, 255, 255, 0.08)":e.palette.action.hover,borderColor:"dark"===e.palette.mode?"#fff":e.palette.primary.dark}}),children:"Add Another Medication"}),(0,P.jsxs)(l.A,{sx:{textAlign:"right",display:"flex",gap:2,justifyContent:"flex-end",flexWrap:"wrap"},children:[(0,P.jsx)(f.A,{onClick:()=>(W(""),o(""),T(""),U([D]),void G([D])),variant:"contained",size:"large",disabled:!t&&F.every((e=>!e.medication&&!e.dosage&&!e.frequency&&!e.duration&&!e.instructions)),sx:{borderRadius:3,px:4,py:1.6,fontWeight:600,textTransform:"none",backgroundColor:"error.main",color:"#fff",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",transition:"all 0.3s ease","&:hover":{backgroundColor:"error.dark",boxShadow:"0 6px 16px rgba(0, 0, 0, 0.2)"},"&:disabled":{backgroundColor:e=>e.palette.action.disabledBackground,color:e=>e.palette.action.disabled}},children:"Clear"}),(0,P.jsx)(f.A,{onClick:()=>(async()=>{try{if(B(!0),!t)return k.oR.warning("Enter and verify card number.");if(F.some((e=>!e.medication)))return k.oR.warning("Medication name is required.");if(null===H||void 0===H?void 0:H.some((e=>Object.values(e||{}).some((e=>(null===e||void 0===e?void 0:e.length)>0)))))return void k.oR.error("Please fix the error.");const e={patientCardnumber:t,reqestedTo:"pharmacy",requestItems:F.map((e=>({prodedures:e.medication,prodeduresCount:e.frequency,measurment:e.dosage,duration:e.duration,instruction:e.instructions})))},r=await j.A.post("/Request/doctor/order-request",e);200!==(null===r||void 0===r?void 0:r.status)&&201!==(null===r||void 0===r?void 0:r.status)||(k.oR.success("Prescription sent successfully"),oe(),W(""),o(""),U([D]),G([D]))}catch(a){var e,r;console.error("API errors:",a),k.oR.error(null===a||void 0===a||null===(e=a.response)||void 0===e||null===(r=e.data)||void 0===r?void 0:r.errorDescription)}finally{B(!1)}})(),variant:"contained",size:"large",disabled:!t||F.some((e=>!e.medication))||z,sx:e=>({borderRadius:3,px:4,py:1.6,fontWeight:600,gap:3,textTransform:"none",background:"dark"===e.palette.mode?"#ffffff":"#000000",color:"dark"===e.palette.mode?"#000000":"#ffffff",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",transition:"all 0.3s ease","&:hover":{background:"dark"===e.palette.mode?"#f0f0f0":"linear-gradient(135deg, ".concat(e.palette.primary.main,", ").concat(e.palette.primary.dark,")"),boxShadow:"0 6px 16px rgba(0, 0, 0, 0.2)"},"&:disabled":{backgroundColor:e.palette.action.disabledBackground,color:e.palette.action.disabled}}),children:z?(0,P.jsx)(u.A,{size:24,color:"inherit"}):"Send to Pharmacy"})]})]}),(0,P.jsxs)(n.A,{elevation:4,sx:{width:"100%",p:{xs:2,sm:3},borderRadius:3,backgroundColor:e.palette.background.paper,boxShadow:"0px 5px 15px rgba(0, 0, 0, 0.1)",mt:4},children:[(0,P.jsx)(i.A,{variant:"h6",fontWeight:600,sx:{mb:2,color:e.palette.text.primary},children:"Recently Sent Tests"}),(0,P.jsx)(l.A,{sx:{height:300,width:"100%"},children:(0,P.jsx)(C.z,{rows:Y,columns:[{field:"cardNumber",headerName:"Card Number",flex:1},{field:"patientName",headerName:"Patient Name",flex:1},{field:"gender",headerName:"Gender",flex:.8},{field:"date",headerName:"Date Requested",flex:1.2}],density:"comfortable",autoHeight:!0,sx:{"& .MuiDataGrid-columnHeaders":{backgroundColor:e.palette.primary.light+"15",fontWeight:"bold"},"& .MuiDataGrid-cell":{borderBottom:"1px dotted ".concat(e.palette.divider)},border:"none",minWidth:320},onRowDoubleClick:e=>{$(e.row),V(!0)}})}),(0,P.jsx)(h.Ay,{anchor:"right",open:K,onClose:J,children:(0,P.jsxs)(l.A,{sx:{width:{xs:"100vw",sm:480},height:"100%",display:"flex",flexDirection:"column",bgcolor:e.palette.background.default,color:e.palette.text.primary,px:3,pt:2,pb:3,fontFamily:"Roboto, 'Segoe UI', sans-serif"},children:[(0,P.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,P.jsxs)(v.A,{direction:"row",spacing:1,alignItems:"center",children:[(0,P.jsx)(I.A,{sx:{color:"#6870fa"},fontSize:"medium"}),(0,P.jsx)(i.A,{variant:"h6",fontWeight:600,sx:{color:"#6870fa"},children:"Request Details"})]}),(0,P.jsx)(x.A,{title:"Close",children:(0,P.jsx)(m.A,{onClick:J,size:"small",children:(0,P.jsx)(O.A,{})})})]}),(0,P.jsx)(p.A,{sx:{mb:2}}),(0,P.jsx)(l.A,{sx:{flexGrow:1,overflowY:"auto",pr:1},children:Z&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)(n.A,{elevation:3,sx:{p:2,mb:3,borderRadius:3,bgcolor:Q},children:[(0,P.jsxs)(v.A,{direction:"row",spacing:1,alignItems:"center",mb:1,children:[(0,P.jsx)(N.A,{sx:{color:e.palette.secondary.main},fontSize:"small"}),(0,P.jsx)(i.A,{variant:"subtitle1",fontWeight:600,sx:{color:X},children:"Patient Information"})]}),(0,P.jsxs)(i.A,{variant:"body1",sx:{mb:.5,color:"dark"===e.palette.mode?"#adadad":"#333"},children:[(0,P.jsx)("strong",{children:"Name:"})," ",Z.patientName]}),(0,P.jsxs)(i.A,{variant:"body1",sx:{mb:.5,color:"dark"===e.palette.mode?"#adadad":"#333"},children:[(0,P.jsx)("strong",{children:"Card Number:"})," ",Z.cardNumber]}),(0,P.jsxs)(i.A,{variant:"body1",sx:{mb:.5,color:"dark"===e.palette.mode?"#adadad":"#333"},children:[(0,P.jsx)("strong",{children:"Gender:"})," ",Z.gender]}),(0,P.jsxs)(i.A,{variant:"body1",sx:{color:"dark"===e.palette.mode?"#adadad":"#333"},children:[(0,P.jsx)("strong",{children:"Date:"})," ",Z.date]})]}),(0,P.jsxs)(v.A,{direction:"row",alignItems:"center",spacing:1,mb:1,children:[(0,P.jsx)(w.A,{sx:{color:"#6870fa"}}),(0,P.jsx)(i.A,{variant:"h6",fontWeight:600,sx:{color:"#6870fa"},children:"Requested Medications"})]}),(0,P.jsx)(g.A,{disablePadding:!0,children:Z.services.map(((t,o)=>(0,P.jsxs)(n.A,{elevation:2,sx:{p:2,mb:2,borderLeft:"6px solid ".concat("light"===e.palette.mode?"#333333cf":X),borderRadius:2,bgcolor:Q},children:[(0,P.jsx)(i.A,{variant:"subtitle1",fontWeight:600,sx:{color:"light"===e.palette.mode?"#7c7c7cf5":"#4cceac",mb:1},children:(0,S.capitalizeWords)(t.requestedServices)}),t.details.map(((t,o)=>(0,P.jsxs)(l.A,{sx:{ml:1.5,mt:1},children:[(0,P.jsxs)(i.A,{variant:"body2",color:"dark"===e.palette.mode?"#adadad":"#333",children:[(0,P.jsx)("strong",{children:"Count:"})," ",t.procedeureCount]}),(0,P.jsxs)(i.A,{variant:"body2",color:"dark"===e.palette.mode?"#adadad":"#333",children:[(0,P.jsx)("strong",{children:"Dosage:"})," ",t.measurement]}),(0,P.jsxs)(i.A,{variant:"body2",color:"dark"===e.palette.mode?"#adadad":"#333",children:[(0,P.jsx)("strong",{children:"Duration:"})," ",t.duration]}),(0,P.jsxs)(i.A,{variant:"body2",color:"dark"===e.palette.mode?"#adadad":"#333",children:[(0,P.jsx)("strong",{children:"Instructions:"})," ",t.instruction]})]},o)))]},o)))})]})})]})})]}),(0,P.jsx)(k.N9,{})]})}},8795:(e,t,o)=>{o.r(t),o.d(t,{default:()=>I});var r=o(80045),a=o(89379),l=o(65043),n=o(26240),i=o(71716),d=o(19252),s=o(94496),c=o(65204),u=o(72882),p=o(95540),m=o(63471),f=o(61976),h=o(11238),v=o(33086),x=o(62954),g=o(77265),A=o(57488),b=(o(92342),o(83074)),y=o(66974),j=o(16005),C=o(70579);const k=["HospitalName"],O=(0,b.N8)(),I=()=>{const[e,t]=(0,l.useState)([]),[o,b]=(0,l.useState)([]),[I,w]=(0,l.useState)(!1),[N,S]=(0,l.useState)(!1),[M,P]=(0,l.useState)(null),[D,R]=(0,l.useState)(!1),[T,E]=(0,l.useState)(!1),[W,L]=(0,l.useState)(""),q=(0,n.A)(),z=()=>{E(!1),L("")};(0,l.useEffect)((()=>{(async()=>{try{const e=await g.A.get("/Collection/collector");b((null===e||void 0===e?void 0:e.data)<=0?new Array:null===e||void 0===e?void 0:e.data)}catch(t){var e;console.error(t),A.oR.error((null===t||void 0===t||null===(e=t.response)||void 0===e?void 0:e.data)||"Failde To Load list.")}})()}),[I]);const B=[{field:"employeeID",headerName:"Employee ID",flex:1},{field:"employeeName",headerName:"Employee Name",flex:1},{field:"employeePhone",headerName:"Phone",flex:1},{field:"employeeEmail",headerName:"Email",flex:1},{field:"assignedAs",headerName:"Assigned As",flex:1},{field:"assignedBy",headerName:"Assigned By",flex:1},{field:"contactMethod",headerName:"Contact Method",flex:1},{field:"actions",headerName:"Actions",width:130,renderCell:e=>(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(i.A,{onClick:()=>(e=>{P(null===e||void 0===e?void 0:e.row),S(!0)})(e),color:"info","aria-label":"edit",className:"text-info",children:(0,C.jsx)(p.A,{})}),(0,C.jsx)(i.A,{color:"error",onClick:()=>(e=>{var t;L(null===e||void 0===e||null===(t=e.row)||void 0===t?void 0:t.employeeID),E(!0)})(e),"aria-label":"delete",className:"text-danger",children:(0,C.jsx)(m.A,{})})]})}];return(0,C.jsxs)(d.A,{children:[(0,C.jsx)(s.A,{variant:"h5",gutterBottom:!0,children:"Employee ID - Hospital Mapping"}),(0,C.jsxs)(c.A,{sx:{padding:2,marginBottom:2},children:[(0,C.jsx)("input",{accept:".xlsx, .xls",type:"file",onChange:e=>{(e=>{try{const o=e.target.files[0];if(!o)return;const l=new FileReader;l.onload=o=>{const l=new Uint8Array(o.target.result),n=h.LF(l,{type:"array"}),i=n.SheetNames[0],d=n.Sheets[i],s=h.Wp.sheet_to_json(d).map((e=>{let{HospitalName:t}=e,o=(0,r.A)(e,k);return(0,a.A)({assignedLocation:t},o)})).map(((e,t)=>(0,a.A)((0,a.A)({},e),{},{id:t+1})));t(s),e.target.value=null},l.readAsArrayBuffer(o)}catch(o){console.error(o)}})(e)},style:{display:"none"},id:"upload-excel"}),(0,C.jsx)("label",{htmlFor:"upload-excel",children:(0,C.jsx)(u.A,{variant:"contained",color:"light"===q.palette.mode?"primary":"secondary",component:"span",startIcon:(0,C.jsx)(x.A,{}),children:"Upload Excel"})}),(0,C.jsx)(i.A,{onClick:()=>{t([])},color:"error",sx:{marginLeft:2},children:(0,C.jsx)(v.A,{})}),(0,C.jsx)(u.A,{variant:"contained",color:"light"===q.palette.mode?"primary":"secondary",onClick:async()=>{try{await g.A.post("/Collection/register_collector",{employeeID:e.map((e=>null===e||void 0===e?void 0:e.employeeID)),employeeName:e.map((e=>null===e||void 0===e?void 0:e.employeeName)),employeePhone:e.map((e=>null===e||void 0===e?void 0:e.employeePhone)),employeeEmail:e.map((e=>null===e||void 0===e?void 0:e.employeeEmail)),assignedAs:e.map((e=>null===e||void 0===e?void 0:e.assignedAs)),assignedBy:e.map((e=>null===e||void 0===e?void 0:e.assignedBy)),contactMethod:e.map((e=>null===e||void 0===e?void 0:e.contactMethod)),user:null===O||void 0===O?void 0:O.name});A.oR.success("Upload Successful."),w((e=>!e)),t([])}catch(a){var o,r;console.error("Upload error:",a),A.oR.error((null===a||void 0===a||null===(o=a.response)||void 0===o?void 0:o.data.length)<=50?null===a||void 0===a||null===(r=a.response)||void 0===r?void 0:r.data:"File Upload Failed. please check if empty column exists.")}},sx:{marginLeft:2},disabled:0===e.length,children:"Upload to Database"}),(0,C.jsx)(s.A,{variant:"h6",sx:{m:"15px 0 5px 20px"},children:e.length>0?"Viewing from File":"Viewing Registered"})]}),(0,C.jsx)(c.A,{sx:{height:400},children:(0,C.jsx)(f.z,{rows:e.length<=0?o:e,columns:B,autoHeight:!0,sx:{minWidth:320},components:{ErrorOverlay:()=>(A.oR.error("Id Missing"),(0,C.jsx)("div",{style:{padding:"20px",color:"red"},children:"An error occurred: Id Missing"}))}})}),(0,C.jsx)(y.A,{open:N,onClose:()=>S(!1),staffData:M,onSave:async o=>{try{if(R(!0),(null===e||void 0===e?void 0:e.length)>0){const r=e.map((e=>e.id===o.id?(0,a.A)((0,a.A)({},e),o):e));t(r)}}catch(n){var r,l;console.error("Save Change Error: ",n),A.oR.error((null===n||void 0===n||null===(r=n.response)||void 0===r||null===(l=r.data)||void 0===l?void 0:l.message)||"Internal Server Error.")}finally{R(!1)}},isloading:D}),(0,C.jsx)(j.A,{isOpen:T,onClose:z,onConfirm:o=>{"Delete"===(null===o||void 0===o?void 0:o.message)&&(null===e||void 0===e?void 0:e.length)>0&&t((e=>e.filter((e=>e.employeeID!==(null===o||void 0===o?void 0:o.userData))))),z()},userData:W}),(0,C.jsx)(A.N9,{})]})}},9092:(e,t,o)=>{o.d(t,{A:()=>v});o(65043);var r=o(26240),a=o(83462),l=o(4219),n=o(71716),i=o(97368),d=o(46946),s=o(94496),c=o(92064),u=o(72882),p=o(74802),m=o(61976),f=o(9551),h=o(70579);function v(e){var t,o;let{open:v,onClose:x,rows:g}=e;const A=(0,r.A)(),b=(null===g||void 0===g||null===(t=g[0])||void 0===t?void 0:t.patientCardNumber)||"",y=(null===g||void 0===g||null===(o=g[0])||void 0===o?void 0:o.patientFName)||"",j=[{field:"catagory",headerName:"Category",flex:1,minWidth:120},{field:"service",headerName:"Services",flex:1,minWidth:120},{field:"amount",headerName:"Amount",flex:1,minWidth:120,renderCell:e=>{var t;return(0,f.formatAccounting2)(null===e||void 0===e||null===(t=e.row)||void 0===t?void 0:t.amount)}}];return(0,h.jsxs)(a.A,{open:v,onClose:(e,t)=>{"backdropClick"!==t&&"escapeKeyDown"!==t&&x()},maxWidth:"md",fullWidth:!0,scroll:"paper",disableEnforceFocus:!0,children:[(0,h.jsxs)(l.A,{sx:{m:0,p:2},children:["Payment Detail",(0,h.jsx)(n.A,{"aria-label":"close",onClick:x,sx:{position:"absolute",right:8,top:8,color:A.palette.grey[500]},children:(0,h.jsx)(p.A,{})})]}),(0,h.jsxs)(i.A,{dividers:!0,sx:{height:{xs:"60vh",sm:"70vh",md:"60vh"}},children:[(0,h.jsxs)(d.A,{sx:{mb:2,p:2,backgroundColor:"light"===A.palette.mode?A.palette.grey[100]:A.palette.grey[700],borderRadius:1,display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:"space-between",gap:2},children:[(0,h.jsxs)(s.A,{variant:"subtitle1",children:[(0,h.jsx)("strong",{children:"Card Number:"})," ",b]}),(0,h.jsxs)(s.A,{variant:"subtitle1",children:[(0,h.jsx)("strong",{children:"Patient Name:"})," ",y]})]}),(0,h.jsx)(m.z,{rows:g||[],columns:j,autoHeight:!0,disableSelectionOnClick:!0,sx:{"& .MuiDataGrid-columnHeaders":{backgroundColor:A.palette.action.hover},"& .MuiDataGrid-row:nth-of-type(odd)":{backgroundColor:A.palette.action.selected},minWidth:320}})]}),(0,h.jsx)(c.A,{children:(0,h.jsx)(u.A,{onClick:()=>x(),variant:"contained",color:"secondary",children:"Cancel"})})]})}},10665:(e,t,o)=>{o.d(t,{A:()=>d});var r=o(98286),a=o(63777),l=o(26240),n=o(29403),i=o(70579);const d=()=>{const e=(0,l.A)(),t=(0,a.LU)(e.palette.mode);return(0,i.jsx)(r.fO,{data:n.dp,theme:{axis:{domain:{line:{stroke:t.grey[100]}},legend:{text:{fill:t.grey[100]}},ticks:{line:{stroke:t.grey[100],strokeWidth:1},text:{fill:t.grey[100]}}},legends:{text:{fill:t.grey[100]}}},margin:{top:40,right:80,bottom:80,left:80},innerRadius:.5,padAngle:.7,cornerRadius:3,activeOuterRadiusOffset:8,borderColor:{from:"color",modifiers:[["darker",.2]]},arcLinkLabelsSkipAngle:10,arcLinkLabelsTextColor:t.grey[100],arcLinkLabelsThickness:2,arcLinkLabelsColor:{from:"color"},enableArcLabels:!1,arcLabelsRadiusOffset:.4,arcLabelsSkipAngle:7,arcLabelsTextColor:{from:"color",modifiers:[["darker",2]]},defs:[{id:"dots",type:"patternDots",background:"inherit",color:"rgba(255, 255, 255, 0.3)",size:4,padding:1,stagger:!0},{id:"lines",type:"patternLines",background:"inherit",color:"rgba(255, 255, 255, 0.3)",rotation:-45,lineWidth:6,spacing:10}],legends:[{anchor:"bottom",direction:"row",justify:!1,translateX:0,translateY:56,itemsSpacing:0,itemWidth:100,itemHeight:18,itemTextColor:"#999",itemDirection:"left-to-right",itemOpacity:1,symbolSize:18,symbolShape:"circle",effects:[{on:"hover",style:{itemTextColor:"#000"}}]}]})}},12379:(e,t,o)=>{o.r(t),o.d(t,{default:()=>F});var r=o(65043),a=o(72882),l=o(46946),n=o(94496),i=o(65204),d=o(19955),s=o(40360),c=o(97334),u=o(42788),p=o(8591),m=o(83462),f=o(4219),h=o(71716),v=o(97368),x=o(88911),g=o(92064),A=o(99784),b=o(1273),y=o(61976),j=o(99562),C=o(47805),k=o(57488),O=o(26240),I=o(77265),w=(o(92342),o(74802)),N=o(63713),S=o(1849),M=o(46873),P=o(56258),D=o(19778),R=o(63121),T=o(55134),E=o(47367),W=o(45465),L=o(83074),q=o(70579);const z=(e,t)=>{var o;try{switch((e||"").toLowerCase()){case"completed":return(0,q.jsx)(D.A,{fontSize:"small",sx:{color:"green"}});case"paid":return(0,q.jsx)(T.A,{fontSize:"small",sx:{color:"dark"===(null===t||void 0===t||null===(o=t.palette)||void 0===o?void 0:o.mode)?"#388ada":"blue"}});case"ordered":return(0,q.jsx)(E.A,{fontSize:"small",sx:{color:"orange"}});case"failed":return(0,q.jsx)(R.A,{fontSize:"small",sx:{color:"red"}});default:return(0,q.jsx)(W.A,{fontSize:"small",sx:{color:"grey.600"}})}}catch(r){console.error("This is getStatusIcon Error : ",r)}},B=(0,L.N8)(),F=()=>{var e,t,o;const D=(0,O.A)(),[R,T]=(0,r.useState)([]),[E,W]=(0,r.useState)(!1),[L,F]=(0,r.useState)(!1),[U,H]=(0,r.useState)("all"),[G,Y]=(0,r.useState)(""),[_,Z]=(0,r.useState)(!1),[$,K]=(0,r.useState)([]),[V,X]=(0,r.useState)(""),[Q,J]=(0,r.useState)(""),[ee,te]=(0,r.useState)(!1),[oe,re]=(0,r.useState)([]),[ae,le]=(0,r.useState)([]),[ne,ie]=(0,r.useState)({}),[de,se]=(0,r.useState)(!1),ce="light"===D.palette.mode?"#0078d7":D.palette.secondary.main;(0,r.useEffect)((()=>{(async()=>{W(!0);try{var e,t,o,r;T([]);const a=null!==B&&void 0!==B&&null!==(e=B.UserType)&&void 0!==e&&null!==(t=e.toLowerCase())&&void 0!==t&&t.includes("mlt")?"/Request/doctor/get-request-lab":"/Request/doctor/get-request-radiology",l=await I.A.get(a),n=(null===l||void 0===l||null===(o=l.data)||void 0===o||null===(r=o.data)||void 0===r?void 0:r.value)||[];n.sort(((e,t)=>new Date(t.createdOn)-new Date(e.createdOn)));const i=new Map;n.forEach((e=>{const t=[e.patientFirstName,e.patientMiddleName,e.patientLastName].filter(Boolean).join(" "),o="".concat(e.patientCardNumber,"-").concat(e.requestedDepartment,"-").concat(e.createdOn.slice(0,16).replace("T"," "));i.has(o)||i.set(o,{id:o,patientCardNumber:e.patientCardNumber,patientFName:t,requestedReason:e.requestedDepartment,requestGroup:e.requestingDepartment,createdOn:e.createdOn.slice(0,16).replace("T"," "),tests:[],paid:[],totalPrice:0,requestedItems:[]});const r=i.get(o);e.requestedItems.forEach((e=>{r.tests.push(e.requestedServices||"Unknown"),r.paid.push(e.requeststatus||"Unpaid"),r.totalPrice+=e.price||0,r.requestedItems.push(e)}))}));const d=Array.from(i.values());T(d)}catch(n){var a,l;console.error("This is fetchData Error : ",n),k.oR.error((null===n||void 0===n||null===(a=n.response)||void 0===a||null===(l=a.data)||void 0===l?void 0:l.msg)||"Failed to fetch data")}finally{W(!1)}})()}),[L]);const ue=(0,r.useMemo)((()=>{try{var e;const t=(null===R||void 0===R?void 0:R.length)>0?new Set(R.flatMap((e=>Array.isArray(null===e||void 0===e?void 0:e.paid)?e.paid.map((e=>e||"Unpaid")):["Unpaid"]))):[];return(null===(e=Array.from(t))||void 0===e?void 0:e.length)>0?["all",...Array.from(t)]:[]}catch(t){return console.error("getTabs Error:",t),["all"]}}),[R]),pe=(0,r.useMemo)((()=>(null===R||void 0===R?void 0:R.length)>0?null===R||void 0===R?void 0:R.filter((e=>{var t;const o=null===e||void 0===e||null===(t=e.paid)||void 0===t?void 0:t.map((e=>(e||"").toLowerCase())),r="all"===U||(null===o||void 0===o?void 0:o.includes(null===U||void 0===U?void 0:U.toLowerCase())),a=e.patientFName.toLowerCase().includes(G.toLowerCase())||e.patientCardNumber.toLowerCase().includes(G.toLowerCase());return r&&a})):[]),[R,U,G]),me=[{field:"patientCardNumber",headerName:"Card Number",flex:1},{field:"patientFName",headerName:"Patient Name",flex:1},{field:"requestedReason",headerName:"Category",flex:1},{field:"tests",headerName:"Tests",flex:2},{field:"requestGroup",headerName:"Requested From",flex:1},{field:"totalPrice",headerName:"Amount",flex:1},{field:"paid",headerName:"Status",flex:1,renderCell:e=>{try{var t,o;const r=new Set(null===e||void 0===e||null===(t=e.row)||void 0===t?void 0:t.paid);return null===(o=Array.from(r||[]))||void 0===o?void 0:o.join(", ")}catch(r){return console.error(r),""}}},{field:"createdOn",headerName:"Date",flex:1},{field:"Action",headerName:"Action",flex:1.5,renderCell:e=>{var t;return(null===e||void 0===e||null===(t=e.row)||void 0===t?void 0:t.paid.some((e=>"paid"===(null===e||void 0===e?void 0:e.toLowerCase()))))&&(0,q.jsx)(a.A,{variant:"outlined",startIcon:(0,q.jsx)(j.A,{}),onClick:()=>{re(e.row.requestedItems),le([]),ie({name:e.row.patientFName,group:e.row.requestGroup}),te(!0)},color:"dark"===D.palette.mode?"secondary":"primary",sx:{color:"light"===D.palette.mode?"#2e8ac9":"secondary",border:"1px solid ".concat("light"===D.palette.mode?"rgb(82 158 210)":"secondary")},children:"Mark Completed"})}}],fe=()=>{te(!1),ie({}),re([])},he=()=>{Z(!1),X(""),J(""),K([])},ve=e=>{const{checked:t,name:o}=e.target,r=oe.filter((e=>e.requestCatagory===o&&"paid"===(e.requeststatus||"").toLowerCase()));le((e=>{if(t){const t=r.filter((t=>!e.includes(t)));return[...e,...t]}return e.filter((e=>e.requestCatagory!==o))}))};return(0,q.jsxs)(l.A,{p:4,children:[(0,q.jsx)(n.A,{variant:"h4",align:"center",fontWeight:700,sx:{mb:4,color:"dark"===D.palette.mode?"#fff":"#000"},children:"Patient Treatment Entry"}),(0,q.jsx)(i.A,{sx:{mb:2,borderRadius:2},children:(null===ue||void 0===ue?void 0:ue.length)>0?(0,q.jsx)(d.A,{value:ue.includes(U)?U:"all",onChange:(e,t)=>H(t),variant:"fullWidth",sx:{"& .MuiTab-root":{textTransform:"capitalize",fontWeight:600,borderRadius:2,mx:1,color:"dark"===D.palette.mode?"#aaa":"#333"},"& .Mui-selected":{backgroundColor:"#2e8ac9",color:"dark"===D.palette.mode?"#000000DE":"#fff !important"},"& .MuiTabs-indicator":{display:"none"}},children:ue.map(((e,t)=>(0,q.jsx)(s.A,{label:"all"===e?"All":e,value:e},t)))}):(0,q.jsx)(l.A,{display:"flex",justifyContent:"center",py:2,children:(0,q.jsx)(c.A,{size:24,color:"inherit"})})}),(0,q.jsx)(u.A,{fullWidth:!0,label:"Search...",variant:"outlined",value:G,onChange:e=>Y(e.target.value),sx:{mb:2},InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===D.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===D.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===D.palette.mode?"#fff":"#000"},color:"dark"===D.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===D.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===D.palette.mode?"#fff":"#000"}}}}),(0,q.jsx)(l.A,{mb:2,children:(0,q.jsx)(p.Ay,{container:!0,justifyContent:"flex-end",children:(0,q.jsx)(a.A,{variant:"outlined",onClick:()=>F((e=>!e)),disabled:E,color:"dark"===D.palette.mode?"secondary":"primary",children:E?(0,q.jsx)(c.A,{size:24}):(0,q.jsx)(C.A,{})})})}),(0,q.jsx)(i.A,{elevation:3,children:(0,q.jsx)(y.z,{rows:pe,columns:me,loading:E,getRowId:e=>e.id,onRowDoubleClick:(e,t)=>((e,t)=>{try{var o;if("BUTTON"===t.target.nodeName||null!==(o=t.currentTarget.querySelector("button"))&&void 0!==o&&o.contains(t.target))return;K(e.row.requestedItems),X(e.row.patientFName),J(e.row.requestGroup),Z(!0)}catch(r){console.error("This is handleDoubleClick Error : ",r)}})(e,t),autoHeight:!0,sx:{minWidth:320}})}),(0,q.jsxs)(m.A,{open:_,onClose:(e,t)=>{"backdropClick"!==t&&"escapeKeyDown"!==t&&he()},fullWidth:!0,maxWidth:"sm",TransitionComponent:P.A,disableEnforceFocus:!0,BackdropProps:{"aria-hidden":!1},children:[(0,q.jsx)(f.A,{sx:{bgcolor:"#166295",color:"primary.contrastText",py:2,px:3},children:(0,q.jsxs)(l.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,q.jsxs)(n.A,{variant:"h6",children:["Tests for ",(0,q.jsx)("strong",{children:V})," from"," ",(0,q.jsx)("strong",{children:Q})]}),(0,q.jsx)(h.A,{onClick:()=>he(),sx:{color:"primary.contrastText"},children:(0,q.jsx)(w.A,{})})]})}),(0,q.jsx)(v.A,{dividers:!0,sx:{py:3,px:3},children:(null===$||void 0===$?void 0:$.length)>0?(0,q.jsx)(l.A,{sx:{maxHeight:"60vh",overflow:"auto",pr:1},children:null===(e=Object.entries((null===$||void 0===$?void 0:$.length)>0?null===$||void 0===$?void 0:$.reduce(((e,t)=>{const o=null===t||void 0===t?void 0:t.requestCatagory;return e[o]||(e[o]=[]),e[o].push(t),e}),{}):{}))||void 0===e?void 0:e.map((e=>{let[t,o]=e;return(0,q.jsxs)(l.A,{mb:3,sx:{borderLeft:"4px solid",borderColor:"#398bdb",pl:2},children:[(0,q.jsxs)(n.A,{variant:"subtitle1",fontWeight:"bold",color:"dark"===D.palette.mode?"#fff":"#000",children:[(0,q.jsx)(N.A,{fontSize:"small"})," ",t]}),(0,q.jsx)(x.A,{spacing:1.5,pl:2,children:o.map(((e,t)=>(0,q.jsxs)(i.A,{sx:{p:1.5,border:"1px solid",borderColor:"divider",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,q.jsxs)(l.A,{display:"flex",alignItems:"center",gap:1,children:[(0,q.jsx)(S.A,{fontSize:"small"}),(0,q.jsx)(n.A,{children:e.requestedServices})]}),(0,q.jsxs)(l.A,{display:"flex",alignItems:"center",gap:1,children:[z(e.requeststatus,D),(0,q.jsx)(n.A,{variant:"body2",color:"text.secondary",children:e.requeststatus})]})]},t)))})]},t)}))}):(0,q.jsxs)(l.A,{textAlign:"center",py:4,children:[(0,q.jsx)(M.A,{sx:{fontSize:60},color:"disabled"}),(0,q.jsx)(n.A,{variant:"h6",color:"text.secondary",children:"No tests available"})]})}),(0,q.jsx)(g.A,{sx:{p:3},children:(0,q.jsx)(a.A,{onClick:()=>he(),color:"secondary",variant:"contained",startIcon:(0,q.jsx)(w.A,{}),children:"Close"})})]}),(0,q.jsxs)(m.A,{open:ee,onClose:(e,t)=>{"backdropClick"!==t&&"escapeKeyDown"!==t&&fe()},fullWidth:!0,maxWidth:"sm",TransitionComponent:P.A,disableEnforceFocus:!0,BackdropProps:{"aria-hidden":!1},children:[(0,q.jsx)(f.A,{sx:{bgcolor:"#166295",color:"primary.contrastText",py:2,px:3},children:(0,q.jsxs)(l.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,q.jsxs)(n.A,{variant:"h6",children:["Select tests to complete for"," ",(0,q.jsx)("strong",{children:(null===ne||void 0===ne?void 0:ne.name)||"Unknown"})]}),(0,q.jsx)(h.A,{onClick:()=>fe(),sx:{color:"primary.contrastText"},children:(0,q.jsx)(w.A,{})})]})}),(0,q.jsx)(v.A,{dividers:!0,sx:{py:3,px:3},children:(null===oe||void 0===oe||null===(t=oe.filter((e=>"paid"===((null===e||void 0===e?void 0:e.requeststatus)||"").toLowerCase())))||void 0===t?void 0:t.length)>0?(0,q.jsx)(l.A,{sx:{maxHeight:"60vh",overflow:"auto",pr:1},children:Object.entries(null===oe||void 0===oe||null===(o=oe.filter((e=>"paid"===(e.requeststatus||"").toLowerCase())))||void 0===o?void 0:o.reduce(((e,t)=>{const o=t.requestCatagory;return e[o]||(e[o]=[]),e[o].push(t),e}),{})).map((e=>{let[t,o]=e;const r=o.filter((e=>ae.includes(e))).length,a=o.length,d=r===a&&a>0,s=r>0&&r<a;return(0,q.jsxs)(l.A,{mb:3,sx:{borderLeft:"4px solid #398bdb",pl:2},children:[(0,q.jsx)(n.A,{variant:"subtitle1",fontWeight:"bold",mb:1,children:(0,q.jsx)(A.A,{label:(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(N.A,{fontSize:"small"})," ",t]}),name:t,control:(0,q.jsx)(b.A,{checked:d,indeterminate:s,onChange:ve,sx:{color:ce,"&.Mui-checked":{color:ce},"&.MuiCheckbox-indeterminate":{color:ce}}})})}),(0,q.jsx)(x.A,{spacing:1.5,pl:2,children:o.map(((e,t)=>{const o=ae.includes(e);return(0,q.jsxs)(i.A,{onClick:()=>{le((t=>o?t.filter((t=>t!==e)):[...t,e]))},sx:{p:1.5,display:"flex",alignItems:"center",gap:2,border:"1px solid",borderColor:"divider",bgcolor:o?"action.selected":"background.paper",cursor:"pointer"},children:[(0,q.jsx)("input",{type:"checkbox",readOnly:!0,checked:o}),(0,q.jsxs)(n.A,{children:[(0,q.jsx)(S.A,{fontSize:"small"})," ",e.requestedServices]})]},t)}))})]},t)}))}):(0,q.jsxs)(l.A,{textAlign:"center",py:4,children:[(0,q.jsx)(M.A,{sx:{fontSize:60},color:"disabled"}),(0,q.jsx)(n.A,{variant:"h6",color:"text.secondary",children:"No paid tests available for completion"})]})}),(0,q.jsxs)(g.A,{sx:{p:3},children:[(0,q.jsx)(a.A,{onClick:()=>(async()=>{try{se(!0);const e=await Promise.all(ae.map((e=>{const t=Number(e.id);return I.A.put("/Request/doctor/complete-request",t,{headers:{"Content-Type":"application/json"}})})));null!==e&&void 0!==e&&e.every((e=>200===(null===e||void 0===e?void 0:e.status)))&&(k.oR.success("".concat(ae.length," test(s) marked as completed")),te(!1),F((e=>!e)))}catch(e){console.error("This is handleMarkAsCompleted Error : ",e),k.oR.error("".concat(e))}finally{se(!1)}})(),variant:"contained",color:"dark"===D.palette.mode?"secondary":"primary",disabled:0===(null===ae||void 0===ae?void 0:ae.length)||de,children:de?(0,q.jsx)(c.A,{size:24,color:"inherit"}):"Complete Selected Tests"}),(0,q.jsx)(a.A,{onClick:()=>fe(),variant:"outlined",color:"error",children:"Cancel"})]})]}),(0,q.jsx)(k.N9,{})]})}},16005:(e,t,o)=>{o.d(t,{A:()=>h});o(65043);var r=o(26240),a=o(57556),l=o(266),n=o(46946),i=o(94496),d=o(71716),s=o(72882),c=o(97334),u=o(74802),p=o(98348),m=o(70579);const f={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,boxShadow:24,p:3,borderRadius:2,textAlign:"center"},h=e=>{let{isOpen:t,onClose:o,onConfirm:h,userData:v,userRole:x,loading:g}=e;const A=(0,r.A)();return(0,m.jsx)(a.A,{open:t,onClose:(e,t)=>{"backdropClick"!==t&&"escapeKeyDown"!==t&&o()},disableEscapeKeyDown:!0,closeAfterTransition:!0,BackdropComponent:l.A,BackdropProps:{timeout:500},"aria-labelledby":"confirmation-modal-title","aria-describedby":"confirmation-modal-description",children:(0,m.jsxs)(n.A,{sx:f,bgcolor:"light"===A.palette.mode?A.palette.background.paper:A.palette.background.default,children:[(0,m.jsxs)(n.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,m.jsxs)(i.A,{variant:"h6",fontWeight:"bold",id:"confirmation-modal-title",sx:{color:e=>"light"===e.palette.mode?e.palette.primary.main:e.palette.info.light,display:"flex",alignItems:"center"},children:[(0,m.jsx)(p.A,{sx:{fontSize:28,mr:1}}),"Please Confirm"]}),(0,m.jsx)(d.A,{onClick:o,color:"error","aria-label":"close modal",children:(0,m.jsx)(u.A,{})})]}),(0,m.jsxs)(i.A,{variant:"body1",textAlign:"center",mt:2,id:"confirmation-modal-description",children:["Are you sure you want to delete the"," ",x?'role "'.concat(x,'"'):"user ",(0,m.jsx)("strong",{children:v}),"?"]}),(0,m.jsxs)(n.A,{display:"flex",justifyContent:"center",mt:3,children:[(0,m.jsx)(s.A,{variant:"contained",color:"light"===A.palette.mode?"primary":"secondary",onClick:()=>{h({userData:v,message:"Delete"})},sx:{mx:1},"aria-label":"confirm deletion",children:g?(0,m.jsx)(c.A,{size:24,color:"inherit"}):"Confirm"}),(0,m.jsx)(s.A,{variant:"outlined",color:"error",onClick:o,sx:{mx:1},"aria-label":"cancel deletion",children:"Cancel"})]})]})})}},18081:(e,t,o)=>{o.d(t,{A:()=>c});var r=o(65043),a=o(14037),l=o(26240),n=o(63777),i=o(83074),d=o(77265),s=o(70579);const c=e=>{let{isCustomLineColors:t=!1,isDashboard:o=!1}=e;const c=(0,l.A)(),u=(0,n.LU)(c.palette.mode),p=(0,r.useMemo)((()=>(0,i.N8)()),[]),m=(0,r.useMemo)((()=>{const e=new Date;return e.setHours(23,59,59,999),e}),[]),f=(0,r.useMemo)((()=>{const e=new Date;return e.setDate(e.getDate()-7),e.setHours(0,0,0,0),e}),[]),[h,v]=(0,r.useState)([]),[x,g]=(0,r.useState)(!0);(0,r.useEffect)((()=>{(async()=>{try{g(!0);const e=await d.A.put("/Payment/Get-all-Payment",{startDate:f,endDate:m,user:null===p||void 0===p?void 0:p.name}),t=((null===e||void 0===e?void 0:e.data)||[]).filter((e=>"free of charge"!==e.paymentType.toLowerCase())).reduce(((e,t)=>{const o=new Date(t.registeredOn).toISOString().split("T")[0];return e[o]=(e[o]||0)+parseFloat(t.paymentAmount),e}),{}),o=Object.entries(t).sort(((e,t)=>new Date(e[0])-new Date(t[0]))).map((e=>{let[t,o]=e;return{x:t,y:o,Date:t,Amount:o}}));v(o)}catch(e){console.error("Error fetching chart data:",e)}finally{g(!1)}})()}),[f,m,p]);const A=(0,r.useMemo)((()=>[{id:"Transaction",color:(0,n.LU)("dark").greenAccent[500],data:h}]),[h]);return x?(0,s.jsx)("div",{children:"Loading chart..."}):h.length?(0,s.jsx)(a.bt,{data:A,theme:{axis:{domain:{line:{stroke:u.grey[100]}},legend:{text:{fill:u.grey[100]}},ticks:{line:{stroke:u.grey[100],strokeWidth:1},text:{fill:u.grey[100]}}},legends:{text:{fill:u.grey[100]}}},tooltip:e=>{let{point:t}=e;return(0,s.jsxs)("div",{style:{background:u.primary[400],padding:"12px",border:"1px solid #ccc",borderRadius:"4px",color:u.grey[100]},children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Date:"})," ",t.data.Date]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Amount:"})," ",t.data.Amount]})]})},colors:o?{datum:"color"}:{scheme:"nivo"},margin:{top:50,right:110,bottom:50,left:60},xScale:{type:"point"},yScale:{type:"linear",min:"auto",max:"auto",stacked:!0,reverse:!1},yFormat:" >-.2f",curve:"catmullRom",axisTop:null,axisRight:null,axisBottom:{orient:"bottom",tickSize:0,tickPadding:5,tickRotation:0,legend:o?void 0:"Date",legendOffset:36,legendPosition:"middle"},axisLeft:{orient:"left",tickValues:5,tickSize:3,tickPadding:5,tickRotation:0,legend:o?void 0:"Amount",legendOffset:-40,legendPosition:"middle"},enableGridX:!1,enableGridY:!1,pointSize:8,pointColor:{theme:"background"},pointBorderWidth:2,pointBorderColor:{from:"serieColor"},pointLabelYOffset:-12,useMesh:!0,legends:[{anchor:"bottom-right",direction:"column",justify:!1,translateX:100,translateY:0,itemsSpacing:0,itemDirection:"left-to-right",itemWidth:80,itemHeight:20,itemOpacity:.75,symbolSize:12,symbolShape:"circle",symbolBorderColor:"rgba(0, 0, 0, .5)",effects:[{on:"hover",style:{itemBackground:"rgba(0, 0, 0, .03)",itemOpacity:1}}]}]}):(0,s.jsx)(s.Fragment,{})}},27861:(e,t,o)=>{o.r(t),o.d(t,{default:()=>B});var r=o(89379),a=o(65043),l=o(46946),n=o(94496),i=o(8591),d=o(42788),s=o(56894),c=o(97334),u=o(19955),p=o(40360),m=o(88911),f=o(71062),h=o(80216),v=o(26353),x=o(65204),g=o(39336),A=o(99784),b=o(1273),y=o(69392),j=o(72882),C=o(59064),k=o(71861),O=o(61976),I=o(26240),w=o(26380),N=o(24729),S=o(1849),M=o(57488),P=o(77265),D=o(83074),R=o(90124),T=o(70579);const E=(0,D.N8)(),W={lab:(0,T.jsx)(w.A,{fontSize:"small",sx:{mr:1}}),Radiology:(0,T.jsx)(N.A,{fontSize:"small",sx:{mr:1}}),Procedure:(0,T.jsx)(S.A,{fontSize:"small",sx:{mr:1}})},L=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{if(!e||"string"!==typeof e)return(0,T.jsx)(R.A,{fontSize:"small",sx:{mr:1,color:"grey.500"}});const t=Object.keys(W).find((t=>e.toLowerCase().includes(t.toLowerCase())));return W[t]||(0,T.jsx)(R.A,{fontSize:"small",sx:{mr:1,color:"grey.500"}})}catch(t){console.error("This is getCategoryIcon Error: ".error)}},q=e=>{var t;return null===(t=Object.values(e||{}))||void 0===t?void 0:t.every((e=>{var t;return null===(t=Object.values(e||{}))||void 0===t?void 0:t.every((e=>0===(null===e||void 0===e?void 0:e.length)))}))},z={lab:{},radiology:{},procedure:{}},B=()=>{var e,t,o,w,N,S,R,W,B,F;const U=(0,I.A)(),[H,G]=(0,a.useState)(""),[Y,_]=(0,a.useState)([]),[Z,$]=(0,a.useState)(""),[K,V]=(0,a.useState)(z),[X,Q]=(0,a.useState)([]),[J,ee]=(0,a.useState)(!1),[te,oe]=(0,a.useState)(""),[re,ae]=(0,a.useState)(""),[le,ne]=(0,a.useState)(!1),[ie,de]=(0,a.useState)(""),[se,ce]=(0,a.useState)(!1),[ue,pe]=(0,a.useState)([]),[me,fe]=(0,a.useState)({}),[he,ve]=(0,a.useState)({}),[xe,ge]=(0,a.useState)(!0),[Ae,be]=(0,a.useState)({}),[ye,je]=(0,a.useState)({}),[Ce,ke]=(0,a.useState)(!1),[Oe,Ie]=(0,a.useState)([]),we="light"===(null===U||void 0===U||null===(e=U.palette)||void 0===e?void 0:e.mode)?null===U||void 0===U||null===(t=U.palette)||void 0===t?void 0:t.primary.main:null===U||void 0===U||null===(o=U.palette)||void 0===o?void 0:o.secondary.main,Ne=null===(w=Object.entries(he||{}))||void 0===w?void 0:w.reduce(((e,t)=>{let[o,r]=t;return(null===Ae||void 0===Ae?void 0:Ae[o])===Z&&(e[o]=r),e}),{});(0,a.useEffect)((()=>{const e=Object.keys(me||{});(null===e||void 0===e?void 0:e.length)>0&&G((t=>null!==e&&void 0!==e&&e.includes(t)?t:null===e||void 0===e?void 0:e[0]))}),[me]),(0,a.useEffect)((()=>{(async()=>{try{const e=await P.A.get("/Lookup/payment-purpose");if(200===(null===e||void 0===e?void 0:e.status)){const t=await(null===e||void 0===e?void 0:e.data),o=(e=>{try{const t={};return e.forEach((e=>{let{purpose:o,group:r,subgroup:a,amount:l}=e;const n=(r||"Other").trim().toLowerCase(),i=(a||"General").trim(),d=(o||"").trim();t[n]||(t[n]={}),t[n][i]||(t[n][i]=[]),t[n][i].push({purpose:d,price:parseFloat(l)||0})})),Object.keys(t).forEach((e=>{const o=t[e];Object.keys(o).forEach((e=>{o[e].sort(((e,t)=>e.purpose.localeCompare(t.purpose)))}))})),t}catch(t){return console.error("This is transformPaymentDataToServices Error:",t),{}}})(t),{labPanels:r,labPanelsMother:a,categoriesWithPanels:l}=(e=>{try{const t={},o={},r=new Set;for(const a of e){let{group:e,subgroup:l,shortCodes:n,purpose:i,amount:d}=a;if(n&&l){const a=null===e||void 0===e?void 0:e.trim().toLowerCase(),s=null===n||void 0===n?void 0:n.trim().toLowerCase();r.add(a),t[s]||(t[s]=[]),t[s].push({purpose:i,price:d}),o[s]=l}}return{labPanels:t,labPanelsMother:o,categoriesWithPanels:Array.from(r)}}catch(t){return console.error("This is extractLabPanels Error:",t),{labPanels:{},labPanelsMother:{},categoriesWithPanels:[]}}})(t);Ie(l),fe(o),ve(r),be(a)}}catch(e){console.error("This is fetch Services Data: ",e)}})()}),[]),(0,a.useEffect)((()=>{const e=Object.keys((null===me||void 0===me?void 0:me[H])||{});_(e),$(e[0])}),[H,me]);const Se=e=>{try{!/^[0-9a-zA-Z\s\_\-]{5,}$/.test(e)&&(null===e||void 0===e?void 0:e.length)>0?ae("Please enter valid MRN (5+ digits)."):ae("")}catch(t){console.error("This is mrnCheck Error: ",t)}},Me=(e,t)=>{try{var o,a;const l=null===(o=Object.entries(ye||{}))||void 0===o||null===(a=o.filter((e=>{let[t,o]=e;return o})))||void 0===a?void 0:a.map((e=>{let[t]=e;return t})),n=null===l||void 0===l?void 0:l.flatMap((e=>(null===he||void 0===he?void 0:he[e])||[])),i=null===n||void 0===n?void 0:n.some((t=>{var o;return null===t||void 0===t||null===(o=t.purpose)||void 0===o?void 0:o.includes(null===e||void 0===e?void 0:e.purpose)}));if(!t&&i)return void console.warn('Cannot unselect "'.concat(e,"\" because it's part of a selected panel."));V((o=>{var a;const l=(null===o||void 0===o||null===(a=o[H])||void 0===a?void 0:a[Z])||[],n=t?null!==l&&void 0!==l&&l.some((t=>{var o;return null===t||void 0===t||null===(o=t.purpose)||void 0===o?void 0:o.includes(null===e||void 0===e?void 0:e.purpose)}))?l:[...l,e]:l.filter((t=>(null===t||void 0===t?void 0:t.purpose)!==(null===e||void 0===e?void 0:e.purpose)));return(0,r.A)((0,r.A)({},o),{},{[H]:(0,r.A)((0,r.A)({},null===o||void 0===o?void 0:o[H]),{},{[Z]:n})})}))}catch(l){console.error("This is handleTestToggle Error:",l)}};(0,a.useEffect)((()=>{(async()=>{try{var e,t,o;ke(!0);const r=await P.A.get("/Request/doctor/get-request"),a=(null===r||void 0===r||null===(e=r.data)||void 0===e||null===(t=e.data)||void 0===t||null===(o=t.value)||void 0===o?void 0:o.filter((e=>{var t;return"pharmacy"!==(null===e||void 0===e||null===(t=e.requestedDepartment)||void 0===t?void 0:t.toLowerCase())})))||[];null===a||void 0===a||a.sort(((e,t)=>new Date(t.createdOn)-new Date(e.createdOn)));let l=1;const n=null===a||void 0===a?void 0:a.flatMap((e=>[{id:l++,cardNumber:e.patientCardNumber,patientName:[e.patientFirstName,e.patientMiddleName,e.patientLastName].filter(Boolean).join(" "),category:e.requestedDepartment,createdOn:new Date(e.createdOn).toISOString().split("T")[0],tests:(e.requestedItems||[]).flatMap((e=>e.requestedServices||[]))}]));pe(n||[])}catch(r){console.error("The error of Fetching Data grid data is:",r)}finally{ke(!1)}})()}),[xe]);const Pe=()=>{V(z),Q([]),ee(!1),ae(""),oe(""),de("")},De=(null===K||void 0===K||null===(N=K[H])||void 0===N?void 0:N[Z])||[],Re=[{field:"id",headerName:"ID",width:90},{field:"cardNumber",headerName:"Card Number",flex:1},{field:"patientName",headerName:"Patient Name",flex:1},{field:"category",headerName:"Category",flex:1},{field:"tests",headerName:"Tests",flex:2,valueGetter:e=>Array.isArray(e)?e.join(", "):e},{field:"createdOn",headerName:"Date",flex:1}];return(0,T.jsxs)(l.A,{mx:"auto",marginInline:"15px",p:4,sx:{borderRadius:2,backgroundColor:"dark"===U.palette.mode?"#3b89db1f":"#eeeeeeb0",color:U.palette.text.primary,boxShadow:U.shadows[3],transition:"all 0.3s ease"},children:[(0,T.jsx)(n.A,{variant:"h3",fontWeight:700,textAlign:"center",children:"Send Request"}),(0,T.jsxs)(n.A,{children:["Welcome Dr. ",null===E||void 0===E?void 0:E.name]}),(0,T.jsxs)(i.Ay,{container:!0,spacing:3,mt:2,children:[(0,T.jsx)(i.Ay,{item:!0,xs:12,md:6,children:(0,T.jsx)(d.A,{label:"Patient Card Number",value:te,onChange:e=>{var t,o;oe((null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)||""),de(""),Se((null===e||void 0===e||null===(o=e.target)||void 0===o?void 0:o.value)||"")},onBlur:()=>(async()=>{try{if(!te)return;if(ie||re)return;ne(!0);const e=await(0,D.rA)(te);e?de(e):(M.oR.error("Card Number Not Registered."),de(""))}catch(o){var e,t;console.error("This is fetchPatientNames Error: ",o),M.oR.error("Error",null===o||void 0===o||null===(e=o.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.msg),de("")}finally{ne(!1)}})(),fullWidth:!0,error:!!re,helperText:re,InputProps:{endAdornment:(0,T.jsx)(s.A,{position:"end",children:le&&(0,T.jsx)(c.A,{size:24,color:"inherit"})}),sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===U.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===U.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===U.palette.mode?"#fff":"#000"},color:"dark"===U.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===U.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===U.palette.mode?"#fff":"#000"}}}})}),(0,T.jsx)(i.Ay,{item:!0,xs:12,md:6,children:(0,T.jsx)(d.A,{label:"Patient Name",value:ie,disabled:!0,fullWidth:!0})})]}),(0,T.jsx)(l.A,{mt:4,children:H&&(0,T.jsx)(u.A,{value:H,onChange:(e,t)=>G(t),variant:"fullWidth",indicatorColor:"dark"===U.palette.mode?"secondary":"primary",children:Object.keys(me||{}).map((e=>(0,T.jsx)(p.A,{value:e,label:(0,T.jsxs)(m.A,{direction:"row",alignItems:"center",spacing:1,children:[L(e)," \xa0\xa0",e]}),sx:e=>({color:e.palette.text.secondary,"&.Mui-selected":{color:"#6870fa",fontWeight:600}})},e)))})}),(0,T.jsxs)(i.Ay,{container:!0,spacing:4,mt:2,children:[(0,T.jsx)(i.Ay,{item:!0,xs:12,md:3,children:(0,T.jsx)(f.A,{sx:{backgroundColor:"dark"===U.palette.mode?"#141b2d":"#adadad3b"},children:Y.map((e=>{const t=e===Z;return(0,T.jsx)(h.Ay,{button:!0,selected:t,onClick:()=>$(e),sx:(0,r.A)((0,r.A)({},t&&{backgroundColor:"dark"===U.palette.mode?"#e3e3e31c":"#e3e3e3",color:"#6870fa"}),{},{"&.Mui-selected":{backgroundColor:"dark"===U.palette.mode?"#e3e3e31c":"#e3e3e3"},"&:hover":{backgroundColor:"dark"===U.palette.mode?"#e3e3e31c":"#e3e3e3",color:"#6870fa"}}),children:(0,T.jsx)(v.A,{primary:e})},e)}))})}),(0,T.jsx)(i.Ay,{item:!0,xs:12,md:9,children:(0,T.jsxs)(x.A,{sx:{p:3,backgroundColor:"dark"===U.palette.mode&&"#141b2d"},children:[(0,T.jsxs)(n.A,{variant:"h5",fontWeight:700,gutterBottom:!0,children:[Z," Test Selection"]}),(null===Oe||void 0===Oe?void 0:Oe.some((e=>(null===e||void 0===e?void 0:e.toLowerCase())===(null===H||void 0===H?void 0:H.toLowerCase()))))&&(null===(S=Object.values(Ae||{}))||void 0===S||null===(R=S.map((e=>null===e||void 0===e?void 0:e.toLowerCase())))||void 0===R?void 0:R.includes(null===Z||void 0===Z?void 0:Z.toLocaleLowerCase()))&&(0,T.jsxs)(l.A,{mt:3,sx:{marginBottom:"50px"},children:[(0,T.jsxs)(n.A,{variant:"h6",fontWeight:700,gutterBottom:!0,children:[(null===H||void 0===H||null===(W=H.charAt(0))||void 0===W?void 0:W.toUpperCase())+(null===H||void 0===H?void 0:H.slice(1))," ","Panels"]}),(0,T.jsx)(g.A,{sx:{mb:3}}),(0,T.jsx)(m.A,{direction:"row",spacing:2,children:Object.keys(Ne).map(((e,t)=>(0,T.jsx)(A.A,{control:(0,T.jsx)(b.A,{label:e,checked:X.includes(e),sx:{color:we,"&.Mui-checked":{color:we}},onChange:t=>((e,t)=>{try{var o;const a=null===(o=t.target)||void 0===o?void 0:o.checked;je((t=>(0,r.A)((0,r.A)({},t||{}),{},{[e]:a}))),Q((t=>(null===t||void 0===t?void 0:t.includes(e))?t.filter((t=>t!==e)):[...t,e]));const l=null===Ae||void 0===Ae?void 0:Ae[e];$(l);const n=(null===he||void 0===he?void 0:he[e])||[];a?n.forEach((e=>Me(e,!0))):V((e=>{var t;const o=(null===e||void 0===e||null===(t=e[H])||void 0===t?void 0:t[l])||[],a=null===o||void 0===o?void 0:o.filter((e=>!(null!==n&&void 0!==n&&n.includes(e))));return(0,r.A)((0,r.A)({},e),{},{[H]:(0,r.A)((0,r.A)({},e[H]),{},{[l]:a})})}))}catch(a){console.error("This is handlePanelToggle Error:",a)}})(e,t)},t),label:e},e)))})]}),(0,T.jsx)(g.A,{sx:{mb:3}}),(0,T.jsx)(i.Ay,{container:!0,spacing:3,children:null===me||void 0===me||null===(B=me[H])||void 0===B||null===(F=B[Z])||void 0===F?void 0:F.map((e=>{const t=De.some((t=>{var o,r,a,l;return(null===t||void 0===t||null===(o=t.purpose)||void 0===o||null===(r=o.toLowerCase)||void 0===r?void 0:r.call(o))===(null===e||void 0===e||null===(a=e.purpose)||void 0===a||null===(l=a.toLowerCase)||void 0===l?void 0:l.call(a))}));return(0,T.jsx)(i.Ay,{item:!0,xs:12,sm:6,md:4,children:(0,T.jsx)(y.A,{title:t?"Deselect test":"Select test",arrow:!0,children:(0,T.jsxs)(x.A,{onClick:()=>Me(e,!t),sx:e=>({display:"flex",alignItems:"center",p:2,borderRadius:3,cursor:"pointer",border:t?"2px solid ".concat(e.palette.primary.main):"1px solid ".concat(e.palette.divider),"&:hover":{borderColor:e.palette.primary.light}}),children:[(0,T.jsx)(b.A,{checked:t,onClick:e=>e.stopPropagation(),onChange:t=>Me(e,t.target.checked),sx:{color:we,"&.Mui-checked":{color:we}}}),(0,T.jsx)(n.A,{ml:1,children:null===e||void 0===e?void 0:e.purpose})]})})},null===e||void 0===e?void 0:e.purpose)}))})]})})]}),(0,T.jsx)(l.A,{textAlign:"center",mt:5,children:(0,T.jsxs)(m.A,{direction:"row",spacing:3,justifyContent:"center",children:[(0,T.jsx)(j.A,{variant:"contained",color:"dark"===U.palette.mode?"success":"primary",onClick:()=>(async()=>{try{var e,t;ce(!0);const r=[];if((null===te||void 0===te?void 0:te.length)<=0)return M.oR.error("Please Insert Card Number."),void ae("Please Fill This Field.");if(re)return void(null===M.oR||void 0===M.oR||M.oR.error("Please fix the error first."));if(null===(e=Object.entries(K||{}))||void 0===e||e.forEach((e=>{var t;let[o,a]=e;null===(t=Object.entries(a||{}))||void 0===t||t.forEach((e=>{let[t,a]=e;null===a||void 0===a||a.forEach((e=>{r.push({category:o,subCategory:t,test:e})}))}))})),0===(null===r||void 0===r?void 0:r.length))return M.oR.error("Please select at least one test."),void ce(!1);const a={};null===r||void 0===r||r.forEach((e=>{let{category:t,subCategory:o,test:r}=e;a[t]||(a[t]={}),a[t][o]||(a[t][o]=[]),a[t][o].push({prodedures:null===r||void 0===r?void 0:r.purpose,price:null===r||void 0===r?void 0:r.price})}));const l=null===(t=Object.entries(a||{}))||void 0===t?void 0:t.flatMap((e=>{var t;let[o,r]=e;return null===(t=Object.entries(r||{}))||void 0===t?void 0:t.map((e=>{let[t,r]=e;return{reqestedTo:o,catagory:t,requestItems:r}}))})),n={patientCardnumber:te,orders:l},i=await P.A.post("/Request/doctor/order-request/lab",n);var o;200!==(null===i||void 0===i?void 0:i.status)&&201!==(null===i||void 0===i?void 0:i.status)||(M.oR.success((null===i||void 0===i||null===(o=i.data)||void 0===o?void 0:o.msg)||"Orders submitted successfully!"),oe(""),de(""),ge((e=>!e)),Pe())}catch(c){var r,a,l,n,i,d,s;console.error("error",c);const e=null!==c&&void 0!==c&&null!==(r=c.response)&&void 0!==r&&null!==(a=r.data)&&void 0!==a&&null!==(l=a.errorDescription)&&void 0!==l&&l.toLowerCase().includes("patie")?null===c||void 0===c||null===(n=c.response)||void 0===n||null===(i=n.data)||void 0===i?void 0:i.errorDescription:null===c||void 0===c||null===(d=c.response)||void 0===d||null===(s=d.data)||void 0===s?void 0:s.msg;M.oR.error(e||"An error occurred while submitting orders.")}finally{ce(!1)}})(),disabled:se||q(K),startIcon:se&&(0,T.jsx)(c.A,{size:20,color:"inherit"}),children:"Submit Orders"}),(0,T.jsx)(j.A,{variant:"outlined",onClick:Pe,color:"error",children:"Cancel / Reset"})]})}),(0,T.jsx)(C.A,{open:J,autoHideDuration:3e3,onClose:()=>ee(!1),children:(0,T.jsx)(k.A,{onClose:()=>ee(!1),severity:"success",children:"Orders submitted successfully!"})}),(0,T.jsxs)(l.A,{mt:5,children:[(0,T.jsx)(n.A,{variant:"h6",fontWeight:700,gutterBottom:!0,children:"Recently Sent Tests"}),(0,T.jsx)(O.z,{rows:ue,columns:Re,loading:Ce,autoHeight:!0,sx:{minWidth:320}})]}),(0,T.jsx)(M.N9,{})]})}},29603:(e,t,o)=>{o.r(t),o.d(t,{default:()=>E});var r=o(80045),a=o(89379),l=o(65043),n=o(26240),i=o(46946),d=o(94496),s=o(78632),c=o(17642),u=o(17434),p=o(74050),m=o(94814),f=o(72882),h=o(97334),v=o(99784),x=o(19042),g=o(61976),A=o(27073),b=o.n(A),y=o(69223),j=o.n(y),C=o(72450),k=o(60446),O=o.n(k),I=o(77265),w=o(54007),N=o(9551),S=o(57488),M=(o(92342),o(70579));const P=["paymentDescription"],D=[{key:"card",labels:["CARD"]},{key:"examination",labels:["FOR EXAMINATION","FOR EXAMONATION"]},{key:"laboratory",labels:["LABORATORY"]},{key:"xray_ultrasound",labels:["X-RAY/ULTRASOUND"]},{key:"bed",labels:["BED"]},{key:"medicines",labels:["MEDICINES"]},{key:"surgery",labels:["SURGERY"]},{key:"food",labels:["FOOD"]}],R=(e,t,o)=>{const r={digital:[{key:"paymentChannel",label:"Channel"},{key:"paymentVerifingID",label:"Verifying ID"}],cash:[{key:"recipt",label:"Paper Receipt"}],credit:[{key:"patientWorkingPlace",label:"Working Place"},{key:"patientWorkID",label:"Work Place ID"}],traffic:[{key:"accedentDate",label:"Accident Date"},{key:"policeName",label:"Police Name"},{key:"policePhone",label:"Police Phone"},{key:"carPlateNumber",label:"Car Plate"},{key:"carCertificate",label:"Car Certificate"}],cbhi:[{key:"patientWoreda",label:"Woreda"},{key:"patientKebele",label:"Kebele"},{key:"patientsGoth",label:"Goth"},{key:"patientCBHI_ID",label:"CBHI ID"},{key:"patientReferalNo",label:"Referral No"},{key:"patientLetterNo",label:"Letter No"}],"free of charge":[]}[(0,w.f)(e)]||[],a=t?[...r,{key:"ServiceIS",label:"Payment Sub Type"}]:r;return o?[...a,{key:"reversedBy",label:"Reversed By"},{key:"reversedOn",label:"Reversed Date"},{key:"reversalReason",label:"Reversal Reason"}]:a},T=(e,t,o,r)=>{const a=R(t,o,r),l=D.map((e=>e.key)).concat("other"),n={};return e.forEach((e=>{var t;const o=null===(t=e.registeredOn)||void 0===t?void 0:t.split("T")[0],r="".concat(e.patientCardNumber,"-").concat(o);n[r]||(n[r]={id:r,patientCardNumber:e.patientCardNumber,patientName:e.patientName,registeredOn:o},l.forEach((e=>{n[r][e]=0})),a.forEach((t=>{var o;n[r][t.key]=null!==(o=e[t.key])&&void 0!==o?o:""})));const i=(e=>{if(!e)return"other";const t=e.trim().toUpperCase();for(const{key:o,labels:r}of D)if(r.some((e=>t===e)))return o;return"other"})(e.paymentReason);n[r][i]+=Number(e.paymentAmount)||0,a.forEach((t=>{var o;const a=n[r][t.key],l=null!==(o=e[t.key])&&void 0!==o?o:"";""===a?n[r][t.key]=l:a!==l&&(n[r][t.key]="Multiple")}))})),Object.values(n).forEach((e=>{e.total=l.reduce(((t,o)=>t+(e[o]||0)),0)})),Object.values(n)},E=()=>{const e=(0,n.A)(),[t,o]=(0,l.useState)([]),[A,y]=(0,l.useState)(!1),[k,E]=(0,l.useState)(""),[W,L]=(0,l.useState)(!1),[q,z]=(0,l.useState)(O()().startOf("day")),[B,F]=(0,l.useState)(O()().endOf("day")),[U,H]=(0,l.useState)(!1),[G,Y]=(0,l.useState)(""),[_,Z]=(0,l.useState)(""),[$,K]=(0,l.useState)([]),[V,X]=(0,l.useState)([]),[Q,J]=(0,l.useState)(""),[ee,te]=(0,l.useState)([]),[oe,re]=(0,l.useState)(!1),[ae,le]=(0,l.useState)([]);(0,l.useEffect)((()=>{J("")}),[k]),(0,l.useEffect)((()=>{const e=null===ee||void 0===ee?void 0:ee.filter((e=>(0,w.f)(e.type)===(0,w.f)(k))).some((e=>Array.isArray(e.description)&&e.description.some((e=>(null===e||void 0===e?void 0:e.description)&&e.description.toString().trim().length>0))));if(e){var t;const e=null===ee||void 0===ee||null===(t=ee.filter((e=>(0,w.f)(e.type)===(0,w.f)(k)))[0])||void 0===t?void 0:t.description;le(e)}else le([]);re(e)}),[ee,k]),(0,l.useEffect)((()=>{(async()=>{try{const o=await I.A.get("/Lookup/payment-type-description");var e,t;if(200===(null===o||void 0===o?void 0:o.status))te(null===o||void 0===o||null===(e=o.data)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.filter((e=>"all"!==(0,w.f)(null===e||void 0===e?void 0:e.type))))}catch(o){console.error("This is fetch Type handler error: ",o)}})()}),[]);const ne=async()=>{try{var e;if(y(!0),(null===q||void 0===q?void 0:q.length)<=0||(null===B||void 0===B?void 0:B.length)<=0)return void S.oR.error("Please Select Date first.");o([]),K([]),X([]),re(!1),J([]),le([]);const t=(0,a.A)({startDate:q.toISOString(),endDate:B.toISOString()},!0===U?{reversedOnly:!0}:!1===U?{reversedOnly:!1}:{}),l=await I.A.put("/Payment/Get-all-Payment",t),n=null===l||void 0===l||null===(e=l.data)||void 0===e?void 0:e.map((e=>{let{paymentDescription:t}=e,o=(0,r.A)(e,P);return(0,a.A)({ServiceIS:null===t||void 0===t?void 0:t.split(":")[0],paymentDescription:t},o)}));o(n||[]),K(Array.from(new Set((n||[]).map((e=>e.patientWorkingPlace)).filter(Boolean)))),X(Array.from(new Set((n||[]).map((e=>e.patientWoreda)).filter(Boolean))))}catch(t){console.error("This is Request Report Error: ",t),o([])}finally{y(!1)}},ie=t.filter((e=>(!k||(0,w.f)(null===e||void 0===e?void 0:e.paymentType)===(0,w.f)(k))&&((!G||(0,w.f)(null===e||void 0===e?void 0:e.patientWorkingPlace)===(0,w.f)(G))&&((!_||(0,w.f)(null===e||void 0===e?void 0:e.patientWoreda)===(0,w.f)(_))&&((!oe||!Q||(0,w.f)(null===e||void 0===e?void 0:e.ServiceIS)===(0,w.f)(Q))&&("All"===U||(null===e||void 0===e?void 0:e.isReversed)===U)))))),de=W?T(ie,k,oe,U):ie.map(((e,t)=>(0,a.A)((0,a.A)({},e),{},{id:t+1}))),se=((e,t,o,r)=>{const a=R(e,o,r);if(t){const e=D.map((e=>({field:e.key,headerName:e.labels[0]+" Amount",flex:1,type:"number"})));return[{field:"patientCardNumber",headerName:"Card Number",flex:1},{field:"patientName",headerName:"Patient Name",flex:1.5},{field:"registeredOn",headerName:"Date",flex:1},...a.map((e=>({field:e.key,headerName:e.label,flex:1}))),...e,{field:"other",headerName:"Other Amount",flex:1,type:"number"},{field:"total",headerName:"Total",flex:1,type:"number"}]}return[{field:"referenceNo",headerName:"Reference No",flex:1},{field:"patientName",headerName:"Patient Name",flex:1.5},{field:"patientCardNumber",headerName:"Card Number",flex:1},{field:"patientGender",headerName:"Gender",flex:1},{field:"patientAge",headerName:"Patient Age",flex:1},{field:"registeredOn",headerName:"Admission Date",flex:1},...a.map((e=>({field:e.key,headerName:e.label,flex:1}))),{field:"paymentType",headerName:"Payment Type",flex:1},{field:"paymentReason",headerName:"Payment Reason",flex:1},{field:"paymentAmount",headerName:"Amount",flex:1,renderCell:e=>{var t;return(0,N.formatAccounting2)(null===e||void 0===e||null===(t=e.row)||void 0===t?void 0:t.paymentAmount)}}]})(k,W,oe,U);return(0,M.jsxs)(i.A,{p:2,children:[(0,M.jsx)(d.A,{variant:"h4",gutterBottom:!0,children:"Payment Records"}),(0,M.jsxs)(i.A,{display:"flex",alignItems:"center",gap:2,mb:2,flexWrap:"wrap",children:[(0,M.jsx)(b(),{label:"Start Date",value:q?new Date(q):null,onChange:z,required:!0,sx:{"& .MuiOutlinedInput-root":{borderRadius:"10px","&:hover .MuiOutlinedInput-notchedOutline":{borderColor:e.palette.info.main},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{boxShadow:"0px 0px 8px rgba(0, 0, 255, 0.2)",borderColor:e.palette.info.main}}}},q||"startDate-date"),(0,M.jsx)(b(),{label:"End Date",value:B?new Date(B):null,onChange:F,required:!0,sx:{"& .MuiOutlinedInput-root":{borderRadius:"10px","&:hover .MuiOutlinedInput-notchedOutline":{borderColor:e.palette.info.main},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{boxShadow:"0px 0px 8px rgba(0, 0, 255, 0.2)",borderColor:e.palette.info.main}}}},B||"endDate-date"),(0,M.jsxs)(s.A,{sx:{minWidth:150,"& .MuiOutlinedInput-root":{borderRadius:"10px","&:hover .MuiOutlinedInput-notchedOutline":{borderColor:e.palette.info.main},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{boxShadow:"0px 0px 8px rgba(0, 0, 255, 0.2)",borderColor:e.palette.info.main}}},children:[(0,M.jsx)(c.A,{sx:{color:"dark"===e.palette.mode?"#fff":"#000","&.Mui-focused":{color:"dark"===e.palette.mode?"#fff":"#000"},"&.MuiInputLabel-shrink":{color:"dark"===e.palette.mode?"#fff":"#000"}},children:"Reversed Only"}),(0,M.jsxs)(u.A,{value:U,label:"Reversed Only",onChange:e=>H(e.target.value),input:(0,M.jsx)(p.A,{label:"Reversed Only",sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},color:"dark"===e.palette.mode?"#fff":"#000"}}),children:[(0,M.jsx)(m.A,{value:"All",children:"All"}),(0,M.jsx)(m.A,{value:!0,children:"Yes"}),(0,M.jsx)(m.A,{value:!1,children:"No"})]})]}),(0,M.jsx)(f.A,{variant:"contained",color:"light"===e.palette.mode?"primary":"secondary",onClick:()=>ne(),disabled:A,children:A?(0,M.jsx)(h.A,{size:24,color:"inherit"}):"Request Report"}),(0,M.jsx)(f.A,{variant:"contained",color:"light"===e.palette.mode?"primary":"secondary",onClick:()=>(async()=>{try{const e=new(j().Workbook),t=e.addWorksheet("Payment Report");t.columns=se.map((e=>({header:e.headerName,key:e.field,width:20}))),de.forEach((e=>{const o={};se.forEach((t=>{var r;o[t.field]=null!==(r=e[t.field])&&void 0!==r?r:""})),t.addRow(o)})),t.getRow(1).eachCell((e=>{e.font={bold:!0},e.alignment={vertical:"middle",horizontal:"center"},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}));const o=await e.xlsx.writeBuffer(),r=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,C.saveAs)(r,"Payment_Report.xlsx")}catch(e){console.error("This is handle Export Excel Error: ",e)}})(),disabled:A,children:"Export To excell"}),(0,M.jsxs)(s.A,{sx:{minWidth:150,"& .MuiOutlinedInput-root":{borderRadius:"10px","&:hover .MuiOutlinedInput-notchedOutline":{borderColor:e.palette.info.main},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{boxShadow:"0px 0px 8px rgba(0, 0, 255, 0.2)",borderColor:e.palette.info.main}}},children:[(0,M.jsx)(c.A,{sx:{color:"dark"===e.palette.mode?"#fff":"#000","&.Mui-focused":{color:"dark"===e.palette.mode?"#fff":"#000"},"&.MuiInputLabel-shrink":{color:"dark"===e.palette.mode?"#fff":"#000"}},children:"Payment Type"}),(0,M.jsxs)(u.A,{value:k,label:"Payment Type",onChange:e=>E(e.target.value),input:(0,M.jsx)(p.A,{label:"Payment Type",sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},color:"dark"===e.palette.mode?"#fff":"#000"}}),children:[(0,M.jsx)(m.A,{value:"",children:"All"}),ee.map((e=>(0,M.jsx)(m.A,{value:null===e||void 0===e?void 0:e.type,children:null===e||void 0===e?void 0:e.type},null===e||void 0===e?void 0:e.type)))]})]}),oe&&(0,M.jsxs)(s.A,{sx:{minWidth:150,"& .MuiOutlinedInput-root":{borderRadius:"10px","&:hover .MuiOutlinedInput-notchedOutline":{borderColor:e.palette.info.main},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{boxShadow:"0px 0px 8px rgba(0, 0, 255, 0.2)",borderColor:e.palette.info.main}}},children:[(0,M.jsx)(c.A,{sx:{color:"dark"===e.palette.mode?"#fff":"#000","&.Mui-focused":{color:"dark"===e.palette.mode?"#fff":"#000"},"&.MuiInputLabel-shrink":{color:"dark"===e.palette.mode?"#fff":"#000"}},children:"Sub type"}),(0,M.jsxs)(u.A,{value:Q,label:"Sub type",onChange:e=>J(e.target.value),input:(0,M.jsx)(p.A,{label:"Sub type",sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},color:"dark"===e.palette.mode?"#fff":"#000"}}),children:[(0,M.jsx)(m.A,{value:"",children:"All"}),null===ae||void 0===ae?void 0:ae.map((e=>(0,M.jsx)(m.A,{value:null===e||void 0===e?void 0:e.description,children:null===e||void 0===e?void 0:e.description},null===e||void 0===e?void 0:e.id)))]})]}),(0,M.jsxs)(s.A,{sx:{minWidth:170,"& .MuiOutlinedInput-root":{borderRadius:"10px","&:hover .MuiOutlinedInput-notchedOutline":{borderColor:e.palette.info.main},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{boxShadow:"0px 0px 8px rgba(0, 0, 255, 0.2)",borderColor:e.palette.info.main}}},children:[(0,M.jsx)(c.A,{sx:{color:"dark"===e.palette.mode?"#fff":"#000","&.Mui-focused":{color:"dark"===e.palette.mode?"#fff":"#000"},"&.MuiInputLabel-shrink":{color:"dark"===e.palette.mode?"#fff":"#000"}},children:"Credit Organization"}),(0,M.jsxs)(u.A,{value:G,label:"Credit Organization",onChange:e=>Y(e.target.value),input:(0,M.jsx)(p.A,{label:"Credit Organization",sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},color:"dark"===e.palette.mode?"#fff":"#000"}}),children:[(0,M.jsx)(m.A,{value:"",children:"All"}),$.map((e=>(0,M.jsx)(m.A,{value:e,children:e},e)))]})]}),(0,M.jsxs)(s.A,{sx:{minWidth:150,"& .MuiOutlinedInput-root":{borderRadius:"10px","&:hover .MuiOutlinedInput-notchedOutline":{borderColor:e.palette.info.main},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{boxShadow:"0px 0px 8px rgba(0, 0, 255, 0.2)",borderColor:e.palette.info.main}}},children:[(0,M.jsx)(c.A,{sx:{color:"dark"===e.palette.mode?"#fff":"#000","&.Mui-focused":{color:"dark"===e.palette.mode?"#fff":"#000"},"&.MuiInputLabel-shrink":{color:"dark"===e.palette.mode?"#fff":"#000"}},children:"Woreda"}),(0,M.jsxs)(u.A,{value:_,label:"Woreda",onChange:e=>Z(e.target.value),input:(0,M.jsx)(p.A,{label:"Woreda",sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},color:"dark"===e.palette.mode?"#fff":"#000"}}),children:[(0,M.jsx)(m.A,{value:"",children:"All"}),V.map((e=>(0,M.jsx)(m.A,{value:e,children:e},e)))]})]}),(0,M.jsx)(v.A,{control:(0,M.jsx)(x.A,{color:"light"===e.palette.mode?"primary":"secondary",checked:W,onChange:()=>L((e=>!e))}),label:"Aggregated View"})]}),(0,M.jsx)(i.A,{height:600,children:(0,M.jsx)(g.z,{rows:de,columns:se,loading:A,disableRowSelectionOnClick:!0,autoHeight:!0,sx:{minWidth:320}})}),(0,M.jsx)(S.N9,{})]})}},30426:(e,t,o)=>{o.d(t,{Es:()=>r.A,j2:()=>a.A,Y9:()=>l.A,bl:()=>n.A,a3:()=>m,__:()=>f});var r=o(54582),a=o(48056),l=o(37660),n=o(18081),i=(o(10665),o(26240)),d=o(46946),s=o(88911),c=o(94496),u=o(63777),p=o(70579);const m=e=>{let{progress:t="0.75",size:o="40",showLegend:r=!1,legendText:a="",uncollectedLabel:l="Uncollected",collectedLabel:n="Collected"}=e;const m=(0,i.A)(),f=(0,u.LU)(m.palette.mode),h=360*t,v=Math.round(100*t);return(0,p.jsxs)(d.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:2},children:[(0,p.jsx)(d.A,{sx:{background:"radial-gradient(".concat(f.primary[400]," 55%, transparent 56%),\n            conic-gradient(transparent 0deg ").concat(h,"deg, ").concat(f.blueAccent[500]," ").concat(h,"deg 360deg),\n            ").concat(f.greenAccent[500]),borderRadius:"50%",width:"".concat(o,"px"),height:"".concat(o,"px")}}),r&&(0,p.jsxs)(s.A,{direction:"row",spacing:2,alignItems:"center",children:[(0,p.jsxs)(s.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,p.jsx)(d.A,{sx:{width:"12px",height:"12px",borderRadius:"2px",backgroundColor:f.blueAccent[500]}}),(0,p.jsx)(c.A,{variant:"caption",children:"".concat(100-v,"% ").concat(l)})]}),(0,p.jsxs)(s.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,p.jsx)(d.A,{sx:{width:"12px",height:"12px",borderRadius:"2px",backgroundColor:f.greenAccent[500]}}),(0,p.jsx)(c.A,{variant:"caption",children:"".concat(v,"% ").concat(n)})]})]})]})};o(69320),o(1291),o(61466),o(41742),o(92654),o(33132),o(73021),o(96102),o(37330);const f=e=>{let{title:t,subtitle:o,icon:r,progress:a,increase:l}=e;const n=(0,i.A)(),s=(0,u.LU)(n.palette.mode);return(0,p.jsxs)(d.A,{width:"100%",m:"0 30px",children:[(0,p.jsxs)(d.A,{display:"flex",justifyContent:"space-between",children:[(0,p.jsxs)(d.A,{children:[r,(0,p.jsx)(c.A,{variant:"h4",fontWeight:"bold",sx:{color:s.grey[100]},children:t})]}),(0,p.jsx)(d.A,{children:(0,p.jsx)(m,{progress:a})})]}),(0,p.jsxs)(d.A,{display:"flex",justifyContent:"space-between",mt:"2px",children:[(0,p.jsx)(c.A,{variant:"h5",sx:{color:s.greenAccent[500]},children:o}),(0,p.jsx)(c.A,{variant:"h5",fontStyle:"italic",sx:{color:s.greenAccent[600]},children:l})]})]})};o(65043),o(97950);o(91525),o(43181),o(8290);o(52219),o(8795),o(57488),o(92342);o(51425),o(96164),o(58442),o(96724);o(93967),o(48292),o(97352),o(56181),o(12379),o(85092),o(66974);o(9092),o(85337),o(46764),o(68957),o(92135),o(29603),o(77265);var h=o(83074);(0,h.N8)();o(56937),o(71647),o(83786),o(37037),o(1302),o(27861),o(56643)},33132:(e,t,o)=>{o.r(t),o.d(t,{default:()=>m});var r=o(26240),a=o(46946),l=o(37660),n=o(896),i=o(69570),d=o(29622),s=o(94496),c=o(21337),u=o(63777),p=o(70579);const m=()=>{const e=(0,r.A)(),t=(0,u.LU)(e.palette.mode);return(0,p.jsxs)(a.A,{m:"20px",children:[(0,p.jsx)(l.A,{title:"FAQ",subtitle:"Frequently Asked Questions Page"}),(0,p.jsxs)(n.A,{defaultExpanded:!0,children:[(0,p.jsx)(i.A,{expandIcon:(0,p.jsx)(c.A,{}),children:(0,p.jsx)(s.A,{color:t.greenAccent[500],variant:"h5",children:"An Important Question"})}),(0,p.jsx)(d.A,{children:(0,p.jsx)(s.A,{children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse malesuada lacus ex, sit amet blandit leo lobortis eget."})})]}),(0,p.jsxs)(n.A,{defaultExpanded:!0,children:[(0,p.jsx)(i.A,{expandIcon:(0,p.jsx)(c.A,{}),children:(0,p.jsx)(s.A,{color:t.greenAccent[500],variant:"h5",children:"Another Important Question"})}),(0,p.jsx)(d.A,{children:(0,p.jsx)(s.A,{children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse malesuada lacus ex, sit amet blandit leo lobortis eget."})})]}),(0,p.jsxs)(n.A,{defaultExpanded:!0,children:[(0,p.jsx)(i.A,{expandIcon:(0,p.jsx)(c.A,{}),children:(0,p.jsx)(s.A,{color:t.greenAccent[500],variant:"h5",children:"Your Favorite Question"})}),(0,p.jsx)(d.A,{children:(0,p.jsx)(s.A,{children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse malesuada lacus ex, sit amet blandit leo lobortis eget."})})]}),(0,p.jsxs)(n.A,{defaultExpanded:!0,children:[(0,p.jsx)(i.A,{expandIcon:(0,p.jsx)(c.A,{}),children:(0,p.jsx)(s.A,{color:t.greenAccent[500],variant:"h5",children:"Some Random Question"})}),(0,p.jsx)(d.A,{children:(0,p.jsx)(s.A,{children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse malesuada lacus ex, sit amet blandit leo lobortis eget."})})]}),(0,p.jsxs)(n.A,{defaultExpanded:!0,children:[(0,p.jsx)(i.A,{expandIcon:(0,p.jsx)(c.A,{}),children:(0,p.jsx)(s.A,{color:t.greenAccent[500],variant:"h5",children:"The Final Question"})}),(0,p.jsx)(d.A,{children:(0,p.jsx)(s.A,{children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse malesuada lacus ex, sit amet blandit leo lobortis eget."})})]})]})}},37037:(e,t,o)=>{o.r(t),o.d(t,{default:()=>ee});var r=o(89379),a=o(65043),l=o(26487),n=o(46946),i=o(65204),d=o(94496),s=o(42788),c=o(29694),u=o(39336),p=o(72882),m=o(97334),f=o(896),h=o(69570),v=o(8591),x=o(60587),g=o(29622),A=o(83462),b=o(4219),y=o(97368),j=o(60960),C=o(91068),k=o(42492),O=o(68738),I=o(39652),w=o(21832),N=o(99784),S=o(1273),M=o(92064),P=o(61976),D=o(86816),R=o(26240),T=o(47805),E=o(57488),W=(o(92342),o(61560)),L=o(58293),q=o(59893),z=o(47225),B=o(79703),F=o(42400),U=o(68754),H=o(98638),G=o(77265),Y=o(9551),_=o(26405),Z=o(67500),$=o(47367),K=o(37948),V=o(90310),X=o(70579);const Q={ORDERED:"warning",PAID:"success","Waiting For Payment":"info"},J={PAID:(0,X.jsx)(Z.A,{fontSize:"small"}),ORDERED:(0,X.jsx)($.A,{fontSize:"small"}),"Waiting For Payment":(0,X.jsx)(K.A,{fontSize:"small"})},ee=()=>{var e;const t=(0,R.A)(),[o,Z]=(0,a.useState)({}),[$,K]=(0,a.useState)({}),[ee,te]=(0,a.useState)(""),[oe,re]=(0,a.useState)(!1),[ae,le]=(0,a.useState)(!1),[ne,ie]=(0,a.useState)(null),[de,se]=(0,a.useState)(!1),[ce,ue]=(0,a.useState)(!1),pe="light"===t.palette.mode?t.palette.primary.main:t.palette.secondary.main,me=()=>{try{var e,t,a;(null===(e=Object.values(o||{}))||void 0===e?void 0:e.length)>0&&void 0!==o[ne]&&(null===(t=o[ne])||void 0===t||null===(a=t.items)||void 0===a?void 0:a.some((e=>5===e.requestedStatusId||1===e.requestedStatusId)))||Z((e=>{if(!ne||!e[ne])return e;const t=(0,r.A)({},e),o=t[ne].items.map((e=>(0,r.A)((0,r.A)({},e),{},{isSelected:!0,price:0})));return t[ne]=(0,r.A)((0,r.A)({},t[ne]),{},{items:o}),t})),xe()}catch(l){console.error("This is resetGroupData Error : ",l)}},fe=o[ne],he=(null===fe||void 0===fe||null===(e=fe.items)||void 0===e?void 0:e.length)>0?fe.items.filter((e=>null===e||void 0===e?void 0:e.isSelected)).reduce(((e,t)=>{const o=Number(t.price);return e+(isNaN(o)?0:o)}),0):0,ve=[{field:"medication",headerName:"Medication",flex:1.2,headerClassName:"header"},{field:"dosage",headerName:"Dosage",flex:1,headerClassName:"header"},{field:"frequency",headerName:"Frequency",flex:1,headerClassName:"header"},{field:"duration",headerName:"Duration",flex:1,headerClassName:"header"},{field:"instructions",headerName:"Instructions",flex:2,headerClassName:"header"},{field:"price",headerName:"Price (ETB)",type:"number",flex:1,headerAlign:"right",align:"right",valueFormatter:e=>{let{value:t}=e;return null===t||void 0===t?void 0:t.toFixed(2)},headerClassName:"header"}];(0,a.useEffect)((()=>{(async()=>{try{var e,t;re(!0);const o=await G.A.get("/Request/doctor/get-request-pharma"),r=(null===o||void 0===o||null===(e=o.data)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.value)||[],a={};r.forEach((e=>{var t;const o=new Date(e.createdOn),r="".concat(e.patientCardNumber,"-").concat(o.getTime()),l=[e.patientFirstName,e.patientMiddleName,e.patientLastName].filter(Boolean).join(" "),n=null===(t=e.requestedItems)||void 0===t?void 0:t.filter((e=>[1,0,5].includes(null===e||void 0===e?void 0:e.requestedStatusId))),i=null===n||void 0===n?void 0:n.every((e=>1===(null===e||void 0===e?void 0:e.requestedStatusId))),d=null===n||void 0===n?void 0:n.every((e=>5===(null===e||void 0===e?void 0:e.requestedStatusId)));a[r]||(a[r]={id:r,dateTime:o,patientName:l,cardNumber:e.patientCardNumber,doctor:e.requestedBy,department:e.requestingDepartment,items:[],groupId:e.requestGroup,status:i?"PAID":d?"Waiting For Payment":"ORDERED"}),n.forEach(((t,l)=>{a[r].items.push({id:"".concat(e.patientCardNumber,"-").concat(l,"-").concat(o.getTime()),idNum:null===t||void 0===t?void 0:t.id,medication:t.requestedServices,dosage:t.measurement,requeststatus:t.requeststatus,frequency:t.procedeureCount,duration:t.duration,instructions:t.instruction,price:t.price||0,isSelected:!0})}))}));const l=Object.fromEntries(Object.entries(a||{}).filter((e=>{var t;let[o,r]=e;return(null===r||void 0===r||null===(t=r.items)||void 0===t?void 0:t.length)>0})).sort(((e,t)=>{let[o,r]=e,[a,l]=t;return l.dateTime!==r.dateTime?l.dateTime-r.dateTime:l.requestedStatusId<r.requestedStatusId?-1:l.requestedStatusId>r.requestedStatusId?1:0})));Z(l)}catch(o){console.error("Error fetching requests",o),E.oR.error("Failed to load prescriptions.")}finally{re(!1)}})()}),[ce]),(0,a.useEffect)((()=>{var e;const t=null===ee||void 0===ee?void 0:ee.toLowerCase(),r=null===(e=Object.entries(o||{}))||void 0===e?void 0:e.filter((e=>{var o,r;let[,a]=e;return(null===a||void 0===a||null===(o=a.patientName)||void 0===o?void 0:o.toLowerCase().includes(t))||(null===a||void 0===a||null===(r=a.cardNumber)||void 0===r?void 0:r.toLowerCase().includes(t))}));K(Object.fromEntries(r||{}))}),[ee,o]);const xe=()=>{ie(null),le(!1)},ge=e=>{let{status:t}=e;const o=t in J?t:"ORDERED",r=J[o],a=Q[o]||"default";return(0,X.jsx)(l.A,{icon:r,label:t,color:a,size:"small",sx:{fontWeight:700,textTransform:"uppercase",letterSpacing:.7,borderRadius:1.5,px:1.5,py:.5,boxShadow:e=>{var t;return"0 2px 6px ".concat((0,V.X4)((null===(t=e.palette[a])||void 0===t?void 0:t.main)||e.palette.grey[500],.3))},"& .MuiChip-icon":{color:e=>{var t;return(null===(t=e.palette[a])||void 0===t?void 0:t.contrastText)||"inherit"},marginLeft:0,marginRight:.5},"& .MuiChip-label":{fontSize:"0.75rem"}},"aria-label":"Status: ".concat(t)})};return(0,X.jsxs)(n.A,{sx:{p:4,minHeight:"100vh",background:t.palette.background.default},children:[(0,X.jsxs)(i.A,{elevation:3,sx:{maxWidth:1400,mx:"auto",p:4,borderRadius:3,backgroundColor:"dark"===t.palette.mode&&"#1f2a406b",boxShadow:t.shadows[4]},children:[(0,X.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",mb:3},children:[(0,X.jsx)(W.A,{sx:{mr:2,fontSize:40,color:"#3a8adc"}}),(0,X.jsx)(d.A,{variant:"h4",fontWeight:700,children:"Pharmacy Prescription Manager"})]}),(0,X.jsx)(s.A,{fullWidth:!0,label:"Search by Patient Name or Card Number",variant:"outlined",value:ee,onChange:e=>te(e.target.value),sx:{mb:3,"& .MuiOutlinedInput-root":{borderRadius:2,boxShadow:t.shadows[1]}},InputProps:{endAdornment:(0,X.jsx)(c.A,{badgeContent:Object.keys($).length,color:"secondary",anchorOrigin:{vertical:"top",horizontal:"right"},max:99,children:(0,X.jsx)(_.A,{color:"#2e8ac9"})}),sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===t.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===t.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===t.palette.mode?"#fff":"#000"},color:"dark"===t.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===t.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===t.palette.mode?"#fff":"#000"}}}}),(0,X.jsx)(u.A,{sx:{my:3,borderWidth:1}}),(0,X.jsx)(p.A,{variant:"contained",color:"secondary",sx:{display:"flex",justifySelf:"flex-end"},onClick:()=>ue((e=>!e)),children:oe?(0,X.jsx)(m.A,{size:24,color:"inherit"}):(0,X.jsx)(T.A,{sx:{transition:"transform 0.5s","&:hover":{transform:"rotate(90deg)"}}})}),(0,X.jsx)(u.A,{sx:{my:3,borderWidth:1}}),oe?(0,X.jsxs)(n.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"80vh"},children:[(0,X.jsx)(m.A,{size:24,color:"inherit"}),(0,X.jsx)(d.A,{sx:{ml:2},children:"Loading prescriptions..."})]}):0===Object.keys($).length?(0,X.jsx)(d.A,{variant:"h6",align:"center",sx:{py:4,color:t.palette.text.secondary},children:"No active prescriptions found"}):Object.entries($).map((e=>{var o,r,a,l;let[i,s]=e;return(0,X.jsxs)(f.A,{sx:{mb:2,borderRadius:2,boxShadow:t.shadows[2],"&:before":{display:"none"}},children:[(0,X.jsx)(h.A,{expandIcon:(0,X.jsx)(L.A,{}),sx:{backgroundColor:"dark"===t.palette.mode?"#1f2a40":t.palette.background.paper,borderLeft:"4px solid #2e8ac9",borderRadius:2},children:(0,X.jsxs)(v.Ay,{container:!0,spacing:2,alignItems:"center",children:[(0,X.jsx)(v.Ay,{item:!0,xs:12,md:3,children:(0,X.jsxs)(n.A,{sx:{display:"flex",alignItems:"center"},children:[(0,X.jsx)(x.A,{sx:{bgcolor:"#2e8ac9",mr:2,width:40,height:40},children:(0,X.jsx)(q.A,{})}),(0,X.jsxs)(n.A,{children:[(0,X.jsx)(d.A,{fontWeight:600,children:s.patientName}),(0,X.jsxs)(d.A,{variant:"body2",color:"text.secondary",children:["Card: ",s.cardNumber]})]})]})}),(0,X.jsx)(v.Ay,{item:!0,xs:12,md:3,children:(0,X.jsxs)(n.A,{sx:{display:"flex",alignItems:"center"},children:[(0,X.jsx)(z.A,{sx:{mr:1,color:"#2e8ac9"}}),(0,X.jsx)(d.A,{children:s.dateTime.toLocaleString()})]})}),(0,X.jsx)(v.Ay,{item:!0,xs:12,md:3,children:(0,X.jsxs)(n.A,{sx:{display:"flex",alignItems:"center"},children:[(0,X.jsx)(B.A,{sx:{mr:1,color:"#6870fab0"}}),(0,X.jsxs)(d.A,{children:[s.doctor," (",s.department,")"]})]})}),(0,X.jsx)(v.Ay,{item:!0,xs:12,md:3,sx:{textAlign:"right"},children:(0,X.jsx)(ge,{status:s.status})})]})}),(0,X.jsxs)(g.A,{sx:{backgroundColor:t.palette.background.default,pt:0},children:[(0,X.jsx)(P.z,{rows:s.items,columns:ve,disableSelectionOnClick:!0,hideFooterSelectedRowCount:!0,getRowId:e=>e.id,autoHeight:!0,sx:{minWidth:320,border:"1px solid ".concat(t.palette.divider),borderRadius:2,marginTop:"10px",bgcolor:t.palette.background.paper},slots:{footer:()=>{var e;return(0,X.jsx)(D.J,{children:(0,X.jsx)(n.A,{sx:{px:2,py:1,width:"100%",display:"flex",justifyContent:"flex-end",bgcolor:"light"===t.palette.mode?t.palette.grey[100]:t.palette.background.default},children:(0,X.jsxs)(d.A,{variant:"subtitle1",fontWeight:600,children:["Total:"," ",null===s||void 0===s||null===(e=s.items)||void 0===e?void 0:e.reduce(((e,t)=>e+(t.price||0)),0).toFixed(2)," ","ETB"]})})})}}}),(0,X.jsx)(n.A,{sx:{display:"flex",justifyContent:"flex-end",gap:2,mt:3},children:(0,X.jsx)(p.A,{variant:"contained",startIcon:(0,X.jsx)(F.A,{}),onClick:()=>(ie(i),void le(!0)),disabled:(null===s||void 0===s||null===(o=s.status)||void 0===o||null===(r=o.toLowerCase())||void 0===r?void 0:r.includes("paid"))||(null===s||void 0===s||null===(a=s.status)||void 0===a||null===(l=a.toLowerCase())||void 0===l?void 0:l.includes("waiting")),sx:{borderRadius:2,px:3,py:1,boxShadow:t.shadows[2],backgroundColor:"dark"===t.palette.mode?t.palette.success.main:"#ed6c02"},children:"Process Payment"})})]})]},i)})),(0,X.jsxs)(A.A,{open:ae,onClose:(e,t)=>{"backdropClick"!==t&&"escapeKeyDown"!==t&&me()},maxWidth:"sm",fullWidth:!0,disableEnforceFocus:!0,BackdropProps:{style:{backgroundColor:"rgba(0,0,0,0.5)"}},children:[(0,X.jsxs)(b.A,{sx:{backgroundColor:"#174564",color:t.palette.common.white,display:"flex",alignItems:"center"},children:[(0,X.jsx)(U.A,{sx:{mr:2}}),"Process Payment"]}),(0,X.jsx)(y.A,{sx:{py:3},children:ne&&(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(j.A,{component:i.A,sx:{marginTop:"20px"},variant:"outlined",children:(0,X.jsxs)(C.A,{size:"small",children:[(0,X.jsx)(k.A,{children:(0,X.jsxs)(O.A,{children:[(0,X.jsx)(I.A,{sx:{fontWeight:600},children:"Medication"}),(0,X.jsx)(I.A,{sx:{fontWeight:600},align:"right",children:"Price (ETB)"}),(0,X.jsx)(I.A,{sx:{fontWeight:600},align:"right",children:"Select"}),(0,X.jsx)(I.A,{sx:{fontWeight:600},align:"right",children:"Amount"})]})}),(0,X.jsxs)(w.A,{children:[null===fe||void 0===fe?void 0:fe.items.map(((e,o)=>{var a,l;return(0,X.jsxs)(O.A,{children:[(0,X.jsx)(I.A,{children:e.medication}),(0,X.jsxs)(I.A,{align:"right",children:[(null===(a=e.price)||void 0===a?void 0:a.length)>0?null===(l=e.price)||void 0===l?void 0:l.toFixed(2):e.price," ","ETB"]}),(0,X.jsx)(I.A,{align:"right",children:(0,X.jsx)(N.A,{control:(0,X.jsx)(S.A,{checked:(null===e||void 0===e?void 0:e.isSelected)||!1,onChange:e=>((e,t)=>{try{Z((o=>{const a=(0,r.A)({},o),l=[...a[ne].items],n=e.target.checked;return l[t]=(0,r.A)((0,r.A)({},l[t]),{},{isSelected:n,price:n?l[t].price:0}),a[ne]=(0,r.A)((0,r.A)({},a[ne]),{},{items:l}),a}))}catch(o){console.error("This is handleCheckboxChange Error : ",o)}})(e,o),sx:{color:pe,"&.Mui-checked":{color:pe}}}),label:null!==e&&void 0!==e&&e.isSelected?"Deselect":"Select",sx:{ml:1,"& .MuiFormControlLabel-label":{fontWeight:500,color:null!==e&&void 0!==e&&e.isSelected?t.palette.success.main:t.palette.text.primary}}})}),(0,X.jsx)(I.A,{align:"right",children:(0,X.jsx)(s.A,{variant:"outlined",type:"number",size:"small",onWheel:e=>e.target.blur(),inputProps:{min:0},value:e.price||"",onChange:e=>((e,t)=>{try{const o=e.target.value,a=""===o?"":Math.max(0,Number(o));Z((e=>{var o;const l=(0,r.A)({},e),n=l[ne];if(!n)return e;const i=[...n.items];return null!==(o=i[t])&&void 0!==o&&o.isSelected&&(i[t]=(0,r.A)((0,r.A)({},i[t]),{},{price:a})),l[ne]=(0,r.A)((0,r.A)({},n),{},{items:i}),l}))}catch(o){console.error("This is handleAmountChange Error : ",o)}})(e,o),sx:{width:80},InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===t.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===t.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===t.palette.mode?"#fff":"#000"},color:"dark"===t.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===t.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===t.palette.mode?"#fff":"#000"}}}})})]},o)})),(0,X.jsxs)(O.A,{sx:{borderTop:"2px solid ".concat(t.palette.divider),backgroundColor:"light"===t.palette.mode?t.palette.grey[100]:t.palette.background.paper},children:[(0,X.jsx)(I.A,{sx:{fontWeight:600},children:"Total"}),(0,X.jsxs)(I.A,{sx:{fontWeight:600,textAlign:"right"},children:[(0,Y.formatAccounting2)(isNaN(he)?0:he),"ETB"]}),(0,X.jsx)(I.A,{colSpan:2})]})]})]})}),(0,X.jsx)(n.A,{sx:{mt:3},children:(0,X.jsx)(d.A,{variant:"subtitle1",gutterBottom:!0,children:(0,X.jsx)("strong",{children:"Payment Method"})})})]})}),(0,X.jsxs)(M.A,{sx:{px:3,py:2},children:[(0,X.jsx)(p.A,{onClick:()=>me(),variant:"outlined",color:"error",sx:{mr:2},children:"Cancel"}),(0,X.jsx)(p.A,{onClick:()=>(async()=>{try{var e,t;se(!0);const a=o[ne];if(null===a||void 0===a||null===(e=a.items)||void 0===e||!e.some((e=>!0===e.isSelected&&e.price>0)))return void E.oR.error("You need to have at least one payment.");if(null!==a&&void 0!==a&&null!==(t=a.items)&&void 0!==t&&t.some((e=>e.isSelected&&e.price<=0)))return void E.oR.error("You need to have an amount for every selected medicine.");const l=a.items.filter((e=>e.isSelected)),n=a.items.filter((e=>!e.isSelected));(null===n||void 0===n?void 0:n.length)>0&&await Promise.all(n.map((e=>G.A.delete("/Request/doctor/cancel-request/".concat(null===e||void 0===e?void 0:e.idNum)))));const i=[];for(const e of l)try{const t=await G.A.put("/Request/doctor/pend-request",{id:(null===e||void 0===e?void 0:e.idNum)||"-",patientCardnumber:a.cardNumber||"-",groupId:a.groupId||"-",price:e.price||0});i.push({id:e.id,success:!0,data:t.data})}catch(r){console.error("Error sending request ID ".concat(e.id,":"),r),i.push({id:e.id,success:!1,error:r})}E.oR.success("Payment requests processed successfully."),ue((e=>!e)),me()}catch(a){console.error("Cancellation failed:",a),E.oR.error("Failed to cancel some requests. No payments were processed.")}finally{se(!1)}})(),sx:{backgroundColor:"#174564"},variant:"contained",disabled:de,startIcon:(0,X.jsx)(H.A,{}),children:de?(0,X.jsx)(m.A,{size:24,color:"inherit"}):"Confirm Payment"})]})]})]}),(0,X.jsx)(E.N9,{})]})}},37330:(e,t,o)=>{o.r(t),o.d(t,{default:()=>g});var r=o(65043),a=o(30846),l=o(93245),n=o(58206),i=o(55487),d=o(43623),s=o(26240),c=o(46946),u=o(94496),p=o(71062),m=o(80216),f=o(26353),h=o(37660),v=o(63777),x=o(70579);const g=()=>{const e=(0,s.A)(),t=(0,v.LU)(e.palette.mode),[o,g]=(0,r.useState)([]);return(0,x.jsxs)(c.A,{m:"20px",children:[(0,x.jsx)(h.A,{title:"Calendar",subtitle:"Full Calendar Interactive Page"}),(0,x.jsxs)(c.A,{display:"flex",justifyContent:"space-between",children:[(0,x.jsxs)(c.A,{flex:"1 1 20%",backgroundColor:t.primary[400],p:"15px",borderRadius:"4px",children:[(0,x.jsx)(u.A,{variant:"h5",children:"Events"}),(0,x.jsx)(p.A,{children:o.map((e=>(0,x.jsx)(m.Ay,{sx:{backgroundColor:t.greenAccent[500],margin:"10px 0",borderRadius:"2px"},children:(0,x.jsx)(f.A,{primary:e.title,secondary:(0,x.jsx)(u.A,{children:(0,a.Yq5)(e.start,{year:"numeric",month:"short",day:"numeric"})})})},e.id)))})]}),(0,x.jsx)(c.A,{flex:"1 1 100%",ml:"15px",children:(0,x.jsx)(a.Ay$,{height:"75vh",plugins:[l.Ay,n.Ay,i.Ay,d.A],headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listMonth"},initialView:"dayGridMonth",editable:!0,selectable:!0,selectMirror:!0,dayMaxEvents:!0,select:e=>{const t=prompt("Please enter a new title for your event"),o=e.view.calendar;o.unselect(),t&&o.addEvent({id:"".concat(e.dateStr,"-").concat(t),title:t,start:e.startStr,end:e.endStr,allDay:e.allDay})},eventClick:e=>{window.confirm("Are you sure you want to delete the event '".concat(e.event.title,"'"))&&e.event.remove()},eventsSet:e=>g(e),initialEvents:[{id:"12315",title:"All-day event",date:"2022-09-14"},{id:"5123",title:"Timed event",date:"2022-09-28"}]})})]})]})}},41742:(e,t,o)=>{o.r(t),o.d(t,{default:()=>i});var r=o(46946),a=o(37660),l=o(18081),n=o(70579);const i=()=>(0,n.jsxs)(r.A,{m:"20px",children:[(0,n.jsx)(a.A,{title:"Line Chart",subtitle:"Simple Line Chart"}),(0,n.jsx)(r.A,{height:"75vh",children:(0,n.jsx)(l.A,{})})]})},43181:(e,t,o)=>{o.r(t),o.d(t,{default:()=>C});var r=o(89379),a=o(65043),l=(o(50445),o(61976)),n=o(26240),i=o(71716),d=o(72882),s=o(95540),c=o(63471),u=o(57566),p=o(57556),m=o(266),f=o(46946),h=o(94496),v=o(42788),x=o(74802),g=o(70579);const A={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",boxShadow:24,p:3,borderRadius:2},b=e=>{let{isOpen:t,onClose:o,onSubmit:l,updateData:n,onEdit:s,resetData:c}=e;const[u,b]=(0,a.useState)({role:"",description:""}),[y,j]=(0,a.useState)(""),C=()=>{b({role:"",description:""}),c(),o()},k=e=>{b((0,r.A)((0,r.A)({},u),{},{[e.target.name]:e.target.value})),"role"===e.target.name&&O(e.target.value)};(0,a.useEffect)((()=>{void 0!==n&&b({role:null===n||void 0===n?void 0:n.name,description:null===n||void 0===n?void 0:n.description})}),[n]);const O=e=>{/^[A-Za-z][A-Za-z0-9]{1,}$/.test(e)?j(""):j("Username must start with a letter, be at least 3 characters long, and contain no spaces.")};return(0,g.jsx)(p.A,{open:t,onClose:(e,t)=>{"backdropClick"!==t&&"escapeKeyDown"!==t&&C()},disableEscapeKeyDown:!0,closeAfterTransition:!0,BackdropComponent:m.A,BackdropProps:{timeout:500},children:(0,g.jsxs)(f.A,{sx:A,children:[(0,g.jsxs)(f.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,g.jsx)(h.A,{variant:"h6",children:n?"Edit Role":"Add New Role"}),(0,g.jsx)(i.A,{onClick:C,children:(0,g.jsx)(x.A,{})})]}),(0,g.jsxs)("form",{onSubmit:e=>{e.preventDefault(),y?alert("Please fix the errors before submitting."):(n?s(u):l(u),o())},children:[(0,g.jsx)(v.A,{fullWidth:!0,label:"role",name:"role",value:u.role,onChange:k,margin:"normal",required:!0,error:!!y,helperText:y}),(0,g.jsx)(v.A,{fullWidth:!0,label:"description",name:"description",type:"text",value:u.description,onChange:k,margin:"normal",required:!0}),(0,g.jsxs)(f.A,{display:"flex",justifyContent:"flex-end",mt:2,children:[(0,g.jsx)(d.A,{onClick:C,color:"secondary",sx:{mr:2},children:"Close"}),(0,g.jsx)(d.A,{type:"submit",variant:"contained",color:"primary",children:n?"Save Changes":"Add Role"})]})]})]})})};var y=o(57488),j=(o(92342),o(77265));const C=()=>{const[e,t]=(0,a.useState)(!1),[o,p]=(0,a.useState)(null),[m,f]=(0,a.useState)([]),h=(0,n.A)();(0,a.useEffect)((()=>{(async()=>{try{var e;const t=await j.A.get("/Admin/roles"),o=(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.sort(((e,t)=>e.name.localeCompare(t.name)))).map(((e,t)=>(0,r.A)((0,r.A)({},e),{},{orderNumber:t+1})));f(o)}catch(t){console.error("fetchrole>>",t.message),y.oR.error("Internal Server Error on Role Fetch;")}})()}),[]);const v=[{field:"orderNumber",headerName:"ID",flex:1},{field:"name",headerName:"Role",flex:1},{field:"actions",headerName:"Actions",width:150,renderCell:e=>(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(i.A,{"aria-label":"edit",className:"text-info",children:(0,g.jsx)(s.A,{})}),(0,g.jsx)(i.A,{color:"danger","aria-label":"delete",className:"text-danger",children:(0,g.jsx)(c.A,{})})]})}];return(0,g.jsxs)("div",{className:"user-management-container",children:[(0,g.jsx)("h1",{className:"hed",children:"Role Management"}),(0,g.jsx)(d.A,{variant:"contained",color:"light"===h.palette.mode?"primary":"success",startIcon:(0,g.jsx)(u.A,{}),onClick:()=>t(!0),children:"Add Role"}),(0,g.jsx)(b,{isOpen:e,onClose:()=>t(!1),onSubmit:async e=>{},onEdit:e=>{},updateData:o,resetData:async()=>{p(null)}}),(0,g.jsx)("div",{className:"data-grid-container",children:(0,g.jsx)(l.z,{rows:m,columns:v,autoHeight:!0,sx:{minWidth:320}})}),(0,g.jsx)(y.N9,{})]})}},46764:(e,t,o)=>{o.r(t),o.d(t,{default:()=>p});o(65043);var r=o(26240),a=o(30344),l=o(19252),n=o(94496),i=o(46946),d=o(72882),s=o(42091),c=o(73216),u=o(70579);function p(){const e=(0,r.A)(),t=(0,a.A)(e.breakpoints.down("sm")),o=(0,c.Zp)();return(0,u.jsxs)(l.A,{maxWidth:"md",sx:{minHeight:"80vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",px:2},children:[(0,u.jsx)(s.A,{sx:{fontSize:t?80:120,color:e.palette.error.main,mb:2}}),(0,u.jsx)(n.A,{variant:t?"h4":"h2",gutterBottom:!0,children:"403 \u2014 Forbidden"}),(0,u.jsx)(n.A,{variant:"body1",color:"text.secondary",sx:{mb:4,maxWidth:600},children:"You don\u2019t have permission to access this page. If you think this is a mistake, please contact your administrator."}),(0,u.jsx)(i.A,{children:(0,u.jsx)(d.A,{variant:"contained",color:"primary",size:"large",onClick:()=>o("/"),children:"Go to Home"})})]})}},50445:()=>{},51425:(e,t,o)=>{o.r(t),o.d(t,{default:()=>T});var r=o(89379),a=o(80045),l=o(65043),n=o(26240),i=o(72882),d=o(71716),s=o(19252),c=o(94496),u=o(46946),p=o(83462),m=o(4219),f=o(97368),h=o(42788),v=o(92064),x=o(96724),g=o(57488),A=(o(92342),o(69223)),b=o.n(A),y=o(72450),j=o(96094),C=o(61976),k=o(83560),O=o(51387),I=o(70141),w=o(77265),N=o(83074),S=o(9551),M=o(70579);const P=["createdBy"],D=(0,N.N8)(),R=["Digital Payment Channels","CBHI Providers","Organizations with Agreements","Hospital Services","Payment Methods"],T=()=>{const[e,t]=(0,l.useState)(!1),[o,A]=(0,l.useState)({}),[N,T]=(0,l.useState)(!1),[E,W]=(0,l.useState)({category:"",name:"",address:""}),[L,q]=(0,l.useState)(!1),[z,B]=(0,l.useState)(null),[F,U]=(0,l.useState)(!1),[H,G]=(0,l.useState)(!1),Y=(0,n.A)();function _(e){let{rows:t,columns:o,category:r}=e;return(0,M.jsx)(j.b,{children:(0,M.jsx)(i.A,{variant:"outlined",color:"dark"===Y.palette.mode?"secondary":"primary",onClick:()=>(async()=>{const e=new(b().Workbook),a=e.addWorksheet("Payment Data");a.columns=o.filter((e=>"actions"!==e.field)).map((e=>({header:e.headerName||e.field,key:e.field,width:25}))),t.forEach((e=>{const t={};a.columns.forEach((o=>{t[o.key]=e[o.key]})),a.addRow(t)})),a.getRow(1).font={bold:!0};const l=await e.xlsx.writeBuffer(),n=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,y.saveAs)(n,"".concat(r,"_data_.xlsx"))})(),children:"Export to Excel"})})}const Z=async(e,t,o)=>{try{const o=await w.A.get(e);if(200===(null===o||void 0===o?void 0:o.status)||201===(null===o||void 0===o?void 0:o.status)){var l;const e=null===o||void 0===o||null===(l=o.data)||void 0===l?void 0:l.map((e=>{let{createdBy:t}=e,o=(0,a.A)(e,P);return(0,r.A)({createdby:t},o)})),n={[t]:e};A((e=>(0,r.A)((0,r.A)({},e),n)))}}catch(n){console.error(n.message)}};(0,l.useEffect)((()=>{Z("/Lookup/payment-type","Payment Methods")}),[F]),(0,l.useEffect)((()=>{Z("/Lookup/payment-channel","Digital Payment Channels")}),[F]),(0,l.useEffect)((()=>{Z("/Lookup/payment-purpose","Hospital Services")}),[F]),(0,l.useEffect)((()=>{Z("/Providers/list-providers","CBHI Providers")}),[F]),(0,l.useEffect)((()=>{Z("/Organiztion/Organization","Organizations with Agreements")}),[F]);const $=function(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;W({category:e,name:arguments.length>1&&void 0!==arguments[1]?arguments[1]:""}),B(t),T(!0)},K=function(e){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;W({category:e,name:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",address:arguments.length>2&&void 0!==arguments[2]?arguments[2]:""}),B(t),T(!0)},V=()=>{T(!1),B(null),W({category:"",name:"",address:""})},X=e=>{"address"===e.target.name?W((0,r.A)((0,r.A)({},E),{},{[e.target.name]:e.target.value})):W((0,r.A)((0,r.A)({},E),{},{name:e.target.value}))},Q=async e=>{try{const{category:r,name:l,address:n}=E;if(!l.trim())return;const i={"Digital Payment Channels":"/Lookup/payment-channel","Payment Methods":"/Lookup/payment-type","Hospital Services":"/Lookup/payment-purpose","CBHI Providers":"/Providers/add-provider","Organizations with Agreements":"/Organiztion/Organization"},d={"Digital Payment Channels":"/Lookup/payment-channel","Payment Methods":"/Lookup/payment-type","Hospital Services":"/Lookup/payment-purpose","CBHI Providers":"/Providers/update-provider","Organizations with Agreements":"/Organiztion/Organization"},s={"Digital Payment Channels":{channel:l,createdBy:D.name},"Payment Methods":{type:l,createdBy:D.name},"Hospital Services":e,"CBHI Providers":{provider:l,service:"CBHI",createdBy:D.name},"Organizations with Agreements":{organization:l,address:n,createdBy:D.name}},c={"Digital Payment Channels":{id:Number(z),channel:l,updatedBy:D.name,updatedOn:(new Date).toISOString()},"Payment Methods":{id:Number(z),type:l,updatedBy:D.name,updatedOn:(new Date).toISOString()},"Hospital Services":{id:Number(z),purpose:l,updatedBy:D.name,updatedOn:(new Date).toISOString()},"CBHI Providers":{id:Number(z),provider:l,service:"CBHI",updatedBy:D.name,updatedOn:(new Date).toISOString()},"Organizations with Agreements":{id:Number(z),organization:l,address:n,updatedBy:D.name,updatedOn:(new Date).toISOString()}};if(null!==z&&d[r])try{await w.A.put(d[r],c[r]),g.oR.success("".concat(r," updated successfully!")),U((e=>!e)),V()}catch(a){var o;console.error("Update error:",a),g.oR.error((null===a||void 0===a||null===(o=a.response)||void 0===o?void 0:o.data)||"Error updating data!")}if(i[r]&&null===z)try{q(!0);const e=await w.A.post(i[r],s[r],{headers:{"Content-Type":"application/json"}});if(201===e.status||200===e.status)return g.oR.success("".concat(r," added successfully!")),U((e=>!e)),t(!1),void V()}catch(a){console.error("Upload error:",a),g.oR.error("Error Uploading data!")}finally{q(!1)}}catch(a){var r;console.error("Error:",a),g.oR.error((null===a||void 0===a||null===(r=a.response)||void 0===r?void 0:r.data)||"Internal Server Error!")}},J=async(e,t)=>{try{const o={"Digital Payment Channels":"/Lookup/payment-channel","Hospital Services":"/Lookup/payment-purpose","Payment Methods":"/Lookup/payment-type","CBHI Providers":"/Providers/delete-provider","Organizations with Agreements":"/Organiztion/Organization"};if(o[e]){200===(await w.A.delete(o[e],{headers:{"Content-Type":"application/json"},data:{id:t,deletedBy:D.name}})).status&&(g.oR.success("".concat(e," deleted successfully!")),U((e=>!e)))}else console.warn("No API endpoint found for category: ".concat(e))}catch(o){console.error("Error deleting category:",o),g.oR.error("Failed to delete item. Please try again.")}};return(0,M.jsxs)(s.A,{children:[(0,M.jsx)(c.A,{variant:"h4",gutterBottom:!0,children:"Payment Management"}),R.map((e=>(0,M.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,M.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:e}),(0,M.jsx)(u.A,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1,children:(0,M.jsxs)(i.A,{variant:"contained",color:"light"===Y.palette.mode?"primary":"secondary",startIcon:(0,M.jsx)(I.A,{}),onClick:()=>{var o;"Organizations with Agreements"===e?K(e):"Hospital Services"===e?(W({category:o=e,name:o,address:""}),B(null),t(!0)):$(e)},children:["Add ",e]})}),(()=>{const{rows:t,columns:r}=(e=>{const t=(o[e]||[]).map((t=>({id:t.id,name:"Digital Payment Channels"===e?t.channel:"Payment Methods"===e?t.type:"Hospital Services"===e?t.purpose:"CBHI Providers"===e?t.provider:t.organization,createdBy:t.createdby,location:"Organizations with Agreements"===e?t.location:"",amount:"Hospital Services"===e?(0,S.formatAccounting2)(t.amount):0,shortCodes:t.shortCodes,group:t.group,subgroup:t.subgroup})));let r=[];return r="Hospital Services"===e?[{field:"name",headerName:"Name",flex:1.1},{field:"shortCodes",headerName:"ShortCode",flex:1},{field:"group",headerName:"Group",flex:1},{field:"subgroup",headerName:"SubGroup",flex:1},{field:"amount",headerName:"Amount",flex:.5}]:"Organizations with Agreements"===e?[{field:"name",headerName:"Name",flex:1},{field:"location",headerName:"Address",flex:1}]:[{field:"name",headerName:"Name",flex:1}],r.push({field:"actions",headerName:"Actions",flex:.5,renderCell:t=>{var o,r;return"SYS"!==(null===t||void 0===t||null===(o=t.row)||void 0===o||null===(r=o.createdBy)||void 0===r?void 0:r.toUpperCase())&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(d.A,{onClick:()=>{"Organizations with Agreements"===e||"Hospital Services"===e?K(e,t.row.name,t.row.location,t.row.id):$(e,t.row.name,t.row.id)},children:(0,M.jsx)(k.A,{})}),(0,M.jsx)(d.A,{onClick:()=>J(e,t.row.id),color:"error",children:(0,M.jsx)(O.A,{})})]})}}),{rows:t,columns:r}})(e);return(0,M.jsx)(C.z,{rows:t,columns:r,autoHeight:!0,sx:{minWidth:320},slots:{toolbar:()=>(0,M.jsx)(_,{rows:t,columns:r,category:e})}})})()]},e))),(0,M.jsxs)(p.A,{open:N,onClose:(e,t)=>{"backdropClick"!==t&&"escapeKeyDown"!==t&&V()},disableEnforceFocus:!0,BackdropProps:{"aria-hidden":!1},children:[(0,M.jsxs)(m.A,{children:[null!==z?"Edit":"Add"," ",E.category]}),(0,M.jsxs)(f.A,{style:{display:"flex",msFlexDirection:"column",height:"Organizations with Agreements"===(null===E||void 0===E?void 0:E.category)?"150px":"100px",alignItems:"center",justifyContent:"center",flexDirection:"column"},children:[(0,M.jsx)(h.A,{fullWidth:!0,label:"Name",name:"name",value:E.name,onChange:X,autoFocus:!0,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===Y.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===Y.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===Y.palette.mode?"#fff":"#000"},color:"dark"===Y.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===Y.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===Y.palette.mode?"#fff":"#000"}}}}),"Organizations with Agreements"===(null===E||void 0===E?void 0:E.category)&&(0,M.jsx)(h.A,{fullWidth:!0,label:"Address",name:"address",value:(null===E||void 0===E?void 0:E.address)||"",onChange:X,autoFocus:!0,sx:{marginTop:"10px"},InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===Y.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===Y.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===Y.palette.mode?"#fff":"#000"},color:"dark"===Y.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===Y.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===Y.palette.mode?"#fff":"#000"}}}})]}),(0,M.jsxs)(v.A,{children:[(0,M.jsx)(i.A,{onClick:V,color:"error",children:"Cancel"}),(0,M.jsx)(i.A,{variant:"contained",color:"light"===Y.palette.mode?"primary":"success",onClick:Q,children:"Save"})]})]}),(0,M.jsx)(x.A,{isOpen:e,setIsOpen:t,loading:L,setLoading:q,onSubmit:Q}),(0,M.jsx)(g.N9,{})]})}},54582:(e,t,o)=>{o.d(t,{A:()=>u});var r=o(65043),a=o(26240),l=o(31036),n=o(63777),i=o(77265),d=o(83074),s=o(70579);const c=(0,d.N8)(),u=e=>{let{isDashboard:t=!1}=e;const o=(0,a.A)(),d=(0,n.LU)(o.palette.mode),u=new Date,p=new Date(u);p.setDate(u.getDate()-7);const[m,f]=(0,r.useState)([]);return(0,r.useEffect)((()=>{(async()=>{try{var e;const t=await i.A.put("/Payment/Get-all-Payment",{startDate:p,endDate:u,user:null===c||void 0===c?void 0:c.name}),o=null!==t&&void 0!==t&&t.data?null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.reduce(((e,t)=>{const{paymentType:o,paymentAmount:r}=t;return e[o]||(e[o]=0),e[o]+=parseFloat(r),e}),{}):[],r=Object.entries(o).map((e=>{let[t,o]=e;return{method:t,amount:o}}));r.sort(((e,t)=>t.y-e.y)),f(r)}catch(t){console.error("Error:",t)}})()}),[]),(0,s.jsx)(l.ED,{data:m,indexBy:"method",keys:["amount"],margin:{top:50,right:130,bottom:50,left:60},padding:.3,theme:{axis:{domain:{line:{stroke:d.grey[100]}},legend:{text:{fill:d.grey[100]}},ticks:{line:{stroke:d.grey[100],strokeWidth:1},text:{fill:d.grey[100]}}},legends:{text:{fill:d.grey[100]}}},colors:d.greenAccent[500],axisBottom:{tickSize:5,tickPadding:5,tickRotation:0,legend:t?void 0:"Payment Type",legendPosition:"middle",legendOffset:32},axisLeft:{tickSize:5,tickPadding:5,tickRotation:0,legend:t?void 0:"Amount",legendPosition:"middle",legendOffset:-40},legends:[{dataFrom:"keys",anchor:"bottom-right",direction:"column",justify:!1,translateX:120,translateY:0,itemsSpacing:2,itemWidth:100,itemHeight:20,itemDirection:"left-to-right",itemOpacity:.85,symbolSize:20,effects:[{on:"hover",style:{itemOpacity:1}}]}],role:"application",barAriaLabel:function(e){return e.id+": "+e.formattedValue+" in category: "+e.indexValue}})}},56181:(e,t,o)=>{o.r(t),o.d(t,{default:()=>M});var r=o(80045),a=o(89379),l=o(65043),n=o(26240),i=o(71716),d=o(46946),s=o(65204),c=o(94496),u=o(8591),p=o(88911),m=o(39336),f=o(42788),h=o(56894),v=o(97334),x=o(72882),g=o(61976),A=o(83560),b=o(57488),y=(o(92342),o(27073)),j=o.n(y),C=o(48292),k=o(77265),O=o(83074),I=o(70579);const w=["accedentRecId","patientMiddleName","patientLastName","patientFirstName"],N={patientCardNumber:"",patientAge:"",accedentDate:"",acceedentAddress:"",carCertificate:"",plateNumber:"",policeName:"",policePhone:""},S=(e,t)=>{try{return"Reset"===t.name?N:(0,a.A)((0,a.A)({},e),{},{[t.name]:t.values})}catch(o){console.error("State Update Error: ",o)}};const M=function(){var e;const[t,o]=(0,l.useState)(N),[y,M]=(0,l.useReducer)(S,N),[P,D]=(0,l.useState)([]),[R,T]=(0,l.useState)(null),[E,W]=(0,l.useState)(!1),[L,q]=(0,l.useState)(!1),[z,B]=(0,l.useState)(!1),[F,U]=(0,l.useState)(""),H=(0,n.A)();(0,l.useEffect)((()=>{(async()=>{try{var e,t;const o=await k.A.put("/Patient/get-patient-accedent",{}),l=null===o||void 0===o||null===(e=o.data)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.map((e=>{let{accedentRecId:t,patientMiddleName:o,patientLastName:l,patientFirstName:n}=e,i=(0,r.A)(e,w);return(0,a.A)({id:t,patientName:n+" "+o+" "+l},i)}));200===(null===o||void 0===o?void 0:o.status)&&D(l.sort(((e,t)=>t.id-e.id)))}catch(n){var o,l;console.error("This is fetch table data error: ",n),b.oR.error((null===n||void 0===n||null===(o=n.response)||void 0===o||null===(l=o.data)||void 0===l?void 0:l.msg)||"Unable to Fetch Data")}})()}),[L]);const G=e=>{const{name:t,value:r}=e.target;"patientCardNumber"===t?(U(""),$(t,r)):"accedentDate"===t||"plateNumber"===t?K(t,r):"policeName"===t?Z(t,r):"policePhone"===t&&_(t,r),o((e=>(0,a.A)((0,a.A)({},e),{},{[t]:r})))},Y=[{field:"patientCardNumber",headerName:"MRN",flex:1},{field:"patientName",headerName:"Name",flex:1},{field:"patientAge",headerName:"Age",flex:1},{field:"accedentDate",headerName:"Date",flex:1,renderCell:e=>{var t;return(0,C.renderETDateAtCell)(null===e||void 0===e||null===(t=e.row)||void 0===t?void 0:t.accedentDate)}},{field:"plateNumber",headerName:"Plate Number",flex:1},{field:"carCertificate",headerName:"Car Certificate",flex:1,renderCell:e=>{var t,o,r;return(null===e||void 0===e||null===(t=e.row)||void 0===t||null===(o=t.carCertificate)||void 0===o?void 0:o.length)<=0?"Unspecified":null===e||void 0===e||null===(r=e.row)||void 0===r?void 0:r.carCertificate}},{field:"acceedentAddress",headerName:"Address",flex:2},{field:"policeName",headerName:"Police Name",flex:1},{field:"policePhone",headerName:"Police Phone",flex:1},{field:"actions",headerName:"Actions",flex:1,sortable:!1,renderCell:e=>(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(i.A,{onClick:()=>{var t;t=P.findIndex((t=>t.id===e.row.id)),o(P[t]),T(t)},children:(0,I.jsx)(A.A,{})})})}],_=(e,t)=>{!/^(?:\+251|09|07)\d+$/.test(t)&&t.length>0?M({name:e,values:"Phone number must start with +251, 09, or 07 and contain only numbers."}):t.startsWith("+251")&&13!==t.length?M({name:e,values:"Phone number starting with +251 must have 13 digits."}):(t.startsWith("09")||t.startsWith("07"))&&10!==t.length?M({name:e,values:"Phone number starting with 09 or 07 must have 10 digits."}):M({name:e,values:""})},Z=(e,t)=>{!/^[a-zA-Z\u1200-\u137F\s]{3,}$/.test(t)&&t.length>0?M({name:e,values:"Full Name must be only letters, at least 3 characters long."}):M({name:e,values:""})},$=(e,t)=>{!/^[0-9a-zA-Z\s\_\-]{5,}$/.test(t)&&t.length>0?M({name:e,values:"Please Insert Valid MRN, more than 5 digit only."}):M({name:e,values:""})},K=(e,t)=>{!/^[a-zA-Z0-9\u1200-\u137F\s]+$/.test(t)&&t.length>0?M({name:e,values:"Letters Number and space Only."}):M({name:e,values:""})};return(0,I.jsxs)(d.A,{p:3,component:s.A,sx:{marginInline:"15px"},elevation:4,borderRadius:3,children:[(0,I.jsx)(c.A,{variant:"h5",gutterBottom:!0,fontWeight:"bold",children:"\ud83d\udea8 Traffic Accident Registration"}),(0,I.jsxs)("form",{onSubmit:async e=>{try{var r;if(W(!0),e.preventDefault(),Object.values(y).some((e=>e.length>0)))return void b.oR.error("Please fix the erros first.");const l={id:null!==R?null===t||void 0===t?void 0:t.id:0,patientCardNumber:"".concat(Number(null===t||void 0===t?void 0:t.patientCardNumber)),accAddress:null===t||void 0===t?void 0:t.acceedentAddress,accDate:null===t||void 0===t||null===(r=t.accedentDate)||void 0===r?void 0:r.split("+")[0],policeName:null===t||void 0===t?void 0:t.policeName,policePhone:null===t||void 0===t?void 0:t.policePhone,plateNumber:null===t||void 0===t?void 0:t.plateNumber,certificate:null===t||void 0===t?void 0:t.carCertificate};if(null!==R){const e=await k.A.put("/Patient/change-patient-accedent",l);var a;if(200===(null===e||void 0===e?void 0:e.status))b.oR.success((null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.msg)||"Updated Successfully."),q((e=>!e)),T(null),o(N)}else{const e=await k.A.post("/Patient/add-patient-accedent",l);200===(null===e||void 0===e?void 0:e.status)&&(q((e=>!e)),b.oR.success("Recorded Successfully."),o(N),U(""))}}catch(i){var l,n;console.error("This is Submit Error: ",i),b.oR.error((null===i||void 0===i||null===(l=i.response)||void 0===l||null===(n=l.data)||void 0===n?void 0:n.msg)||"Internal Server Error.")}finally{W(!1)}},children:[(0,I.jsx)(u.Ay,{container:!0,spacing:2,mt:1,children:(0,I.jsx)(u.Ay,{item:!0,xs:12,children:(0,I.jsxs)(p.A,{direction:"row",spacing:2,divider:(0,I.jsx)(m.A,{orientation:"vertical",flexItem:!0}),sx:{width:"100%"},children:[(0,I.jsx)(d.A,{sx:{flex:1},children:(0,I.jsxs)(u.Ay,{container:!0,spacing:2,children:[(0,I.jsx)(u.Ay,{item:!0,xs:12,children:(0,I.jsx)(c.A,{variant:"subtitle1",fontWeight:"bold",children:"Patient Information"})}),(0,I.jsx)(u.Ay,{item:!0,xs:12,sm:6,children:(0,I.jsx)(f.A,{label:"MRN",name:"patientCardNumber",value:null===t||void 0===t?void 0:t.patientCardNumber,onChange:G,disabled:null!==R,fullWidth:!0,required:!0,error:!(null===y||void 0===y||!y.patientCardNumber),helperText:(null===y||void 0===y||null===(e=y.patientCardNumber)||void 0===e?void 0:e.length)>0?null===y||void 0===y?void 0:y.patientCardNumber:F,InputProps:{endAdornment:(0,I.jsx)(h.A,{position:"end",children:z&&(0,I.jsx)(v.A,{size:24,color:"inherit"})}),sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===H.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===H.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===H.palette.mode?"#fff":"#000"},color:"dark"===H.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===H.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===H.palette.mode?"#fff":"#000"}}},FormHelperTextProps:{style:{color:null!==y&&void 0!==y&&y.patientCardNumber?"red":"green",fontSize:"14px"}},onBlurCapture:()=>(async()=>{try{var e,o;if(B(!0),(null===F||void 0===F?void 0:F.length)<=0&&(null===y||void 0===y||null===(e=y.patientCardNumber)||void 0===e?void 0:e.length)<=0&&(null===t||void 0===t||null===(o=t.patientCardNumber)||void 0===o?void 0:o.length)>0){const e=await(0,O.rA)(null===t||void 0===t?void 0:t.patientCardNumber);(null===e||void 0===e?void 0:e.length)>0?U(e):b.oR.error("Card Number Not Registered.")}}catch(r){console.error(r)}finally{B(!1)}})()})}),(0,I.jsx)(u.Ay,{item:!0,xs:12,sm:6,children:(0,I.jsx)(d.A,{sx:{height:"56px",border:"1px dashed ".concat("dark"===H.palette.mode?"rgba(255,255,255,0.23)":"rgba(0,0,0,0.23)"),borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",color:"rgba(0,0,0,0.6)",fontStyle:"italic",paddingBottom:"71px"}})}),(0,I.jsx)(u.Ay,{item:!0,xs:12,children:(0,I.jsx)(c.A,{variant:"subtitle1",fontWeight:"bold",children:"Car Information (if Known)"})}),(0,I.jsx)(u.Ay,{item:!0,xs:12,sm:6,children:(0,I.jsx)(f.A,{label:"Car Plate Number",name:"plateNumber",value:null===t||void 0===t?void 0:t.plateNumber,onChange:G,fullWidth:!0,error:!(null===y||void 0===y||!y.plateNumber),helperText:null===y||void 0===y?void 0:y.plateNumber,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===H.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===H.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===H.palette.mode?"#fff":"#000"},color:"dark"===H.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===H.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===H.palette.mode?"#fff":"#000"}}}})}),(0,I.jsx)(u.Ay,{item:!0,xs:12,sm:6,children:(0,I.jsx)(f.A,{label:"Certificate",name:"carCertificate",value:null===t||void 0===t?void 0:t.carCertificate,onChange:G,fullWidth:!0,error:!(null===y||void 0===y||!y.carCertificate),helperText:null===y||void 0===y?void 0:y.carCertificate,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===H.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===H.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===H.palette.mode?"#fff":"#000"},color:"dark"===H.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===H.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===H.palette.mode?"#fff":"#000"}}}})})]})}),(0,I.jsx)(d.A,{sx:{flex:1},children:(0,I.jsxs)(u.Ay,{container:!0,spacing:2,children:[(0,I.jsx)(u.Ay,{item:!0,xs:12,children:(0,I.jsx)(c.A,{variant:"subtitle1",fontWeight:"bold",children:"Accident Information"})}),(0,I.jsx)(u.Ay,{item:!0,xs:12,sm:6,children:(0,I.jsx)(j(),{label:"Accident Date",name:"accedentDate",value:null!==t&&void 0!==t&&t.accedentDate?new Date(null===t||void 0===t?void 0:t.accedentDate):null,onChange:e=>((e,t)=>{let r;if(r=t instanceof Date?t:new Date(t),isNaN(r.getTime()))return void console.error("Invalid date provided to handleChangeTime:",t);const l=r.getTimezoneOffset(),n=Math.abs(l),i=String(Math.floor(n/60)).padStart(2,"0"),d=String(n%60).padStart(2,"0"),s=l<=0?"+":"-",c=new Date(r.getTime()-6e4*l).toISOString().slice(0,19).replace("T"," "),u="".concat(c," ").concat(s).concat(i,":").concat(d);o((t=>(0,a.A)((0,a.A)({},t),{},{[e]:u})))})("accedentDate",e),sx:{width:"100%"},required:!0},(null===t||void 0===t?void 0:t.accedentDate)||"accidentDate-date")}),(0,I.jsx)(u.Ay,{item:!0,xs:12,sm:6,children:(0,I.jsx)(f.A,{label:"Accident Address",name:"acceedentAddress",value:null===t||void 0===t?void 0:t.acceedentAddress,onChange:G,fullWidth:!0,multiline:!0,rows:2,required:!0,error:!(null===y||void 0===y||!y.acceedentAddress),helperText:null===y||void 0===y?void 0:y.acceedentAddress,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===H.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===H.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===H.palette.mode?"#fff":"#000"},color:"dark"===H.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===H.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===H.palette.mode?"#fff":"#000"}}}})}),(0,I.jsx)(u.Ay,{item:!0,xs:12,children:(0,I.jsx)(c.A,{variant:"subtitle1",fontWeight:"bold",children:"From the form filled out by the police"})}),(0,I.jsx)(u.Ay,{item:!0,xs:12,sm:6,children:(0,I.jsx)(f.A,{label:"Police Name",name:"policeName",value:null===t||void 0===t?void 0:t.policeName,onChange:G,fullWidth:!0,required:!0,error:!(null===y||void 0===y||!y.policeName),helperText:null===y||void 0===y?void 0:y.policeName,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===H.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===H.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===H.palette.mode?"#fff":"#000"},color:"dark"===H.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===H.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===H.palette.mode?"#fff":"#000"}}}})}),(0,I.jsx)(u.Ay,{item:!0,xs:12,sm:6,children:(0,I.jsx)(f.A,{label:"Police Phone",name:"policePhone",value:null===t||void 0===t?void 0:t.policePhone,onChange:G,fullWidth:!0,type:"tel",error:!(null===y||void 0===y||!y.policePhone),helperText:null===y||void 0===y?void 0:y.policePhone,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===H.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===H.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===H.palette.mode?"#fff":"#000"},color:"dark"===H.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===H.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===H.palette.mode?"#fff":"#000"}}}})})]})})]})})}),(0,I.jsxs)(d.A,{mt:3,display:"flex",justifyContent:"flex-end",gap:2,children:[(0,I.jsx)(x.A,{variant:"outlined",color:"error",onClick:()=>{o(N),M({name:"Reset"}),U(""),T(null)},children:"Cancel"}),(0,I.jsx)(x.A,{type:"submit",color:"dark"===H.palette.mode?"secondary":"primary",disabled:E,variant:"contained",children:E?(0,I.jsx)(v.A,{size:24,color:"inherit"}):null!==R?"Update":"Register"})]})]}),(0,I.jsxs)(d.A,{mt:5,children:[(0,I.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"Registered Records"}),(0,I.jsx)(d.A,{children:(0,I.jsx)(g.z,{rows:P,columns:Y,disableRowSelectionOnClick:!0,getRowId:e=>e.id,localeText:{noRowsLabel:"No traffic accident records to display"},autoHeight:!0,sx:{minWidth:320}})})]}),(0,I.jsx)(b.N9,{})]})}},56643:(e,t,o)=>{o.r(t),o.d(t,{default:()=>O});var r=o(89379),a=o(65043),l=o(26240),n=o(46946),i=o(94496),d=o(65204),s=o(88911),c=o(72882),u=o(61976),p=o(60446),m=o.n(p),f=o(77265),h=o(69223),v=o.n(h),x=o(72450),g=o(27073),A=o.n(g),b=o(57488),y=(o(92342),o(48292)),j=o(83074),C=o(70579);const k=(0,j.N8)(),O=()=>{var e,t;const o=(0,l.A)(),[p,h]=(0,a.useState)(null===(e=m()().startOf("day"))||void 0===e?void 0:e.$d),[g,j]=(0,a.useState)(null===(t=m()().endOf("day"))||void 0===t?void 0:t.$d),[O,I]=(0,a.useState)([]),[w,N]=(0,a.useState)(!1),S=[{field:"cardNumber",headerName:"Card Number",flex:1},{field:"fullName",headerName:"Patient Name",flex:2},{field:"gender",headerName:"Gender",flex:1},{field:"services",headerName:"Services",flex:2.5},{field:"requestedBy",headerName:"Requested By",flex:1},{field:"department",headerName:"Requesting Department",flex:1.5},{field:"createdOn",headerName:"Created On",flex:1.5,renderCell:e=>{var t;return(0,y.renderETDateAtCell)((null===e||void 0===e||null===(t=e.row)||void 0===t?void 0:t.createdOn)||"1995-01-01")}}];return(0,C.jsxs)(n.A,{sx:{p:3},children:[(0,C.jsx)(i.A,{variant:"h5",gutterBottom:!0,fontWeight:600,children:"Doctor Request Viewer"}),(0,C.jsx)(d.A,{elevation:3,sx:{p:2,mb:2,backgroundColor:"dark"===o.palette.mode?"#12121200":o.palette.background.paper,borderRadius:2},children:(0,C.jsxs)(s.A,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",children:[(0,C.jsx)(A(),{label:"Start Date",value:p?new Date(p):null,onChange:e=>h(e),required:!0},p||"startDate"),(0,C.jsx)(A(),{label:"End Date",value:g?new Date(g):null,onChange:e=>j(e),required:!0},g||"endDate"),(0,C.jsx)(c.A,{variant:"contained",onClick:async()=>{try{var e,t,o,r;N(!0);const a=null!==k&&void 0!==k&&null!==(e=k.UserType)&&void 0!==e&&null!==(t=e.toLowerCase())&&void 0!==t&&t.includes("mlt")?"Lab":null===k||void 0===k?void 0:k.UserType,l=(null===(o=(await f.A.put("/Request/doctor/rpt-get-request",{start:p,end:g,requestedto:a||"-"})).data)||void 0===o||null===(r=o.data)||void 0===r?void 0:r.value)||[],n=l.filter((e=>{var t;return(null===(t=e.requestedDepartment)||void 0===t?void 0:t.toLowerCase())===(null===a||void 0===a?void 0:a.toLowerCase())})).map(((e,t)=>({id:t+1,cardNumber:e.patientCardNumber,fullName:"".concat(e.patientFirstName," ").concat(e.patientMiddleName," ").concat(e.patientLastName),gender:e.patientGender,department:e.requestingDepartment,createdOn:m()(e.createdOn).format("YYYY-MM-DD HH:mm"),requestedBy:e.requestedBy,services:e.requestedItems.map((e=>e.requestedServices)).join(", ")}))),i=null===n||void 0===n?void 0:n.sort(((e,t)=>e.createdOn-t.createdOn));I(i)}catch(n){var a,l;b.oR.error((null===(a=n.response)||void 0===a||null===(l=a.data)||void 0===l?void 0:l.msg)||"Something went wrong while fetching data."),console.error("This is fetchData Error : ",n)}finally{N(!1)}},disabled:w,color:"dark"===o.palette.mode?"secondary":"primary",sx:{minWidth:120,backgroundColor:"#2e8ac9"},children:w?"Loading...":"Search"}),(0,C.jsx)(c.A,{variant:"outlined",color:"success",onClick:async()=>{try{const e=new(v().Workbook),t=e.addWorksheet("Doctor Requests"),o=m()(p).format("YYYY-MM-DD"),a=m()(g).format("YYYY-MM-DD"),l=[{header:"Card Number",key:"cardNumber",width:15},{header:"Full Name",key:"fullName",width:30},{header:"Gender",key:"gender",width:10},{header:"Requesting Department",key:"department",width:20},{header:"Requested Services",key:"services",width:40},{header:"Requested By",key:"requestedBy",width:20},{header:"Created On",key:"createdOn",width:20,renderCell:e=>{var t;return(0,y.renderETDateAtCell)(null===e||void 0===e||null===(t=e.row)||void 0===t?void 0:t.createdOn)}}];t.columns=l,t.mergeCells("A1:G1");const n=t.getCell("A1");n.value="".concat(null===k||void 0===k?void 0:k.Hospital," - Doctor Requests Report"),n.font={bold:!0,size:16,color:{argb:"FF003366"}},n.alignment={vertical:"middle",horizontal:"center"},n.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFDEEAF6"}},n.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},t.mergeCells("A2:G2");const i=t.getCell("A2");i.value="Report Period: ".concat((0,y.renderETDateAtCell)(o)," to ").concat((0,y.renderETDateAtCell)(a)),i.font={italic:!0,size:12},i.alignment={vertical:"middle",horizontal:"center"};const d=t.getRow(3);l.forEach(((e,t)=>{const o=d.getCell(t+1);o.value=e.header,o.font={bold:!0},o.alignment={horizontal:"center",vertical:"middle",wrapText:!0},o.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFDDEEFF"}},o.border={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}}})),d.commit();[...O].sort(((e,t)=>new Date(e.createdOn)-new Date(t.createdOn))).forEach((e=>{var o;const a=(0,r.A)((0,r.A)({},e),{},{createdOn:(0,y.renderETDateAtCell)(null===e||void 0===e?void 0:e.createdOn)}),l=t.addRow(a),n=null===(o=a.services)||void 0===o?void 0:o.toLowerCase().includes("failed");l.eachCell((e=>{e.border={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}},n&&(e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFCCCC"}})}))}));const s=t.addRow([]);s.getCell(1).value="Total Requests: ".concat(O.length),s.getCell(1).font={bold:!0},t.mergeCells("A".concat(s.number,":G").concat(s.number)),s.alignment={horizontal:"left"},t.views=[{state:"frozen",ySplit:3}];const c=await e.xlsx.writeBuffer();(0,x.saveAs)(new Blob([c]),"DoctorRequests_".concat((0,y.renderETDateAtCell)(o),"_to_").concat((0,y.renderETDateAtCell)(a),".xlsx"))}catch(e){console.error("This is exportToExcel Error : ",e)}},disabled:!O.length,children:"Export to Excel"})]})}),(0,C.jsx)(d.A,{elevation:1,children:(0,C.jsx)(u.z,{rows:O,columns:S,loading:w,autoHeight:!0,sx:{minWidth:320,"& .MuiDataGrid-columnHeaders":{backgroundColor:o.palette.primary.light,fontWeight:"bold"},"& .MuiDataGrid-cell":{whiteSpace:"normal",wordBreak:"break-word"}}})}),(0,C.jsx)(b.N9,{})]})}},56937:(e,t,o)=>{o.r(t),o.d(t,{default:()=>T});var r=o(80045),a=o(89379),l=o(65043),n=o(26240),i=o(46946),d=o(65204),s=o(94496),c=o(8591),u=o(42788),p=o(56894),m=o(97334),f=o(94814),h=o(39336),v=o(71716),x=o(72882),g=o(51387),A=o(70141),b=o(57488),y=o(77265),j=o(83074),C=o(27073),k=o.n(C),O=o(9551),I=o(61976),w=o(48292),N=o(9092),S=o(70579);const M=["patientFirstName","patientMiddleName","patientLastName"],P=["services"],D={services:[],patientCardNumber:"",patientName:"",medicationUse:"",admissionDate:"",dischargeDate:"",patientCondition:""},R=(e,t)=>{if("Reset"===t.name)return D;if("services"===t.org){const o=[...e.services||[]];o[t.index]||(o[t.index]={name:"",quantity:"",unitCost:""});const r=o.map(((e,o)=>o===t.index?(0,a.A)((0,a.A)({},e),{},{[t.name]:t.values}):e));return(0,a.A)((0,a.A)({},e),{},{services:r})}return"Add Services"===t.name?(0,a.A)((0,a.A)({},e),{},{services:[...(null===e||void 0===e?void 0:e.services)||[],{name:"",quantity:"",unitCost:""}]}):"Remove Services"===t.name?(0,a.A)((0,a.A)({},e),{},{services:(e.services||[]).filter(((e,o)=>o!==t.index))}):(0,a.A)((0,a.A)({},e),{},{[t.name]:t.values})},T=()=>{var e,t;const o=(0,n.A)(),[C,T]=(0,l.useState)(D),[E,W]=(0,l.useReducer)(R,D),[L,q]=(0,l.useState)(!1),[z,B]=(0,l.useState)(!1),[F,U]=(0,l.useState)([]),[H,G]=(0,l.useState)(!1),[Y,_]=(0,l.useState)(!1),[Z,$]=(0,l.useState)([]);(0,l.useEffect)((()=>{(async()=>{try{const o=await y.A.put("/Patient/get-nurse-request",{});if(200===(null===o||void 0===o?void 0:o.status)){var e,t;const l=(null===o||void 0===o||null===(e=o.data)||void 0===e?void 0:e.length)>0?null===o||void 0===o||null===(t=o.data)||void 0===t?void 0:t.map(((e,t)=>{let{patientFirstName:o,patientMiddleName:l,patientLastName:n}=e,i=(0,r.A)(e,M);return(0,a.A)({patientFName:"".concat(o," ").concat(l," ").concat(n),id:t+1},i)})):[];U(null===l||void 0===l?void 0:l.sort(((e,t)=>new Date(t.createdOn)-new Date(e.createdOn))))}}catch(o){console.error("This is fetch data error: ",o)}})()}),[H]);const K=[{field:"patientCardNumber",headerName:"Card No",flex:1},{field:"patientFName",headerName:"Patient Name",flex:1},{field:"patientGender",headerName:"Gender",flex:1},{field:"totalPrice",headerName:"Total",flex:1,renderCell:e=>{var t;return(0,O.formatAccounting2)(null===e||void 0===e||null===(t=e.row)||void 0===t?void 0:t.totalPrice)}},{field:"paid",headerName:"Paid",flex:1,renderCell:e=>e.value?"\u2705":"\u274c"},{field:"createdBy",headerName:"Created By",width:100},{field:"createdOn",headerName:"Created On",flex:1,renderCell:e=>{var t;return(0,w.renderETDateAtCell)(null===e||void 0===e||null===(t=e.row)||void 0===t?void 0:t.createdOn)}}],V=(e,t)=>{if("dischargeDate"===e){const o=null===C||void 0===C?void 0:C.admissionDate;if(o&&t<o)return T((o=>(0,a.A)((0,a.A)({},o),{},{[e]:t}))),void W({name:e,values:"Discharge date cannot be before admission date (".concat((0,w.renderETDateAtCell)(o),")")})}T((o=>(0,a.A)((0,a.A)({},o),{},{[e]:t}))),W({name:e,values:""})},X=(e,t)=>{var o,r,l;if("patientCardNumber"===e.target.name)return T((0,a.A)((0,a.A)({},C),{},{patientName:"",[e.target.name]:e.target.value})),r=e.target.name,l=e.target.value,void(!/^[0-9]{5,}$/.test(l)&&(null===l||void 0===l?void 0:l.length)>0?W({name:r,values:"Please insert a valid MRN (at least 5 digits, numbers only)."}):W({name:r,values:""}));if(null!==(o=["quantity","unitCost","name"])&&void 0!==o&&o.includes(e.target.name)){var n;const o=[...null===C||void 0===C?void 0:C.services];return o[t][e.target.name]="name"!==e.target.name&&(null===(n=e.target.value)||void 0===n?void 0:n.length)>0?parseFloat(Math.abs(e.target.value)):e.target.value,T((e=>(0,a.A)((0,a.A)({},e),{},{services:o}))),void("name"===e.target.name?Q(t,e.target.name,e.target.value):J(t,e.target.name,e.target.value))}return"medicationUse"===e.target.name?(T((0,a.A)((0,a.A)({},C),{},{[e.target.name]:"Yes"===e.target.value||"No"!==e.target.value&&null})),void W({name:e.target.name,values:""})):("patientCondition"===e.target.name&&ee(e.target.name,e.target.value),"patientName"===e.target.name?(T((0,a.A)((0,a.A)({},C),{},{[e.target.name]:e.target.value})),void W({name:e.target.name,values:""})):void T((0,a.A)((0,a.A)({},C),{},{[e.target.name]:e.target.value})))},Q=(e,t,o)=>{!/^[A-Za-z\s]+$/.test(o)&&(null===o||void 0===o?void 0:o.length)>0?W({name:t,index:e,values:"Only letters and spaces allowed.",org:"services"}):W({name:t,index:e,values:"",org:"services"})},J=(e,t,o)=>{const r=Number(o);W(0===r?{org:"services",index:e,name:t,values:"Zero value is not allowed."}:{org:"services",index:e,name:t,values:""})},ee=(e,t)=>{!/^[A-Za-z\s]+$/.test(t)&&(null===t||void 0===t?void 0:t.length)>0?W({name:e,values:"Only letters and spaces allowed."}):W({name:e,values:""})},te=(null===C||void 0===C||null===(e=C.services)||void 0===e?void 0:e.length)>0?null===C||void 0===C||null===(t=C.services)||void 0===t?void 0:t.reduce(((e,t)=>e+t.quantity*t.unitCost),0):0;(0,l.useEffect)((()=>{if(null!==C&&void 0!==C&&C.admissionDate&&null!==C&&void 0!==C&&C.dischargeDate){const e=((e,t)=>{const o=new Date(e),r=new Date(t)-o,a=Math.ceil(r/864e5)+1;return a>0?a:1})(null===C||void 0===C?void 0:C.admissionDate,null===C||void 0===C?void 0:C.dischargeDate);T((t=>{const o=[...t.services||[]],r=o.findIndex((e=>"Bed"===e.name));return-1!==r?o[r]=(0,a.A)((0,a.A)({},o[r]),{},{quantity:e}):o.unshift({name:"Bed",quantity:e,unitCost:0}),(0,a.A)((0,a.A)({},t),{},{services:o})}))}else null!==C&&void 0!==C&&C.admissionDate&&null!==C&&void 0!==C&&C.dischargeDate||T((e=>{var t;return(0,a.A)((0,a.A)({},e),{},{services:(null===(t=e.services)||void 0===t?void 0:t.filter((e=>"Bed"!==e.name)))||[]})}))}),[null===C||void 0===C?void 0:C.admissionDate,null===C||void 0===C?void 0:C.dischargeDate]);return(0,S.jsxs)(i.A,{sx:{backgroundColor:"light"===o.palette.mode?"#f5f7fb":o.palette.background.default,minHeight:"100vh",py:6,px:{xs:2,sm:4,md:6}},children:[(0,S.jsxs)(d.A,{elevation:6,sx:{p:{xs:3,sm:5,md:6},borderRadius:4,backgroundColor:o.palette.background.paper},children:[(0,S.jsx)(s.A,{variant:"h4",fontWeight:700,textAlign:"center",gutterBottom:!0,children:"Patient Discharge Summary"}),(0,S.jsxs)(c.Ay,{container:!0,spacing:3,sx:{mb:4},children:[(0,S.jsx)(c.Ay,{item:!0,xs:12,md:4,children:(0,S.jsx)(u.A,{label:"Card / MRN Number",fullWidth:!0,required:!0,name:"patientCardNumber",value:null===C||void 0===C?void 0:C.patientCardNumber,onChange:X,onBlurCapture:async()=>{var e;if((null===C||void 0===C||null===(e=C.patientName)||void 0===e?void 0:e.length)<=0)try{var t,o;if(q(!0),(null===E||void 0===E||null===(t=E.patientCardNumber)||void 0===t?void 0:t.length)<=0&&(null===C||void 0===C||null===(o=C.patientCardNumber)||void 0===o?void 0:o.length)>0){const e=await(0,j.rA)(null===C||void 0===C?void 0:C.patientCardNumber);(null===e||void 0===e?void 0:e.length)>0?T((t=>(0,a.A)((0,a.A)({},t),{},{patientName:e}))):b.oR.error("Card Number Not Registered.")}}catch(r){console.error("Failed to fetch patient data:",r),b.oR.error("Failed to fetch patient data."),T((e=>(0,a.A)((0,a.A)({},e),{},{patientName:""})))}finally{q(!1)}},error:!(null===E||void 0===E||!E.patientCardNumber),helperText:null===E||void 0===E?void 0:E.patientCardNumber,InputProps:{endAdornment:(0,S.jsx)(p.A,{position:"end",children:L&&(0,S.jsx)(m.A,{size:24})}),sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},color:"dark"===o.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===o.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===o.palette.mode?"#fff":"#000"}}}})}),(0,S.jsx)(c.Ay,{item:!0,xs:12,md:5,children:(0,S.jsx)(u.A,{label:"Patient Name",fullWidth:!0,required:!0,name:"patientName",value:null===C||void 0===C?void 0:C.patientName,onChange:X,error:!(null===E||void 0===E||!E.patientName),helperText:null===E||void 0===E?void 0:E.patientName,disabled:!0,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},"&.Mui-disabled":{color:"rgba(41, 225, 48, 0.71)",fontWeight:"bold"},color:"dark"===o.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===o.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===o.palette.mode?"#fff":"#000"}}}})}),(0,S.jsx)(c.Ay,{item:!0,xs:12,md:3,children:(0,S.jsxs)(u.A,{select:!0,label:"Medication Use",name:"medicationUse",fullWidth:!0,required:!0,value:null===(null===C||void 0===C?void 0:C.medicationUse)||""===(null===C||void 0===C?void 0:C.medicationUse)?"":null!==C&&void 0!==C&&C.medicationUse?"Yes":"No",error:!(null===E||void 0===E||!E.medicationUse),helperText:null===E||void 0===E?void 0:E.medicationUse,onChange:X,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},color:"dark"===o.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===o.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===o.palette.mode?"#fff":"#000"}}},children:[(0,S.jsx)(f.A,{value:"",children:"-- Select --"}),(0,S.jsx)(f.A,{value:"Yes",children:"Yes"}),(0,S.jsx)(f.A,{value:"No",children:"No"})]})}),(0,S.jsx)(c.Ay,{item:!0,xs:6,md:3,children:(0,S.jsx)(k(),{label:"Date of Admission",name:"admissionDate",fullWidth:!0,required:!0,value:null!==C&&void 0!==C&&C.admissionDate?new Date(null===C||void 0===C?void 0:C.admissionDate):null,onChange:e=>V("admissionDate",e),error:!(null===E||void 0===E||!E.admissionDate),helperText:null===E||void 0===E?void 0:E.admissionDate,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},color:"dark"===o.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===o.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===o.palette.mode?"#fff":"#000"}}}},(null===C||void 0===C?void 0:C.admissionDate)||"admissionDate-date")}),(0,S.jsx)(c.Ay,{item:!0,xs:6,md:3,children:(0,S.jsx)(k(),{label:"Date of Discharge",name:"dischargeDate",fullWidth:!0,required:!0,value:null!==C&&void 0!==C&&C.dischargeDate?new Date(null===C||void 0===C?void 0:C.dischargeDate):null,onChange:e=>V("dischargeDate",e),error:!(null===E||void 0===E||!E.dischargeDate),helperText:null===E||void 0===E?void 0:E.dischargeDate,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},color:"dark"===o.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===o.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===o.palette.mode?"#fff":"#000"}}}},(null===C||void 0===C?void 0:C.dischargeDate)||"dischargeDate-date")}),(0,S.jsx)(c.Ay,{item:!0,xs:12,md:6,children:(0,S.jsx)(u.A,{label:"Patient Condition (e.g., Discharged / Death)",name:"patientCondition",fullWidth:!0,required:!0,value:null===C||void 0===C?void 0:C.patientCondition,onChange:X,error:!(null===E||void 0===E||!E.patientCondition),helperText:null===E||void 0===E?void 0:E.patientCondition,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},color:"dark"===o.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===o.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===o.palette.mode?"#fff":"#000"}}}})})]}),(0,S.jsx)(h.A,{sx:{my:4}}),(0,S.jsx)(s.A,{variant:"h6",fontWeight:600,gutterBottom:!0,children:"Services Provided"}),null===C||void 0===C?void 0:C.services.map(((e,t)=>{var r,l,n,i,d,p;return(0,S.jsxs)(c.Ay,{container:!0,spacing:2,alignItems:"center",sx:{mb:1,px:2,py:1.5,backgroundColor:o.palette.action.hover,borderRadius:2},children:[(0,S.jsx)(c.Ay,{item:!0,xs:12,sm:5,md:4,children:(0,S.jsx)(u.A,{label:"Service Name",name:"name",fullWidth:!0,required:!0,value:null===e||void 0===e?void 0:e.name,onChange:e=>X(e,t),error:!(null===E||void 0===E||null===(r=E.services[t])||void 0===r||!r.name),helperText:null===E||void 0===E||null===(l=E.services[t])||void 0===l?void 0:l.name,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},color:"dark"===o.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===o.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===o.palette.mode?"#fff":"#000"}}}})}),(0,S.jsx)(c.Ay,{item:!0,xs:4,sm:2,children:(0,S.jsx)(u.A,{label:"Qty",type:"number",name:"quantity",required:!0,fullWidth:!0,inputProps:{min:0},onWheel:e=>e.target.blur(),value:null===e||void 0===e?void 0:e.quantity,onChange:e=>X(e,t),error:!(null===E||void 0===E||null===(n=E.services[t])||void 0===n||!n.quantity),helperText:null===E||void 0===E||null===(i=E.services[t])||void 0===i?void 0:i.quantity,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},color:"dark"===o.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===o.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===o.palette.mode?"#fff":"#000"}}}})}),(0,S.jsx)(c.Ay,{item:!0,xs:4,sm:2,children:(0,S.jsx)(u.A,{label:"Unit Cost",type:"number",name:"unitCost",required:!0,fullWidth:!0,onWheel:e=>e.target.blur(),value:null===e||void 0===e?void 0:e.unitCost,onChange:e=>X(e,t),error:!(null===E||void 0===E||null===(d=E.services[t])||void 0===d||!d.unitCost),helperText:null===E||void 0===E||null===(p=E.services[t])||void 0===p?void 0:p.unitCost,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===o.palette.mode?"#fff":"#000"},color:"dark"===o.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===o.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===o.palette.mode?"#fff":"#000"}}}})}),(0,S.jsx)(c.Ay,{item:!0,xs:4,sm:2,children:(0,S.jsxs)(s.A,{fontWeight:500,children:[(0,O.formatAccounting)((null===e||void 0===e?void 0:e.quantity)*(null===e||void 0===e?void 0:e.unitCost))," \u1265\u122d"]})}),(0,S.jsx)(c.Ay,{item:!0,xs:12,sm:1,children:(0,S.jsx)(v.A,{color:"error",onClick:()=>(e=>{const t=[...null===C||void 0===C?void 0:C.services];T((o=>(0,a.A)((0,a.A)({},o),{},{services:t.filter(((t,o)=>o!==e))}))),W({name:"Remove Services",index:e})})(t),children:(0,S.jsx)(g.A,{})})})]},t)})),(0,S.jsx)(x.A,{startIcon:(0,S.jsx)(A.A,{}),onClick:()=>{T((e=>(0,a.A)((0,a.A)({},e),{},{services:[...(null===e||void 0===e?void 0:e.services)||[],{name:"",quantity:"",unitCost:""}]}))),W({name:"Add Services"})},color:"light"===o.palette.mode?"primary":"secondary",variant:"outlined",sx:{my:2,textTransform:"none",borderStyle:"dashed",fontWeight:500},children:"Add Service"}),(0,S.jsx)(i.A,{display:"flex",justifyContent:"flex-end",sx:{my:3},children:(0,S.jsx)(x.A,{variant:"outlined",color:"error",onClick:()=>{T(D),W({name:"Reset"})},children:"Cancel"})}),(0,S.jsx)(h.A,{sx:{my:3}}),(0,S.jsx)(i.A,{display:"flex",justifyContent:"flex-end",sx:{mb:3},children:(0,S.jsxs)(s.A,{variant:"h6",fontWeight:"bold",children:["Total: ",(0,O.formatAccounting)(te)," \u1265\u122d"]})}),(0,S.jsx)(x.A,{variant:"contained",color:"primary",fullWidth:!0,size:"large",onClick:async()=>{try{var e;B(!0);const t=Object.entries(C||{}).filter((e=>{let[t]=e;return"services"!==t}));if(Object.entries(E||{}).filter((e=>{let[t]=e;return"services"!==t})).some((e=>{let[t,o]=e;return(null===o||void 0===o?void 0:o.length)>0})))return void b.oR.error("Please first fix the error.");if(((null===E||void 0===E?void 0:E.services)||[]).some((e=>Object.values(e||{}).some((e=>(null===e||void 0===e?void 0:e.length)>0)))))return void b.oR.error("Please fix errors in service fields.");if(t.some((e=>{let[t,o]=e;return!o||(null===o||void 0===o?void 0:o.length)<=0})))return b.oR.error("Please fill the required fields."),void t.forEach((e=>{let[t,o]=e;(!o||o.length<=0)&&W({name:t,values:"Please fill this field"})}));if((null===C||void 0===C||null===(e=C.services)||void 0===e?void 0:e.length)<=0)return void b.oR.error("Please insert at least one service.");if(((null===C||void 0===C?void 0:C.services)||[]).some(((e,t)=>Object.entries(e||{}).some((e=>{let[o,r]=e;const a=!r||(null===r||void 0===r?void 0:r.length)<=0;return a&&W({org:"services",index:t,name:o,values:"Please fill this field"}),a})))))return void b.oR.error("Please insert at least one valid service.");const o={patientCardNumber:"".concat(Number(null===C||void 0===C?void 0:C.patientCardNumber)),dischargeDate:null===C||void 0===C?void 0:C.dischargeDate,admissionDate:null===C||void 0===C?void 0:C.admissionDate,hasMedication:null===C||void 0===C?void 0:C.medicationUse,patientCondition:null===C||void 0===C?void 0:C.patientCondition,services:null===C||void 0===C?void 0:C.services.map((e=>({service:e.name,amount:e.quantity,price:e.unitCost})))},r=await y.A.post("/Patient/add-nurse-request",o);200===(null===r||void 0===r?void 0:r.status)&&(G((e=>!e)),T(D),W({name:"Reset"}),b.oR.success("Submitted Successfully."))}catch(t){console.error("Submission failed:",t),b.oR.error("Failed to submit. Please try again.")}finally{B(!1)}},sx:{py:1.5,fontWeight:600},children:z?(0,S.jsx)(m.A,{size:24,color:"inherit"}):"Submit to Cashier"}),(0,S.jsx)(h.A,{sx:{mb:4}}),(0,S.jsx)(s.A,{variant:"h4",fontWeight:700,textAlign:"center",gutterBottom:!0,children:"Sent Requests"}),(0,S.jsx)(d.A,{elevation:6,sx:{borderRadius:4,backgroundColor:o.palette.background.paper,mt:5},children:(0,S.jsx)(I.z,{rows:F,columns:K,autoHeight:!0,sx:{backgroundColor:o.palette.background.default,borderRadius:2,minWidth:320},onRowDoubleClick:e=>{try{var t;const o=null===(t=e.row.rquestedServices||[])||void 0===t?void 0:t.map((e=>{let{services:t}=e,o=(0,r.A)(e,P);return(0,a.A)((0,a.A)({service:t},o),{},{catagory:"Used Service"})}));_(!0);const l=o.length>0?o.map(((t,o)=>(0,a.A)({id:o+1,patientFName:e.row.patientFName,patientCardNumber:e.row.patientCardNumber},t))):[];$(l)}catch(o){console.error("Double-click error: ",o),b.oR.error("Unable to open Detail Data.")}},localeText:{noRowsLabel:"No Nurse Request"}})})]}),(0,S.jsx)(N.A,{open:Y,onClose:()=>{_(!1),$([])},rows:Z}),(0,S.jsx)(b.N9,{})]})}},58442:(e,t,o)=>{o.r(t),o.d(t,{default:()=>D});var r=o(89379),a=o(65043),l=o(26240),n=o(71716),i=o(19252),d=o(94496),s=o(65204),c=o(8591),u=o(42788),p=o(94814),m=o(72882),f=o(97334),h=o(95540),v=o(63471),x=o(61976),g=o(11238),A=o(33086),b=o(62954),y=o(77265),j=o(57488),C=(o(92342),o(83074)),k=o(83462),O=o(4219),I=o(97368),w=o(92064),N=o(70579);const S=e=>{let{open:t,onClose:o,creditUserData:l,onSave:n,isloading:i}=e;const[d,s]=(0,a.useState)((()=>void 0!==l?(0,r.A)({},l):{}));(0,a.useEffect)((()=>{s(l)}),[l]);const c=e=>{s((t=>(0,r.A)((0,r.A)({},t),{},{[e.target.name]:e.target.value})))};return(0,N.jsxs)(k.A,{open:t,onClose:(e,t)=>{"backdropClick"!==t&&"escapeKeyDown"!==t&&o()},maxWidth:"sm",disableEnforceFocus:!0,BackdropProps:{"aria-hidden":!1},fullWidth:!0,children:[(0,N.jsx)(O.A,{children:"Edit Credit Usesr"}),(0,N.jsxs)(I.A,{dividers:!0,children:[(0,N.jsx)(u.A,{margin:"dense",label:"Employee ID",name:"employeeID",fullWidth:!0,value:(null===d||void 0===d?void 0:d.employeeID)||"",onChange:c}),(0,N.jsx)(u.A,{margin:"dense",label:"Name",name:"employeeName",fullWidth:!0,value:(null===d||void 0===d?void 0:d.employeeName)||"",onChange:c}),(0,N.jsx)(u.A,{margin:"dense",label:"Phone",name:"employeePhone",fullWidth:!0,value:(null===d||void 0===d?void 0:d.employeePhone)||"",onChange:c}),(0,N.jsx)(u.A,{margin:"dense",label:"Email",name:"employeeEmail",fullWidth:!0,value:(null===d||void 0===d?void 0:d.employeeEmail)||"",onChange:c})]}),(0,N.jsxs)(w.A,{children:[(0,N.jsx)(m.A,{onClick:o,color:"inherit",children:"Cancel"}),(0,N.jsx)(m.A,{onClick:()=>{n({editedData:d,message:"Edit"}),o()},variant:"contained",color:"primary",children:i?(0,N.jsx)(f.A,{size:24,color:"inherit"}):"Save"})]})]})};var M=o(16005);const P=(0,C.N8)(),D=()=>{const[e,t]=(0,a.useState)([]),[o,C]=(0,a.useState)([]),[k,O]=(0,a.useState)([]),[I,w]=(0,a.useState)(!1),[D,R]=(0,a.useState)(null),[T,E]=(0,a.useState)(!1),[W,L]=(0,a.useState)(null),[q,z]=(0,a.useState)(!1),[B,F]=(0,a.useState)(!1),[U,H]=(0,a.useState)(!1),[G,Y]=(0,a.useState)(!1),[_,Z]=(0,a.useState)(!1),[$,K]=(0,a.useState)(!1),[V,X]=(0,a.useState)({organization:"",option:""}),[Q,J]=(0,a.useState)([]),[ee,te]=(0,a.useState)(""),oe=(0,l.A)();(0,a.useEffect)((()=>{(async()=>{try{const e=await y.A.get("/Organiztion/get-workers");O((null===e||void 0===e?void 0:e.data)<=0?new Array:null===e||void 0===e?void 0:e.data)}catch(t){var e;console.error(t),j.oR.error((null===t||void 0===t||null===(e=t.response)||void 0===e?void 0:e.data)||"Failde To Load list.")}})()}),[$]);const re=async o=>{try{if("Edit"===o.message){if(e.length>0){const a=null===e||void 0===e?void 0:e.map((e=>{var t;return e.id===(null===o||void 0===o||null===(t=o.editedData)||void 0===t?void 0:t.id)?(0,r.A)((0,r.A)({},e),null===o||void 0===o?void 0:o.editedData):e}));t(a)}E(!0)}else w(!0),R(null===o||void 0===o?void 0:o.row)}catch(a){console.error("This is handle Edit Error: ",a)}finally{E(!1)}},ae=async o=>{try{var r;if("Delete"===o.message)e.length>0&&t((e=>e.filter((e=>e.employeeID!==(null===o||void 0===o?void 0:o.userData))))),z(!0),Z(!1),L(null);else Z(!0),L(null===o||void 0===o||null===(r=o.row)||void 0===r?void 0:r.employeeID)}catch(a){console.error("This is handle confirm Error: ",a)}finally{z(!1)}},le=[{field:"employeeID",headerName:"Employee ID",flex:1},{field:"employeeName",headerName:"Employee Name",flex:1},{field:"employeePhone",headerName:"Phone",flex:1},{field:"employeeEmail",headerName:"Email",flex:1},{field:"workPlace",headerName:"Organization",flex:1},{field:"actions",headerName:"Actions",width:130,renderCell:e=>(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(n.A,{onClick:()=>re(e),color:"info","aria-label":"edit",className:"text-info",children:(0,N.jsx)(h.A,{})}),(0,N.jsx)(n.A,{color:"error",onClick:()=>ae(e),"aria-label":"delete",className:"text-danger",children:(0,N.jsx)(v.A,{})})]})}];(0,a.useEffect)((()=>{(async()=>{try{const t=await y.A.get("/Organiztion/Organization");var e;if(200===(null===t||void 0===t?void 0:t.status)||201===(null===t||void 0===t?void 0:t.status))J(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.map((e=>e.organization)))}catch(t){console.error(t.message)}})()}),[]);const ne=e=>{C([]),te(""),X((0,r.A)((0,r.A)({},V),{},{[e.target.name]:e.target.value}))};return(0,N.jsxs)(i.A,{children:[(0,N.jsx)(d.A,{variant:"h5",gutterBottom:!0,children:"Credit Users"}),(0,N.jsx)(s.A,{sx:{padding:2,marginBottom:2},children:(0,N.jsxs)(c.Ay,{children:[(0,N.jsxs)(c.Ay,{container:!0,spacing:2,children:[(0,N.jsx)(c.Ay,{item:!0,xs:4,children:(0,N.jsx)(u.A,{select:!0,fullWidth:!0,label:"Organization",variant:"filled",name:"organization",value:V.organization,onChange:ne,margin:"normal",required:!0,InputLabelProps:{sx:{color:"primary.neutral","&.Mui-focused":{color:"secondary.main"}}},children:Q.map(((e,t)=>(0,N.jsx)(p.A,{value:e,children:e},t)))})}),(0,N.jsx)(c.Ay,{item:!0,xs:3,children:(0,N.jsx)(u.A,{select:!0,fullWidth:!0,label:"Option",name:"option",variant:"filled",value:V.option,onChange:ne,margin:"normal",required:!0,InputLabelProps:{sx:{color:"primary.neutral","&.Mui-focused":{color:"secondary.main"}}},children:["New","Extend"].map(((e,t)=>(0,N.jsx)(p.A,{value:e,children:e},t)))})}),(0,N.jsxs)(c.Ay,{item:!0,xs:5,sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,N.jsx)("input",{accept:".xlsx, .xls",type:"file",onChange:e=>{(e=>{try{if(H(!0),C([]),te(""),!V.organization)return j.oR.error("Please First Select Organization."),void(e.target.value=null);if(!V.option)return j.oR.error("Please First Select Option."),void(e.target.value=null);const o=e.target.files[0];if(!o)return;const a=new FileReader;a.onload=o=>{const a=new Uint8Array(o.target.result),l=g.LF(a,{type:"array"}),n=l.SheetNames[0],i=l.Sheets[n],d=g.Wp.sheet_to_json(i).map(((e,t)=>(0,r.A)((0,r.A)({},e),{},{id:t+1,workPlace:null===V||void 0===V?void 0:V.organization,option:null===V||void 0===V?void 0:V.option})));t(d),e.target.value=null},a.readAsArrayBuffer(o)}catch(o){console.error(o)}finally{H(!1)}})(e)},style:{display:"none"},id:"upload-excel"}),(0,N.jsx)("label",{htmlFor:"upload-excel",children:(0,N.jsx)(m.A,{variant:"contained",color:"light"===oe.palette.mode?"primary":"secondary",component:"span",startIcon:(0,N.jsx)(b.A,{}),children:U?(0,N.jsx)(f.A,{size:24,color:"inherit"}):"Upload Excel"})}),(0,N.jsx)(n.A,{onClick:()=>{t([]),X({organization:"",option:""}),C([]),te("")},color:"error",sx:{marginLeft:2},children:(0,N.jsx)(A.A,{})}),(0,N.jsx)(m.A,{variant:"contained",color:"light"===oe.palette.mode?"primary":"secondary",onClick:async()=>{try{F(!0);await y.A.post("/Organiztion/add-workers",{employeeID:e.map((e=>null===e||void 0===e?void 0:e.employeeID)),employeeName:e.map((e=>null===e||void 0===e?void 0:e.employeeName)),employeePhone:e.map((e=>null===e||void 0===e?void 0:e.employeePhone)),employeeEmail:e.map((e=>null===e||void 0===e?void 0:e.employeeEmail)),isExtend:"Extend"===(null===V||void 0===V?void 0:V.option),workplace:null===V||void 0===V?void 0:V.organization,uploadedBy:null===P||void 0===P?void 0:P.name});j.oR.success("Upload Successful."),K((e=>!e)),t([]),X({organization:"",option:""})}catch(o){console.error("Upload error:",o),j.oR.error("Upload error.")}finally{F(!1)}},sx:{marginLeft:2},disabled:0===e.length,children:B?(0,N.jsx)(f.A,{size:24,color:"inherit"}):"Upload to Database"})]})]}),(0,N.jsxs)(c.Ay,{container:!0,spacing:2,sx:{marginTop:"10px"},children:[(0,N.jsx)(c.Ay,{item:!0,xs:11,children:(0,N.jsx)(u.A,{fullWidth:!0,type:"text",label:"Search By Employee ID",value:ee,onChange:e=>{C([]),te(e.target.value)},InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===oe.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===oe.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===oe.palette.mode?"#fff":"#000"},color:"dark"===oe.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===oe.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===oe.palette.mode?"#fff":"#000"}}}})}),(0,N.jsx)(c.Ay,{item:!0,xs:1,sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,N.jsx)(m.A,{variant:"contained",color:"light"===oe.palette.mode?"primary":"secondary",onClick:()=>(async()=>{try{var e;if(Y(!0),!ee)return void j.oR.error("Please insert something to search field");const t=await y.A.get("/Organiztion/get-workers/".concat(ee));0===(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.length)&&j.oR.info("Employee ID : ".concat(ee," not Found.")),C(null===t||void 0===t?void 0:t.data)}catch(t){console.error(t),j.oR.error("Unable to search.")}finally{Y(!1)}})(),children:G?(0,N.jsx)(f.A,{size:24,color:"inherit"}):"Search"})})]}),(0,N.jsx)(d.A,{variant:"h6",sx:{m:"15px 0 5px 20px"},children:o.length>0?"Viewing Search Result":e.length>0?"Viewing from File":"Viewing Registered"})]})}),(0,N.jsx)(s.A,{sx:{height:400},children:(0,N.jsx)(x.z,{rows:o.length>0?o:e.length<=0?k:e,columns:le,components:{ErrorOverlay:()=>(j.oR.error("Id Missing"),(0,N.jsx)("div",{style:{padding:"20px",color:"red"},children:"An error occurred: Id Missing"}))},autoHeight:!0,sx:{minWidth:320}})}),(0,N.jsx)(S,{open:I,onClose:()=>{w(!1),R(null),E(!1)},creditUserData:D,onSave:re,isloading:T}),(0,N.jsx)(M.A,{isOpen:_,onClose:()=>{Z(!1),L(null),z(!1)},onConfirm:ae,userData:W,loading:q}),(0,N.jsx)(j.N9,{})]})}},61466:(e,t,o)=>{o.r(t),o.d(t,{default:()=>m});var r=o(46946),a=o(42788),l=o(72882),n=o(63516),i=o(73033),d=o(30344),s=o(37660),c=o(70579);const u=i.Ik().shape({firstName:i.Yj().required("required"),lastName:i.Yj().required("required"),email:i.Yj().email("invalid email").required("required"),contact:i.Yj().matches(/^((\+[1-9]{1,4}[ -]?)|(\([0-9]{2,3}\)[ -]?)|([0-9]{2,4})[ -]?)*?[0-9]{3,4}[ -]?[0-9]{3,4}$/,"Phone number is not valid").required("required"),address1:i.Yj().required("required"),address2:i.Yj().required("required")}),p={firstName:"",lastName:"",email:"",contact:"",address1:"",address2:""},m=()=>{const e=(0,d.A)("(min-width:600px)");return(0,c.jsxs)(r.A,{m:"20px",children:[(0,c.jsx)(s.A,{title:"CREATE USER",subtitle:"Create a New User Profile"}),(0,c.jsx)(n.l1,{onSubmit:e=>{console.log(e)},initialValues:p,validationSchema:u,children:t=>{let{values:o,errors:n,touched:i,handleBlur:d,handleChange:s,handleSubmit:u}=t;return(0,c.jsxs)("form",{onSubmit:u,children:[(0,c.jsxs)(r.A,{display:"grid",gap:"30px",gridTemplateColumns:"repeat(4, minmax(0, 1fr))",sx:{"& > div":{gridColumn:e?void 0:"span 4"}},children:[(0,c.jsx)(a.A,{fullWidth:!0,variant:"filled",type:"text",label:"First Name",onBlur:d,onChange:s,value:o.firstName,name:"firstName",error:!!i.firstName&&!!n.firstName,helperText:i.firstName&&n.firstName,sx:{gridColumn:"span 2"}}),(0,c.jsx)(a.A,{fullWidth:!0,variant:"filled",type:"text",label:"Last Name",onBlur:d,onChange:s,value:o.lastName,name:"lastName",error:!!i.lastName&&!!n.lastName,helperText:i.lastName&&n.lastName,sx:{gridColumn:"span 2"}}),(0,c.jsx)(a.A,{fullWidth:!0,variant:"filled",type:"text",label:"Email",onBlur:d,onChange:s,value:o.email,name:"email",error:!!i.email&&!!n.email,helperText:i.email&&n.email,sx:{gridColumn:"span 4"}}),(0,c.jsx)(a.A,{fullWidth:!0,variant:"filled",type:"text",label:"Contact Number",onBlur:d,onChange:s,value:o.contact,name:"contact",error:!!i.contact&&!!n.contact,helperText:i.contact&&n.contact,sx:{gridColumn:"span 4"}}),(0,c.jsx)(a.A,{fullWidth:!0,variant:"filled",type:"text",label:"Address 1",onBlur:d,onChange:s,value:o.address1,name:"address1",error:!!i.address1&&!!n.address1,helperText:i.address1&&n.address1,sx:{gridColumn:"span 4"}}),(0,c.jsx)(a.A,{fullWidth:!0,variant:"filled",type:"text",label:"Address 2",onBlur:d,onChange:s,value:o.address2,name:"address2",error:!!i.address2&&!!n.address2,helperText:i.address2&&n.address2,sx:{gridColumn:"span 4"}})]}),(0,c.jsx)(r.A,{display:"flex",justifyContent:"end",mt:"20px",children:(0,c.jsx)(l.A,{type:"submit",color:"secondary",variant:"contained",children:"Create New User"})})]})}})]})}},66974:(e,t,o)=>{o.d(t,{A:()=>v});var r=o(89379),a=o(65043),l=o(26240),n=o(83462),i=o(4219),d=o(97368),s=o(42788),c=o(94814),u=o(92064),p=o(72882),m=o(97334),f=o(70579);const h=["EMAIL","SMS"],v=e=>{let{open:t,onClose:o,staffData:v,onSave:x,isloading:g}=e;const[A,b]=(0,a.useState)((()=>void 0!==v?(0,r.A)({},v):{})),y=(0,l.A)();(0,a.useEffect)((()=>{b(v)}),[v]);const j=e=>{b((t=>(0,r.A)((0,r.A)({},t),{},{[e.target.name]:e.target.value})))};return(0,f.jsxs)(n.A,{open:t,onClose:(e,t)=>{"backdropClick"!==t&&"escapeKeyDown"!==t&&o()},maxWidth:"sm",disableEnforceFocus:!0,fullWidth:!0,children:[(0,f.jsx)(i.A,{children:"Edit Staff"}),(0,f.jsxs)(d.A,{dividers:!0,children:[(0,f.jsx)(s.A,{margin:"dense",label:"Employee ID",name:"employeeID",fullWidth:!0,value:(null===A||void 0===A?void 0:A.employeeID)||"",onChange:j,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===y.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===y.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===y.palette.mode?"#fff":"#000"},color:"dark"===y.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===y.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===y.palette.mode?"#fff":"#000"}}}}),(0,f.jsx)(s.A,{margin:"dense",label:"Name",name:"employeeName",fullWidth:!0,value:(null===A||void 0===A?void 0:A.employeeName)||"",onChange:j,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===y.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===y.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===y.palette.mode?"#fff":"#000"},color:"dark"===y.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===y.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===y.palette.mode?"#fff":"#000"}}}}),(0,f.jsx)(s.A,{margin:"dense",label:"Phone",name:"employeePhone",fullWidth:!0,value:(null===A||void 0===A?void 0:A.employeePhone)||"",onChange:j,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===y.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===y.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===y.palette.mode?"#fff":"#000"},color:"dark"===y.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===y.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===y.palette.mode?"#fff":"#000"}}}}),(0,f.jsx)(s.A,{margin:"dense",label:"Email",name:"employeeEmail",fullWidth:!0,value:(null===A||void 0===A?void 0:A.employeeEmail)||"",onChange:j,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===y.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===y.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===y.palette.mode?"#fff":"#000"},color:"dark"===y.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===y.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===y.palette.mode?"#fff":"#000"}}}}),(0,f.jsx)(s.A,{margin:"dense",label:"Assigned As",name:"assignedAs",fullWidth:!0,value:(null===A||void 0===A?void 0:A.assignedAs)||"",onChange:j,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===y.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===y.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===y.palette.mode?"#fff":"#000"},color:"dark"===y.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===y.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===y.palette.mode?"#fff":"#000"}}}}),(0,f.jsx)(s.A,{margin:"dense",label:"Assigned By",name:"assignedBy",fullWidth:!0,value:(null===A||void 0===A?void 0:A.assignedBy)||"",onChange:j,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===y.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===y.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===y.palette.mode?"#fff":"#000"},color:"dark"===y.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===y.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===y.palette.mode?"#fff":"#000"}}}}),(0,f.jsx)(s.A,{select:!0,margin:"dense",label:"Contact Method",name:"contactMethod",fullWidth:!0,value:(null===A||void 0===A?void 0:A.contactMethod)||"",onChange:j,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===y.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===y.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===y.palette.mode?"#fff":"#000"},color:"dark"===y.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===y.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===y.palette.mode?"#fff":"#000"}}},children:h.map((e=>(0,f.jsx)(c.A,{value:e,children:e},e)))})]}),(0,f.jsxs)(u.A,{children:[(0,f.jsx)(p.A,{onClick:o,color:"error",children:"Cancel"}),(0,f.jsx)(p.A,{onClick:()=>{x(A),o()},variant:"contained",color:"light"===y.palette.mode?"primary":"secondary",children:g?(0,f.jsx)(m.A,{size:24,color:"inherit"}):"Save"})]})]})}},68957:(e,t,o)=>{o.r(t),o.d(t,{default:()=>w});var r=o(89379),a=o(80045),l=o(65043),n=o(26240),i=o(46946),d=o(94496),s=o(42788),c=o(72882),u=o(97334),p=o(61976),m=o(83462),f=o(4219),h=o(97368),v=o(39336),x=o(71861),g=o(92064),A=o(48292),b=o(9551),y=o(70579);const j=function(e){let{open:t,onClose:o,receipt:r,onConfirm:a,loading:n,theme:p}=e;const[j,C]=(0,l.useState)(""),[k,O]=(0,l.useState)(""),I=()=>{C(""),O(""),o()};return(0,y.jsxs)(m.A,{open:t,onClose:(e,t)=>{"backdropClick"!==t&&"escapeKeyDown"!==t&&I()},maxWidth:"sm",fullWidth:!0,disableEnforceFocus:!0,children:[(0,y.jsx)(f.A,{children:"Reversal Request"}),(0,y.jsxs)(h.A,{children:[(0,y.jsxs)(i.A,{mb:3,p:2,borderRadius:2,sx:{boxShadow:"inset 0px 0px 3px 2px #0000008a"},bgcolor:"light"===p.palette.mode&&"#f9f9f9",children:[(0,y.jsx)(d.A,{variant:"h6",gutterBottom:!0,children:"\ud83d\udcc4 Receipt Summary"}),(0,y.jsxs)(i.A,{display:"flex",justifyContent:"space-between",py:.5,children:[(0,y.jsx)(d.A,{color:"text.secondary",children:"Receipt No:"}),(0,y.jsx)(d.A,{fontWeight:600,children:null===r||void 0===r?void 0:r.referenceNo})]}),(0,y.jsxs)(i.A,{display:"flex",justifyContent:"space-between",py:.5,children:[(0,y.jsx)(d.A,{color:"text.secondary",children:"Patient Name:"}),(0,y.jsx)(d.A,{fontWeight:600,children:null===r||void 0===r?void 0:r.patientName})]}),(0,y.jsxs)(i.A,{display:"flex",justifyContent:"space-between",py:.5,children:[(0,y.jsx)(d.A,{color:"text.secondary",children:"Payment Reason:"}),(0,y.jsx)(d.A,{fontWeight:500,children:null===r||void 0===r?void 0:r.paymentReason})]}),(0,y.jsxs)(i.A,{display:"flex",justifyContent:"space-between",py:.5,children:[(0,y.jsx)(d.A,{color:"text.secondary",children:"Amount Paid:"}),(0,y.jsx)(d.A,{fontWeight:700,color:"green",children:(0,b.formatAccounting)(null===r||void 0===r?void 0:r.paymentAmount)})]}),(0,y.jsxs)(i.A,{display:"flex",justifyContent:"space-between",py:.5,children:[(0,y.jsx)(d.A,{color:"text.secondary",children:"Date:"}),(0,y.jsx)(d.A,{fontStyle:"italic",fontWeight:500,children:(0,A.renderETDateAtCell)(null===r||void 0===r?void 0:r.registeredOn)})]})]}),(0,y.jsx)(v.A,{}),(0,y.jsx)(i.A,{mt:5,children:(0,y.jsx)(s.A,{label:"Reason for Reversal",multiline:!0,fullWidth:!0,rows:3,required:!0,onChange:e=>(e=>{try{C(e.target.value)}catch(k){console.error("This is handle change error: ",k)}})(e),InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===p.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===p.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===p.palette.mode?"#fff":"#000"},color:"dark"===p.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===p.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===p.palette.mode?"#fff":"#000"}}}})}),k&&(0,y.jsx)(i.A,{mt:2,children:(0,y.jsx)(x.A,{severity:"error",children:k})})]}),(0,y.jsxs)(g.A,{children:[(0,y.jsx)(c.A,{onClick:I,color:"inherit",children:"Cancel"}),(0,y.jsx)(c.A,{variant:"contained",color:"error",onClick:()=>(()=>{try{if(!j.trim())return void O("Reversal reason is required.");if(j.length<10)return void O("Please describe it using more than 10 characters.");if(!/^[a-zA-Z0-9\u1200-\u137F\s]+$/.test(e=j)&&e.length>0)return void O("Please insert letters or numbers only.");const t={paymentRefNo:null===r||void 0===r?void 0:r.referenceNo,paymentType:(null===r||void 0===r?void 0:r.paymentType)||"-",cardNumber:(null===r||void 0===r?void 0:r.patientCardNumber)||"-",amount:[{amount:-(null===r||void 0===r?void 0:r.paymentAmount)||0,purpose:(null===r||void 0===r?void 0:r.paymentReason)||"-"}],description:j||"-",channel:(null===r||void 0===r?void 0:r.paymentChannel)||"-",organization:(null===r||void 0===r?void 0:r.patientWorkingPlace)||"-",paymentVerifingID:(null===r||void 0===r?void 0:r.paymentVerifingID)||"-",patientWorkID:(null===r||void 0===r?void 0:r.patientWorkID)||"-",reverse:!0};a(t)}catch(k){console.error(k)}var e})(),children:n?(0,y.jsx)(u.A,{size:24,color:"inherit"}):"Confirm Reversal"})]})]})};var C=o(57488),k=(o(92342),o(77265)),O=o(17555);const I=["rowId"],w=()=>{const[e,t]=(0,l.useState)(""),[o,m]=(0,l.useState)([]),[f,h]=(0,l.useState)(null),[v,x]=(0,l.useState)(!1),[g,w]=(0,l.useState)(!1),[N,S]=(0,l.useState)(!1),[M,P]=(0,l.useState)(""),[D,R]=(0,l.useState)(!1),T=(0,n.A)(),E=/^[a-zA-Z0-9-]+$/,W=[{field:"referenceNo",headerName:"Receipt No",flex:1},{field:"patientCardNumber",headerName:"Card Number",flex:1},{field:"patientName",headerName:"Patient",flex:1},{field:"paymentAmount",headerName:"Amount",flex:1,renderCell:e=>{var t;return(0,b.formatAccounting2)(null===e||void 0===e||null===(t=e.row)||void 0===t?void 0:t.paymentAmount)}},{field:"paymentType",headerName:"Type",flex:1},{field:"paymentReason",headerName:"Reason",flex:1},{field:"registeredOn",headerName:"Date",flex:1,renderCell:e=>{var t;return(0,A.renderETDateAtCell)(null===e||void 0===e||null===(t=e.row)||void 0===t?void 0:t.registeredOn)}},{field:"Status",headerName:"Status",flex:1,renderCell:e=>{var t;return(null===e||void 0===e||null===(t=e.row)||void 0===t?void 0:t.isReversed)&&(0,y.jsxs)("p",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start",padding:0,marginTop:"0",color:"red",gap:"3px"},children:[(0,y.jsx)(O.A,{color:"error",fontSize:"small"}),(0,y.jsx)("span",{children:"Reversed"})]})}}];return(0,y.jsxs)(i.A,{p:3,children:[(0,y.jsx)(d.A,{variant:"h5",gutterBottom:!0,children:"Receipt Reversal"}),(0,y.jsxs)(i.A,{display:"flex",alignItems:"center",gap:2,mb:2,children:[(0,y.jsx)(s.A,{label:"Search by Reference",variant:"outlined",size:"small",value:e,onChange:e=>{var o;t(e.target.value),o=e.target.value,!E.test(o)&&(null===o||void 0===o?void 0:o.length)>0?P("Please Insert Valid Receipt Number."):P("")},error:!!M,helperText:M,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},color:"dark"===T.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===T.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===T.palette.mode?"#fff":"#000"}}}}),(0,y.jsx)(c.A,{variant:"contained",color:"light"===T.palette.mode?"primary":"secondary",disabled:g,onClick:()=>(async()=>{try{var t,o;if(w(!0),(null===e||void 0===e?void 0:e.length)<=0)return void C.oR.error("Please Insert Reference Number First.");if(M)return void C.oR.error("Please Insert (VALID) Reference Number.");m([]);const l=await k.A.put("/Payment/payment-by-refno",{paymentId:e}),n=(null===l||void 0===l||null===(t=l.data)||void 0===t?void 0:t.length)>0?null===l||void 0===l||null===(o=l.data)||void 0===o?void 0:o.map((e=>{let{rowId:t}=e,o=(0,a.A)(e,I);return(0,r.A)({id:t},o)})):[];if((null===n||void 0===n?void 0:n.length)<=0)return void C.oR.info("Data not found.");m(n)}catch(i){var l,n;console.error("This is search error: ",i),C.oR.error((null===i||void 0===i||null===(l=i.response)||void 0===l||null===(n=l.data)||void 0===n?void 0:n.msg)||"Unable to search.")}finally{w(!1)}})(),children:g?(0,y.jsx)(u.A,{size:24,color:"inherit"}):"Search"})]}),(0,y.jsx)(i.A,{justifySelf:"flex-end",sx:{margin:"10px"},children:D?(0,y.jsx)(u.A,{size:24,color:"inherit"}):(0,y.jsx)(c.A,{variant:"contained",color:"warning",onClick:()=>(async()=>{try{if(R(!0),(null===o||void 0===o?void 0:o.length)<=0)return void C.oR.error("No Data.");const e=await o.reduce(((e,t)=>{for(const o in t)"paymentAmount"===o?e.paymentAmount=(e.paymentAmount||0)+t.paymentAmount:"paymentReason"===o?e.paymentReason=e.paymentReason?e.paymentReason+", "+t.paymentReason:t.paymentReason:e[o]=e[o]||t[o];return e}),{});return h(e),R(!1),void x(!0)}catch(e){console.error("This is handle Open Modal handler Error: ",e)}finally{R(!1)}})(),disabled:D||(null===o||void 0===o?void 0:o.some((e=>!0===e.isReversed))),children:"Reverse"})}),(0,y.jsx)(p.z,{rows:o,columns:W,loading:g,autoHeight:!0,sx:{minWidth:320}}),(0,y.jsx)(j,{open:v,onClose:()=>{x(!1),h(null),S(!1)},receipt:f,onConfirm:async e=>{try{S(!0);const o=await k.A.post("/Payment/add-payment",e,{headers:{"Content-Type":"application/json"}});200===(null===o||void 0===o?void 0:o.status)&&(C.oR.success("Transaction Reversed Successfully."),x(!1),m([]),t(""))}catch(a){var o,r;console.error("This is reversal handler error: ",a),C.oR.error((null===a||void 0===a||null===(o=a.response)||void 0===o||null===(r=o.data)||void 0===r?void 0:r.msg)||"Something went wrong! Unable to reverse.")}finally{S(!1)}},loading:N,theme:T}),(0,y.jsx)(C.N9,{})]})}},69320:(e,t,o)=>{o.r(t),o.d(t,{default:()=>I});var r=o(89379),a=o(65043),l=o(26240),n=o(46946),i=o(72882),d=o(94496),s=o(71716),c=o(63777),u=o(76790),p=o(65311),m=o(27518),f=o(57566),h=o(44533),v=o(30426),x=o(83074),g=o(77265),A=o(37762),b=o(65239),y=o.n(b),j=o(70579);const C=new Intl.NumberFormat("en-US",{style:"currency",currency:"ETB",minimumFractionDigits:2}),k=e=>{const t=C.format(Math.abs(e));return e<0?"(".concat(t,")"):t},O=(0,x.N8)(),I=()=>{const e=(0,l.A)(),t=(0,c.LU)(e.palette.mode),[o,x]=(0,a.useState)(!1),b=(0,a.useRef)(null),[C,I]=(0,a.useState)(0),[w,N]=(0,a.useState)(0),[S,M]=(0,a.useState)(0),[P,D]=(0,a.useState)(0),[R,T]=(0,a.useState)(0),[E,W]=(0,a.useState)({}),[L,q]=(0,a.useState)({}),[z,B]=(0,a.useState)([]),[F,U]=(0,a.useState)(0),{today:H,collectionnStartDate:G}=(0,a.useMemo)((()=>{const e=new Date,t=new Date(e);return t.setDate(e.getDate()-30),{today:e,collectionnStartDate:t}}),[]),Y=new Date(H);Y.setDate(H.getDate()-7);const _=new Date(H);_.setDate(H.getDate()-1);const Z=async()=>{try{var e;const t=await g.A.get("/Collection/rpt-uncollected"),o=null===t||void 0===t?void 0:t.data,a=o?null===o||void 0===o?void 0:o.reduce(((e,t)=>{const{cashier:o,cashAmount:r}=t;return e[o]=(e[o]||0)+parseFloat(r),e}),{}):[],l=Object.entries(a).map((e=>{let[t,o]=e;return{cashier:t,amount:o}})),n=null===(e=Object.values(a))||void 0===e?void 0:e.reduce(((e,t)=>e+t),0),{collectedByCashier:i,totalCollected:d}=await(async()=>{try{var e,t;const o=await g.A.put("/Collection/Get-all-Collection",{startDate:G.toISOString().split("T")[0],endDate:H.toISOString().split("T")[0],user:null===O||void 0===O?void 0:O.name,isCollected:0});return{collectedByCashier:null!==o&&void 0!==o&&o.data?null===o||void 0===o||null===(e=o.data)||void 0===e?void 0:e.reduce(((e,t)=>((!e[t.casher]||new Date(t.collectedOn)>new Date(e[t.casher].date))&&(e[t.casher]={date:t.collectedOn,amount:parseFloat(t.collectedAmount||0)}),e)),{}):[],totalCollected:(null!==o&&void 0!==o&&o.data?null===o||void 0===o||null===(t=o.data)||void 0===t?void 0:t.reduce(((e,t)=>e+parseFloat(t.collectedAmount||0)),0):[])||0}}catch(o){return console.error("Error fetching collected data:",o),{collectedByCashier:{},totalCollected:0}}})(),s=l.map((e=>{var t,o;return(0,r.A)((0,r.A)({},e),{},{date:(null===(t=i[e.cashier])||void 0===t?void 0:t.date)||null,collectedAmount:(null===(o=i[e.cashier])||void 0===o?void 0:o.amount)||0})}));B(s),N(n),U(d)}catch(t){console.error("Error fetching uncollected data:",t)}};return(0,a.useEffect)((()=>{Z()}),[G,null===O||void 0===O?void 0:O.name]),(0,a.useEffect)((()=>{(async()=>{try{var e;const t=await g.A.put("/Payment/Get-all-Payment",{startDate:Y.toISOString().split("T")[0],endDate:H.toISOString().split("T")[0],user:null===O||void 0===O?void 0:O.name}),o=null!==t&&void 0!==t&&t.data?null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.filter((e=>{const t=new Date(e.registeredOn).toISOString().split("T")[0];return t>=Y.toISOString().split("T")[0]&&t<=H.toISOString().split("T")[0]})):[],r=o.filter((e=>"free of charge"!==e.paymentType.toLowerCase())).reduce(((e,t)=>{const{paymentType:o,paymentAmount:r}=t;return e[o]=(e[o]||0)+parseFloat(r),e}),{}),a=Object.values(r).reduce(((e,t)=>e+t),0),l=H.toISOString().split("T")[0],n=o.filter((e=>{var t;return(null===(t=e.registeredOn)||void 0===t?void 0:t.split("T")[0])===l&&"free of charge"!==e.paymentType.toLowerCase()})),i=_.toISOString().split("T")[0],d=o.filter((e=>{var t;return(null===(t=e.registeredOn)||void 0===t?void 0:t.split("T")[0])===i&&"free of charge"!==e.paymentType.toLowerCase()})),s=n.reduce(((e,t)=>e+parseFloat(t.paymentAmount)),0),c=d.reduce(((e,t)=>e+parseFloat(t.paymentAmount)),0),u=c>0?Math.abs((s-c)/c).toFixed(2):"0",p=c>0?"".concat(Math.round((s-c)/c*100),"%"):"0%",m=n.length,f=d.length,h=f>0?Math.abs((m-f)/f).toFixed(2):"0",v=f>0?"".concat(Math.round((m-f)/f*100),"%"):"0%",x=new Set(n.map((e=>e.patientCardNumber))).size,A=new Set(d.map((e=>e.patientCardNumber))).size,b=A>0?Math.abs((x-A)/A).toFixed(2):"0",y=A>0?"".concat(Math.round((x-A)/A*100),"%"):"0%";I(a),M(s),D(u),T(p),W({count:m,trend:h,trendPercent:v}),q({count:x,trend:b,trendPercent:y})}catch(t){console.error("Error fetching transaction data:",t)}})()}),[null===O||void 0===O?void 0:O.name]),(0,j.jsxs)("div",{ref:b,style:{padding:"20px"},children:[(0,j.jsxs)("div",{style:{display:"none"},children:[(0,j.jsx)("h1",{children:"Hospital Revenue Dashboard"}),(0,j.jsxs)("p",{children:["Generated on: ",(new Date).toLocaleString()]}),(0,j.jsxs)("p",{children:["Generated by: ",null===O||void 0===O?void 0:O.name]})]}),(0,j.jsxs)(n.A,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4,children:[(0,j.jsx)(v.Y9,{title:"DASHBOARD",subtitle:"Welcome to your dashboard"}),(0,j.jsx)(n.A,{children:(0,j.jsxs)(i.A,{onClick:async()=>{x(!0);const e=new A.Ay({orientation:"landscape",unit:"mm",format:"a4"}),o=b.current,r={scale:2,useCORS:!0,logging:!0,backgroundColor:t.primary[400]};try{const a=await y()(o,r),l=a.toDataURL("image/png"),n=e.internal.pageSize.getWidth(),i=e.internal.pageSize.getHeight(),d=n-20,s=a.height*d/a.width;e.setFontSize(20),e.setTextColor(t.blueAccent[500]),e.text("Hospital Revenue Dashboard",n/2,15,{align:"center"}),e.setFontSize(12),e.setTextColor(100),e.text("Generated on: ".concat((new Date).toLocaleString()),n/2,22,{align:"center"}),e.text("Generated by: ".concat(null===O||void 0===O?void 0:O.name),n/2,28,{align:"center"}),e.addImage(l,"PNG",10,35,d,s),e.setFontSize(10),e.setTextColor(150),e.text("\xa9 2023 Hospital Payment System",n/2,i-10,{align:"center"}),e.save("Dashboard_Report_".concat((new Date).toISOString().slice(0,10),".pdf"))}catch(a){console.error("Error generating PDF:",a)}finally{x(!1)}},sx:{backgroundColor:t.blueAccent[700],color:t.grey[100],fontSize:"14px",fontWeight:"bold",padding:"10px 20px","&:hover":{backgroundColor:t.blueAccent[900]}},disabled:o,children:[(0,j.jsx)(u.A,{sx:{mr:"10px"}}),o?"Generating PDF...":"Download Reports"]})})]}),(0,j.jsxs)(n.A,{display:"grid",gridTemplateColumns:"repeat(12, 1fr)",gridAutoRows:"140px",gap:"20px",children:[[{title:E.count||0,subtitle:"No of Transactions Today",icon:(0,j.jsx)(p.A,{sx:{color:t.greenAccent[600],fontSize:"26px"}}),progress:E.trend||"0",increase:E.trendPercent||"0%"},{title:k(S),subtitle:"Total Revenue Today",icon:(0,j.jsx)(m.A,{sx:{color:t.greenAccent[600],fontSize:"26px"}}),progress:P,increase:R},{title:L.count||0,subtitle:"Patient served Today",icon:(0,j.jsx)(f.A,{sx:{color:t.greenAccent[600],fontSize:"26px"}}),progress:L.trend||"0",increase:L.trendPercent||"0%"},{title:k(w),subtitle:"Uncollected Cash from Cashier",icon:(0,j.jsx)(h.A,{sx:{color:t.greenAccent[600],fontSize:"26px"}})}].map(((e,o)=>(0,j.jsx)(n.A,{gridColumn:"span 3",backgroundColor:t.primary[400],display:"flex",alignItems:"center",justifyContent:"center",children:(0,j.jsx)(v.__,{title:e.title,subtitle:e.subtitle,progress:e.progress,increase:e.increase,icon:e.icon})},o))),(0,j.jsxs)(n.A,{gridColumn:"span 8",gridRow:"span 2",backgroundColor:t.primary[400],children:[(0,j.jsxs)(n.A,{mt:"25px",p:"0 30px",display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,j.jsxs)(n.A,{children:[(0,j.jsx)(d.A,{variant:"h5",fontWeight:"600",color:t.grey[100],children:"Revenue Generated from Last Week"}),(0,j.jsx)(d.A,{variant:"h3",fontWeight:"bold",color:t.greenAccent[500],children:k(C)})]}),(0,j.jsx)(n.A,{children:(0,j.jsx)(s.A,{children:(0,j.jsx)(u.A,{sx:{fontSize:"26px",color:t.greenAccent[500]}})})})]}),(0,j.jsx)(n.A,{height:"250px",m:"-20px 0 0 0",children:(0,j.jsx)(v.bl,{isDashboard:!0})})]}),(0,j.jsxs)(n.A,{gridColumn:"span 4",gridRow:"span 2",backgroundColor:t.primary[400],overflow:"auto",children:[(0,j.jsx)(n.A,{display:"flex",justifyContent:"space-between",alignItems:"center",p:"15px",children:(0,j.jsx)(d.A,{color:t.grey[100],variant:"h5",fontWeight:"600",children:"Uncollected Cash by Cashier"})}),(0,j.jsxs)(n.A,{display:"flex",justifyContent:"space-between",p:"10px 15px",borderBottom:"2px solid ".concat(t.primary[500]),children:[(0,j.jsx)(d.A,{color:t.greenAccent[500],fontWeight:"600",width:"33%",children:"Cashier Name"}),(0,j.jsx)(d.A,{color:t.greenAccent[500],fontWeight:"600",width:"33%",children:"Last Collection Date"}),(0,j.jsx)(d.A,{color:t.greenAccent[500],fontWeight:"600",width:"33%",children:"Total Amount"})]}),z.map(((e,o)=>(0,j.jsxs)(n.A,{display:"flex",justifyContent:"space-between",alignItems:"center",p:"10px 15px",sx:{"&:hover":{backgroundColor:t.greenAccent[900]}},children:[(0,j.jsx)(d.A,{color:t.grey[100],width:"33%",children:e.cashier}),(0,j.jsx)(d.A,{color:t.grey[100],width:"33%",children:e.date?new Date(e.date).toLocaleDateString():"N/A"}),(0,j.jsx)(d.A,{color:t.greenAccent[500],fontWeight:"600",width:"33%",children:k(e.amount)})]},"".concat(e.cashier,"-").concat(o))))]}),(0,j.jsxs)(n.A,{gridColumn:"span 3",gridRow:"span 2",backgroundColor:t.primary[400],p:"30px",overflow:"auto",children:[(0,j.jsx)(d.A,{variant:"h5",fontWeight:"600",children:"Uncollected vs Collected Over Last Month"}),(0,j.jsxs)(n.A,{display:"flex",flexDirection:"column",alignItems:"center",mt:"25px",children:[(0,j.jsx)(v.a3,{progress:w+F>0?F/(w+F):0,size:"125",showLegend:!0}),(0,j.jsxs)(d.A,{variant:"h5",color:t.greenAccent[500],sx:{mt:"15px"},children:[k(w)," of"," ",k(w+F)," is Uncollected from Cashier"]})]})]}),(0,j.jsxs)(n.A,{gridColumn:"span 5",gridRow:"span 2",backgroundColor:t.primary[400],children:[(0,j.jsx)(d.A,{variant:"h5",fontWeight:"600",sx:{padding:"30px 30px 0 30px"},color:t.grey[100],children:"Amount by Payment Method over last week"}),(0,j.jsx)(n.A,{height:"250px",mt:"-20px",children:(0,j.jsx)(v.Es,{isDashboard:!0})})]}),(0,j.jsxs)(n.A,{gridColumn:"span 4",gridRow:"span 2",backgroundColor:t.primary[400],padding:"30px",children:[(0,j.jsx)(d.A,{variant:"h5",fontWeight:"600",color:t.grey[100],children:"Geography Based Traffic"}),(0,j.jsx)(n.A,{height:"200px",mt:"10px",children:(0,j.jsx)(v.j2,{isDashboard:!0})})]})]}),(0,j.jsx)("div",{style:{display:"none"},children:(0,j.jsxs)("p",{style:{textAlign:"center",marginTop:"20px",color:"#666"},children:["\xa9 ",(new Date).getFullYear()," Hospital Payment System - Confidential Report"]})})]})}},69413:(e,t,o)=>{o.d(t,{A:()=>S});var r=o(26240),a=o(46946),l=o(12900),n=o(71716),i=o(69392),d=o(60587),s=o(27e3),c=o(94814),u=o(2050),p=o(39336),m=o(72882),f=o(65043),h=o(73216),v=o(35475),x=o(63777),g=o(74727),A=o(76109),b=o(67808),y=o(65523),j=o(66360),C=o(1702),k=o(45465),O=o(83074),I=o(78218),w=o(70579);const N=(0,O.N8)(),S=()=>{var e,t;const o=(0,r.A)(),O=(0,x.LU)(o.palette.mode),S=(0,f.useContext)(x.Ig),[M,P]=(0,f.useState)(null),D=Boolean(M),R=(0,h.Ew)("root"),T=(0,h.Zp)(),E=()=>P(null);return R?(0,w.jsxs)(a.A,{display:"flex",justifyContent:"space-between",p:2,children:[(0,w.jsxs)(a.A,{display:"flex",backgroundColor:O.primary[400],borderRadius:"3px",sx:{height:{xs:35,sm:40,md:42},width:{xs:120,sm:160,md:222}},children:[(0,w.jsx)(l.Ay,{sx:{ml:2,flex:1},placeholder:"Search"}),(0,w.jsx)(n.A,{type:"button",sx:{p:1},children:(0,w.jsx)(j.A,{})})]}),(0,w.jsxs)(a.A,{display:"flex",children:[(0,w.jsx)(n.A,{onClick:S.toggleColorMode,children:"dark"===o.palette.mode?(0,w.jsx)(A.A,{}):(0,w.jsx)(g.A,{})}),(0,w.jsx)(n.A,{children:(0,w.jsx)(b.A,{})}),(0,w.jsx)(n.A,{children:(0,w.jsx)(y.A,{})}),(0,w.jsx)(a.A,{sx:{display:"flex",alignItems:"center",textAlign:"center"},children:(0,w.jsx)(i.A,{title:"Account settings",children:(0,w.jsx)(n.A,{onClick:e=>P(e.currentTarget),size:"small",sx:{ml:2},"aria-controls":D?"account-menu":void 0,"aria-haspopup":"true","aria-expanded":D?"true":void 0,children:(0,w.jsx)(d.A,{sx:{width:32,height:32},children:null===(e=N.name)||void 0===e||null===(t=e.charAt(0))||void 0===t?void 0:t.toUpperCase()})})})}),(0,w.jsxs)(s.A,{anchorEl:M,id:"account-menu",open:D,onClose:E,onClick:E,transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},sx:{"& .MuiAvatar-root":{width:32,height:32,ml:-.5,mr:1},"&::before":{content:'""',display:"block",position:"absolute",top:0,right:14,width:10,height:10,bgcolor:"background.paper",transform:"translateY(-50%) rotate(45deg)",zIndex:0}},children:[(0,w.jsxs)(c.A,{onClick:()=>T("/profile"),children:[(0,w.jsx)(u.A,{children:(0,w.jsx)(d.A,{})}),"Profile"]}),(0,w.jsxs)(c.A,{onClick:()=>(()=>{try{const e=document.createElement("a");e.href="".concat(window.location.origin,"/assets/files/Register Collectors.xlsx"),e.download="Register Collectors.xlsx",document.body.appendChild(e),e.click(),document.body.removeChild(e)}catch(e){console.error("Download failed:",e)}})(),children:[(0,w.jsx)(u.A,{children:(0,w.jsx)(I.A,{})}),"Get Register Collectors File"]}),(0,w.jsxs)(c.A,{onClick:()=>(()=>{try{const e=document.createElement("a");e.href="".concat(window.location.origin,"/assets/files/Register Credit Users.xlsx"),e.download="Register Credit Users.xlsx",document.body.appendChild(e),e.click(),document.body.removeChild(e)}catch(e){console.error("Download failed:",e)}})(),children:[(0,w.jsx)(u.A,{children:(0,w.jsx)(I.A,{})}),"Get Register Credit User File"]}),(0,w.jsxs)(c.A,{onClick:()=>(()=>{try{const e=document.createElement("a");e.href="".concat(window.location.origin,"/assets/files/Services.xlsx"),e.download="Services.xlsx",document.body.appendChild(e),e.click(),document.body.removeChild(e)}catch(e){console.error("Download failed:",e)}})(),children:[(0,w.jsx)(u.A,{children:(0,w.jsx)(I.A,{})}),"Service Upload"]}),(0,w.jsxs)(c.A,{onClick:()=>(()=>{try{const e="".concat(window.location.origin,"/assets/files/Moh Documentation.pdf");window.open(e,"_blank")}catch(e){console.error("Download failed:",e)}})(),children:[(0,w.jsx)(u.A,{children:(0,w.jsx)(k.A,{})}),"Help"]}),(0,w.jsx)(p.A,{}),(0,w.jsx)(v.lV,{action:"/logout",method:"post",children:(0,w.jsxs)(c.A,{children:[(0,w.jsx)(u.A,{children:(0,w.jsx)(C.A,{fontSize:"small"})}),(0,w.jsx)(m.A,{variant:"contained",type:"submit",color:"secondary",children:"Logout"})]})})]})]})]}):(0,w.jsxs)(a.A,{display:"flex",children:[(0,w.jsx)(n.A,{onClick:S.toggleColorMode,children:"dark"===o.palette.mode?(0,w.jsx)(A.A,{}):(0,w.jsx)(g.A,{})}),(0,w.jsx)(n.A,{children:(0,w.jsx)(b.A,{})})]})}},71647:(e,t,o)=>{o.r(t),o.d(t,{default:()=>R});var r=o(89379),a=o(80045),l=o(65043),n=o(26240),i=o(65204),d=o(94496),s=o(42788),c=o(94814),u=o(8591),p=o(71716),m=o(97334),f=o(46946),h=o(72882),v=o(896),x=o(69570),g=o(29622),A=o(71062),b=o(80216),y=o(26353),j=o(28884),C=o(29435),k=o(58293),O=o(83560),I=o(77265),w=o(57488),N=(o(92342),o(54007)),S=o(70579);const M=["id"],P={type:"",descriptions:[]},D={type:"",descriptions:[""]},R=()=>{const e=(0,n.A)(),[t,o]=(0,l.useState)([]),[R,T]=(0,l.useState)([]),[E,W]=(0,l.useState)(null),[L,q]=(0,l.useState)(P),[z,B]=(0,l.useState)(D),[F,U]=(0,l.useState)(!1),[H,G]=(0,l.useState)({status:!1,on:""}),[Y,_]=(0,l.useState)(!1);(0,l.useEffect)((()=>{(async()=>{try{var e;const n=await I.A.get("/Lookup/payment-type-description");var t,l;null!==n&&void 0!==n&&null!==(e=n.data)&&void 0!==e&&e.data&&o(null===(t=n.data.data)||void 0===t||null===(l=t.filter((e=>"all"!==(0,N.f)(null===e||void 0===e?void 0:e.type))))||void 0===l?void 0:l.map(((e,t)=>{let{id:o}=e,l=(0,a.A)(e,M);return(0,r.A)({id:t+1,mainId:o},l)})))}catch(n){console.error("Fetch error:",n),w.oR.error("Failed to load payment types")}})()}),[F]),(0,l.useEffect)((()=>{(async()=>{try{const o=await I.A.get("/Lookup/payment-type");var e,t;if(200===(null===o||void 0===o?void 0:o.status))T(null===o||void 0===o||null===(e=o.data)||void 0===e||null===(t=e.map((e=>null===e||void 0===e?void 0:e.type)))||void 0===t?void 0:t.filter((e=>"all"!==(0,N.f)(e))))}catch(o){console.error("This is fecth Payment Type error: ",o)}})()}),[]);const Z=(e,t)=>{const o=Array.isArray(null===z||void 0===z?void 0:z.descriptions)?[...z.descriptions]:[];return!/^[A-Za-z0-9._\-\s]{2,}$/.test(t)&&(null===t||void 0===t?void 0:t.length)>0?(o[e]="Use only letters, numbers, space, dot (.), dash (-), or underscore (_) \u2014 at least 2 characters.",B((e=>(0,r.A)((0,r.A)({},e),{},{descriptions:o}))),!1):(o[e]="",B((e=>(0,r.A)((0,r.A)({},e),{},{descriptions:o}))),!0)},$=()=>{W(null),q(P),B(D)};return(0,S.jsxs)(i.A,{elevation:3,sx:{p:4,margin:2},children:[(0,S.jsx)(d.A,{variant:"h4",gutterBottom:!0,sx:{mb:4},children:"Payment Types Manager"}),(0,S.jsxs)(i.A,{elevation:2,sx:{p:3,mt:4,background:"dark"===e.palette.mode&&"#1f2a408a"},children:[(0,S.jsx)(d.A,{variant:"h6",gutterBottom:!0,children:E?"Edit Payment Type":"Create New Payment Type"}),(0,S.jsx)(s.A,{fullWidth:!0,select:!0,label:"Payment Type",value:null===L||void 0===L?void 0:L.type,onChange:e=>q((t=>(0,r.A)((0,r.A)({},t),{},{type:e.target.value}))),sx:{mb:3},error:!(null===z||void 0===z||!z.type),helperText:null===z||void 0===z?void 0:z.type,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},color:"dark"===e.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===e.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===e.palette.mode?"#fff":"#000"}}},children:null===R||void 0===R?void 0:R.map(((e,t)=>(0,S.jsx)(c.A,{value:e,children:e},t)))}),L.descriptions.map(((t,o)=>(0,S.jsxs)(u.Ay,{container:!0,spacing:1,alignItems:"center",sx:{mb:2},children:[(0,S.jsx)(u.Ay,{item:!0,xs:10,children:(0,S.jsx)(s.A,{fullWidth:!0,label:"Description ".concat(o+1),value:(null===t||void 0===t?void 0:t.description)||"",onChange:e=>((e,t)=>{const o=[...L.descriptions];q((a=>(0,r.A)((0,r.A)({},a),{},{descriptions:null===o||void 0===o?void 0:o.map(((o,r)=>r===e?{id:o.id,description:t}:o))}))),Z(e,t)})(o,e.target.value),error:!(null===z||void 0===z||!z.descriptions[o]),helperText:null===z||void 0===z?void 0:z.descriptions[o],InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===e.palette.mode?"#fff":"#000"},color:"dark"===e.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===e.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===e.palette.mode?"#fff":"#000"}}}})}),(0,S.jsx)(u.Ay,{item:!0,xs:2,children:(0,S.jsx)(p.A,{onClick:()=>(async e=>{try{var t;if(null!==L&&void 0!==L&&null!==(t=L.descriptions)&&void 0!==t&&t.some((e=>null===e.description||void 0===e.description||""===e.description.toString().trim())))return w.oR.error("Please fill required fields."),void B((0,r.A)((0,r.A)({},z),{},{descriptions:"Please fill this field."}));if(null!==E){var o,a;G({status:!1,on:e});const t=null===L||void 0===L||null===(o=L.descriptions)||void 0===o?void 0:o.filter(((t,o)=>o===e)),i=await I.A.delete("/Lookup/payment-type-description",{headers:{"Content-Type":"application/json"},data:{id:null===(a=t[0])||void 0===a?void 0:a.id}});if(200===(null===i||void 0===i?void 0:i.status)){var l,n;if(1===L.descriptions.length)return w.oR.success((null===i||void 0===i||null===(n=i.data)||void 0===n?void 0:n.msg)||"Removed Successfully."),q(P),U((e=>!e)),void W(null);w.oR.success((null===i||void 0===i||null===(l=i.data)||void 0===l?void 0:l.msg)||"Removed Successfully."),q((t=>(0,r.A)((0,r.A)({},t),{},{descriptions:t.descriptions.filter(((t,o)=>o!==e))}))),U((e=>!e))}}else q((t=>(0,r.A)((0,r.A)({},t),{},{descriptions:t.descriptions.filter(((t,o)=>o!==e))})))}catch(s){var i,d;console.error("This is handle Remove Description error: ",s),w.oR.error((null===s||void 0===s||null===(i=s.response)||void 0===i||null===(d=i.data)||void 0===d?void 0:d.msg)||"Internal server error.")}finally{G({status:!1,on:e})}})(o),children:(null===H||void 0===H?void 0:H.on)===o?(0,S.jsx)(m.A,{size:24,color:"inherit"}):(0,S.jsx)(j.A,{color:"error"})})})]},o))),(0,S.jsxs)(f.A,{display:"flex",justifyContent:"space-between",mt:2,children:[(0,S.jsx)(h.A,{startIcon:(0,S.jsx)(C.A,{}),onClick:()=>{q((e=>(0,r.A)((0,r.A)({},e),{},{descriptions:[...e.descriptions,{id:null,description:""}]})))},variant:"outlined",color:"inherit",disabled:null!==E,children:"Add Description"}),(0,S.jsxs)(f.A,{children:[(0,S.jsx)(h.A,{variant:"outlined",color:"error",onClick:$,sx:{mr:2},children:"Cancel"}),(0,S.jsx)(h.A,{variant:"contained",color:"light"===e.palette.mode?"primary":"secondary",onClick:async()=>{try{var e,t,o,a,l,n;_(!0);const u={type:null===L||void 0===L?void 0:L.type,discription:E?null===L||void 0===L||null===(e=L.descriptions)||void 0===e?void 0:e.filter((e=>{var t;return""!==(null===e||void 0===e||null===(t=e.description)||void 0===t?void 0:t.trim())})):null===L||void 0===L||null===(t=L.descriptions)||void 0===t||null===(o=t.filter((e=>{var t;return""!==(null===e||void 0===e||null===(t=e.description)||void 0===t?void 0:t.trim())})))||void 0===o?void 0:o.map((e=>null===e||void 0===e?void 0:e.description))};if((null===L||void 0===L||null===(a=L.type)||void 0===a?void 0:a.length)<=0||null!==L&&void 0!==L&&null!==(l=L.descriptions)&&void 0!==l&&l.some((e=>null===e.description||void 0===e.description||""===e.description.toString().trim()))){var i,d,s;if(w.oR.error("Pleas fill required fields."),(null===L||void 0===L||null===(i=L.type)||void 0===i?void 0:i.length)<=0&&B((0,r.A)((0,r.A)({},z),{},{type:"Please fill this field."})),null!==L&&void 0!==L&&null!==(d=L.descriptions)&&void 0!==d&&d.some((e=>null===e.description||void 0===e.description||""===e.description.toString().trim())))B((0,r.A)((0,r.A)({},z),{},{descriptions:null===L||void 0===L||null===(s=L.descriptions)||void 0===s?void 0:s.map((()=>"Please fill this field."))}));return}if(null!==z&&void 0!==z&&z.type||null!==z&&void 0!==z&&null!==(n=z.descriptions)&&void 0!==n&&n.some((e=>(null===e||void 0===e?void 0:e.length)>0)))return void w.oR.error("Please fix the error first.");if(E){const e=await Promise.all(null===L||void 0===L?void 0:L.descriptions.map((e=>I.A.put("/Lookup/payment-type-description/",{id:null===e||void 0===e?void 0:e.id,discription:null===e||void 0===e?void 0:e.description}))));let t=!1;null===e||void 0===e||e.forEach(((e,o)=>{var r;200===(null===e||void 0===e?void 0:e.status)&&(t=!0,w.oR.success((null===e||void 0===e||null===(r=e.data)||void 0===r?void 0:r.msg)||"Description ".concat(o+1," updated.")))})),t&&(U((e=>!e)),$(),W(null))}else{const e=await I.A.post("/Lookup/payment-type-description",u);var c;if(201===(null===e||void 0===e?void 0:e.status))U((e=>!e)),$(),w.oR.success((null===e||void 0===e||null===(c=e.data)||void 0===c?void 0:c.msg)||(E?"Updated successfully":"Created successfully"))}}catch(m){var u,p;console.error("Submit error:",m),w.oR.error((null===m||void 0===m||null===(u=m.response)||void 0===u||null===(p=u.data)||void 0===p?void 0:p.msg)||"Operation failed")}finally{_(!1)}},disabled:!L.type||L.descriptions.every((e=>{var t;return""===(null===e||void 0===e||null===(t=e.description)||void 0===t?void 0:t.trim())||null===(null===e||void 0===e?void 0:e.description)})),children:Y?(0,S.jsx)(m.A,{size:24,color:"inherit"}):E?"Update":"Create"})]})]})]}),(0,S.jsx)("div",{style:{marginTop:"40px"},children:t.map((t=>(0,S.jsxs)(v.A,{sx:{background:"dark"===e.palette.mode?"linear-gradient(45deg, #1f2a40 30%, #2c3a58 90%)":"linear-gradient(45deg, #f8f9fa 30%, #ffffff 90%)",borderRadius:"12px !important",overflow:"hidden",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:e.shadows[2],"&:hover":{transform:"translateY(-2px)",boxShadow:e.shadows[6]},"&:before":{display:"none"},"&.Mui-expanded":{margin:"16px 0",transform:"scale(1.005)"},mb:2},children:[(0,S.jsx)(x.A,{expandIcon:(0,S.jsx)(k.A,{sx:{color:e.palette.text.secondary}}),sx:{transition:"background 0.2s ease","&:hover":{background:"dark"===e.palette.mode?"rgba(255,255,255,0.03)":"rgba(0,0,0,0.03)"},"& .MuiAccordionSummary-content":{alignItems:"center",py:2}},children:(0,S.jsxs)(u.Ay,{container:!0,alignItems:"center",children:[(0,S.jsx)(u.Ay,{item:!0,xs:10,children:(0,S.jsx)(d.A,{variant:"h6",sx:{fontWeight:600,letterSpacing:"0.5px",position:"relative","&:after":{content:'""',position:"absolute",bottom:-8,left:0,width:"40px",height:"3px",background:e.palette.primary.main,transition:"all 0.3s ease",opacity:0}},children:t.type})}),(0,S.jsx)(u.Ay,{item:!0,xs:2,textAlign:"right",children:(0,S.jsx)(p.A,{onClick:e=>{e.stopPropagation(),(e=>{var t;W(e.mainId),q({type:e.type,descriptions:(null===e||void 0===e||null===(t=e.description)||void 0===t?void 0:t.length)>0||null!==(null===e||void 0===e?void 0:e.description)?null===e||void 0===e?void 0:e.description:[{id:null,description:""}]})})(t)},sx:{transform:"scale(0.9)",transition:"all 0.2s ease","&:hover":{transform:"scale(1.1)",background:"dark"===e.palette.mode?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.1)"}},children:(0,S.jsx)(O.A,{fontSize:"small"})})})]})}),(0,S.jsx)(g.A,{sx:{pt:0},children:(0,S.jsx)(A.A,{sx:{background:"dark"===e.palette.mode?"rgba(0,0,0,0.15)":"rgba(255,255,255,0.5)",borderRadius:"8px",py:0},children:t.description.map(((t,o)=>(0,S.jsx)(b.Ay,{sx:{transition:"all 0.2s ease","&:hover":{transform:"translateX(8px)",background:"dark"===e.palette.mode?"rgba(255,255,255,0.02)":"rgba(0,0,0,0.02)"},"&:not(:last-child)":{borderBottom:"1px solid ".concat(e.palette.divider)}},children:(0,S.jsx)(y.A,{primary:t.description||"No description",primaryTypographyProps:{sx:{position:"relative","&:before":{content:'"\u2022"',color:"light"===e.palette.mode?e.palette.primary.main:e.palette.secondary.main,mr:1.5,fontSize:"1.2rem"}}}})},t.id||o)))})})]},t.id)))}),(0,S.jsx)(w.N9,{})]})}},73021:(e,t,o)=>{o.r(t),o.d(t,{default:()=>j});var r=o(89379),a=(o(65043),o(46946)),l=o(8591),n=o(94496),i=o(65204),d=o(71861),s=o(42788),c=o(72882),u=o(97334),p=o(24858),m=o(47097),f=o(69413);const h=o.p+"static/media/bg16.e9db8bbce0aea6c3486a.jpg";var v=o(83074),x=o(26240);const g=o.p+"static/media/tsedey.797ea0fbaf2e605c37d8.png",A=o.p+"static/media/amh.d2f83c355f651d010ab0.png",b=o.p+"static/media/moh.6bbffa36f5c52f9b4dcf.png";var y=o(70579);const j=()=>{var e,t,o;const j=(0,x.A)(),C=(0,m.n)({mutationFn:v.iD,onSuccess:e=>{localStorage.setItem(".otc",null===e||void 0===e?void 0:e.token),window.location.href="/"},onError:e=>{console.error("Login Error",e)}}),{register:k,handleSubmit:O,formState:{errors:I}}=(0,p.mN)();return(0,y.jsxs)(a.A,{sx:{minHeight:"100vh",display:"flex",flexDirection:"column",backgroundColor:"dark"===j.palette.mode?"#1a1a1a":"#478594"},children:[(0,y.jsx)(f.A,{}),(0,y.jsxs)(l.Ay,{container:!0,sx:{flexGrow:1,alignItems:"center",justifyContent:"center",height:"100%",px:2},children:[(0,y.jsx)(l.Ay,{item:!0,xs:12,md:6,sx:{display:"flex",justifyContent:"center",alignItems:"center",backgroundImage:"url(".concat(h,")"),backgroundSize:"cover",backgroundPosition:"center",height:{xs:250,md:"80vh"},ml:{md:3},borderRadius:"20px",boxShadow:3,position:"relative"},children:(0,y.jsxs)(a.A,{sx:{textAlign:"center",color:"white",backdropFilter:"blur(5px)",backgroundColor:"rgba(0, 0, 0, 0.5)",padding:4,borderRadius:2,maxWidth:"80%"},children:[(0,y.jsx)(n.A,{variant:"h4",fontWeight:"bold",mb:2,children:"Welcome Back!"}),(0,y.jsx)(n.A,{variant:"body1",children:"Sign in to access your account ."})]})}),(0,y.jsx)(l.Ay,{item:!0,xs:12,md:5,sx:{display:"flex",justifyContent:"center",alignItems:"center",height:{xs:"auto",md:"80%"},mt:{xs:4,md:0}},children:(0,y.jsxs)(i.A,{elevation:6,sx:{p:4,width:"100%",maxWidth:400,display:"flex",flexDirection:"column",alignItems:"center",borderRadius:"20px",boxShadow:3},children:[(0,y.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,y.jsx)("img",{src:b,width:"110px",alt:"Company Logo",style:{marginRight:"0px",marginTop:"25px"}}),(0,y.jsx)("img",{src:g,width:"105px",alt:"Company Logo"}),(0,y.jsx)("img",{src:A,width:"100px",alt:"Company Logo",style:{marginRight:"0px",marginTop:"5px"}})]}),(0,y.jsx)(n.A,{variant:"h5",sx:{mt:2,fontWeight:"bold"},children:"Sign in to Your Account"}),C.isError&&(0,y.jsx)(d.A,{severity:"error",sx:{width:"100%",mt:2},children:401===C.error.status?"Invalid username or password!":null===(e=C.error)||void 0===e?void 0:e.message}),(0,y.jsxs)(a.A,{component:"form",onSubmit:O((e=>{const t={username:e.username,password:e.password};C.mutate(t)})),sx:{mt:3,width:"100%"},children:[(0,y.jsx)(s.A,(0,r.A)((0,r.A)({fullWidth:!0,label:"Username",autoFocus:!0},k("username",{required:"Username is required",minLength:{value:4,message:"Username must be at least 4 characters"}})),{},{error:Boolean(I.username),helperText:null===(t=I.username)||void 0===t?void 0:t.message,sx:{mb:2},InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===j.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===j.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===j.palette.mode?"#fff":"#000"},color:"dark"===j.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===j.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===j.palette.mode?"#fff":"#000"}}}})),(0,y.jsx)(s.A,(0,r.A)((0,r.A)({fullWidth:!0,label:"Password",type:"password"},k("password",{required:"Password is required",minLength:{value:4,message:"Password must be at least 4 characters"}})),{},{error:Boolean(I.password),helperText:null===(o=I.password)||void 0===o?void 0:o.message,sx:{mb:2},InputProps:{min:0,step:"any",sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===j.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===j.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===j.palette.mode?"#fff":"#000"},color:"dark"===j.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===j.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===j.palette.mode?"#fff":"#000"}}}})),(0,y.jsx)(c.A,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2,py:1.5,backgroundColor:"#478594",color:"white",fontWeight:"bold","&:hover":{backgroundColor:"#1f5459"}},disabled:C.isPending,children:C.isPending?(0,y.jsx)(u.A,{size:24,color:"inherit"}):"Sign In"})]})]})})]})]})}},83786:(e,t,o)=>{o.r(t),o.d(t,{default:()=>k,isEmpty:()=>C});var r=o(89379),a=o(65043),l=o(26240),n=o(71716),i=o(65204),d=o(94496),s=o(42788),c=o(94814),u=o(46946),p=o(72882),m=o(77265),f=o(54007),h=o(57488),v=(o(92342),o(61976)),x=o(97334),g=o(26533),A=o(13467),b=o(16005),y=o(70579);const j={type:"",amount:"",time:""},C=e=>null===e||void 0===e||"string"===typeof e&&""===e.trim()||"number"===typeof e&&isNaN(e),k=()=>{const[e,t]=(0,a.useState)(j),[o,k]=(0,a.useState)(j),[O,I]=(0,a.useState)([]),[w,N]=(0,a.useState)([]),[S,M]=(0,a.useState)([]),[P,D]=(0,a.useState)(!0),[R,T]=(0,a.useState)(!1),[E,W]=(0,a.useState)(!1),[L,q]=(0,a.useState)(!1),[z,B]=(0,a.useState)(!1),[F,U]=(0,a.useState)({}),[H,G]=(0,a.useState)(!1),Y=(0,l.A)();(0,a.useEffect)((()=>{w.length>0&&(async()=>{try{var e;const t=await m.A.get("/Setting/paymentType-limit"),o=((null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.data)||[]).map(((e,t)=>{const o=w.find((t=>t.id===e.type));return{id:t+1,mainId:e.id,type:(null===o||void 0===o?void 0:o.type)||"Type ID: ".concat(e.type),amount:e.amount,time:e.time,createdBy:e.createdBy||"-"}}));M(o)}catch(t){console.error("Error loading limits:",t)}finally{D(!1)}})()}),[w,L]);(0,a.useEffect)((()=>{(async e=>{try{const r=await m.A.get(e),a=await m.A.get("/Lookup/payment-type-description");if(200===(null===r||void 0===r?void 0:r.status)||201===(null===r||void 0===r?void 0:r.status)){var t;const e=null===r||void 0===r||null===(t=r.data)||void 0===t?void 0:t.map((e=>e.type)).filter((e=>{var t;return!(null!==(t=(0,f.f)(e))&&void 0!==t&&t.includes("all"))}));I(e)}var o;200===a.status&&N(null===a||void 0===a||null===(o=a.data)||void 0===o?void 0:o.data)}catch(r){console.error(r.message)}})("/Lookup/payment-type")}),[]);const _=e=>{try{const{name:o,value:a}=e.target,l=(0,f.f)(o);let n=a;if(["amount","time"].includes(l)){const e=Math.abs(Number(a));n="amount"===l?parseFloat(e):parseInt(e)}t((e=>(0,r.A)((0,r.A)({},e),{},{[o]:n}))),k((e=>(0,r.A)((0,r.A)({},e),{},{[o]:""})))}catch(o){console.error("This is handle change error: ",o)}},Z=async e=>{try{if("Delete"===(null===e||void 0===e?void 0:e.message)){G(!0);const e=await m.A.delete("/Setting/paymentType-limit",{headers:{"Content-Type":"application/json"},data:(null===F||void 0===F?void 0:F.mainId)||0});var t;if(200===(null===e||void 0===e?void 0:e.status))return h.oR.success((null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.msg)||"Deleted Successfully."),U({}),B(!1),void q((e=>!e))}U(e),B(!0)}catch(a){var o,r;console.error("This is handle delete error: ",a),h.oR.error((null===a||void 0===a||null===(o=a.response)||void 0===o||null===(r=o.data)||void 0===r?void 0:r.msg)||"Internal server error.")}finally{G(!1)}},$=[{field:"id",headerName:"#",width:60},{field:"type",headerName:"Payment Type",flex:1},{field:"amount",headerName:"Amount",flex:1},{field:"time",headerName:"Time Limit",flex:1},{field:"createdBy",headerName:"Created By",flex:1},{field:"action",headerName:"Action",flex:1,renderCell:e=>(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(n.A,{onClick:()=>(async e=>{try{T(!0),t(null===e||void 0===e?void 0:e.row)}catch(o){console.error("This is handle edit error: ",o)}})(e),"aria-label":"edit",className:"text-info",children:(0,y.jsx)(g.A,{})}),(0,y.jsx)(n.A,{onClick:()=>Z(e.row),color:"danger","aria-label":"delete",className:"text-danger",children:(0,y.jsx)(A.A,{})})]})}];return(0,y.jsxs)(i.A,{elevation:3,sx:{p:4,mx:"auto",mt:5,marginInline:"15px"},children:[(0,y.jsx)(d.A,{variant:"h6",gutterBottom:!0,children:"Set Payment Type Limit"}),(0,y.jsx)(s.A,{select:!0,fullWidth:!0,label:"Payment Type",name:"type",value:null===e||void 0===e?void 0:e.type,onChange:_,sx:{mb:3},required:!0,error:!(null===o||void 0===o||!o.type),helperText:null===o||void 0===o?void 0:o.type,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===Y.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===Y.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===Y.palette.mode?"#fff":"#000"},color:"dark"===Y.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===Y.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===Y.palette.mode?"#fff":"#000"}}},children:O.map((e=>(0,y.jsx)(c.A,{value:e,children:e},e)))}),(0,y.jsx)(s.A,{fullWidth:!0,label:"Amount",type:"number",name:"amount",value:null===e||void 0===e?void 0:e.amount,onWheel:e=>e.target.blur(),onChange:_,sx:{mb:3},required:!0,error:!(null===o||void 0===o||!o.amount),helperText:null===o||void 0===o?void 0:o.amount,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===Y.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===Y.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===Y.palette.mode?"#fff":"#000"},color:"dark"===Y.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===Y.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===Y.palette.mode?"#fff":"#000"}}}}),(0,y.jsx)(s.A,{fullWidth:!0,label:"Time Limit (in Hours)",type:"number",name:"time",value:null===e||void 0===e?void 0:e.time,onChange:_,onWheel:e=>e.target.blur(),sx:{mb:3},required:!0,error:!(null===o||void 0===o||!o.time),helperText:null===o||void 0===o?void 0:o.time,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===Y.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===Y.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===Y.palette.mode?"#fff":"#000"},color:"dark"===Y.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===Y.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===Y.palette.mode?"#fff":"#000"}}}}),(0,y.jsxs)(u.A,{textAlign:"right",children:[(0,y.jsx)(p.A,{variant:"outlined",color:"error",onClick:()=>{t(j),T(!1)},children:"cancel"}),(0,y.jsx)(p.A,{variant:"contained",sx:{marginLeft:"10px"},color:"light"===Y.palette.mode?"primary":"secondary",onClick:()=>(async()=>{try{var o;if(Object.values(e||{}).some(C))return h.oR.info("Please fill all fields."),void Object.entries(e||{}).forEach((e=>{let[t,o]=e;C(o)&&k((e=>(0,r.A)((0,r.A)({},e),{},{[t]:"Please fill this field."})))}));W(!0);const n={id:R?null===e||void 0===e?void 0:e.mainId:null===(o=w.filter((t=>(0,f.f)(null===t||void 0===t?void 0:t.type)===(0,f.f)(null===e||void 0===e?void 0:e.type)))[0])||void 0===o?void 0:o.id,type:e.type,amount:parseFloat(e.amount),time:parseInt(e.time)};if(R){const e=await m.A.put("/Setting/paymentType-limit",n);var a;200===(null===e||void 0===e?void 0:e.status)&&(h.oR.success((null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.msg)||"Updated successfully."),t(j),T(!1),q((e=>!e)))}else{const e=await m.A.post("/Setting/paymentType-limit",n);var l;200!==(null===e||void 0===e?void 0:e.status)&&201!==(null===e||void 0===e?void 0:e.status)||(h.oR.success((null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.msg)||"Created successfully."),t(j),q((e=>!e)))}}catch(d){var n,i;console.error("Error saving:",d),h.oR.error((null===d||void 0===d||null===(n=d.response)||void 0===n||null===(i=n.data)||void 0===i?void 0:i.msg)||"Internal Server error.")}finally{W(!1)}})(),children:E?(0,y.jsx)(x.A,{size:24,color:"inherit"}):(0,y.jsx)(y.Fragment,{children:R?"Update":"Save"})})]}),(0,y.jsx)(h.N9,{}),(0,y.jsx)(d.A,{variant:"h6",mt:6,mb:2,children:"Existing Payment Type Limits"}),(0,y.jsx)(u.A,{sx:{height:400,width:"100%",mt:2},children:(0,y.jsx)(v.z,{rows:S,columns:$,loading:P,autoHeight:!0,sx:{minWidth:320}})}),(0,y.jsx)(b.A,{isOpen:z,onClose:()=>B(!1),userData:null===F||void 0===F?void 0:F.type,onConfirm:e=>Z(e),showUser:!1,loading:H})]})}},91525:(e,t,o)=>{o.r(t),o.d(t,{default:()=>M});var r=o(89379),a=o(65043),l=(o(50445),o(61976)),n=o(26240),i=o(71716),d=o(72882),s=o(95540),c=o(63471),u=o(1223),p=o(57566),m=o(57556),f=o(266),h=o(46946),v=o(94496),x=o(8591),g=o(42788),A=o(94814),b=o(74802),y=o(57488),j=o(70579);const C={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:{xs:"90%",sm:500,md:600},maxHeight:"90vh",overflowY:"auto",boxShadow:24,p:3,borderRadius:2},k=e=>{let{isOpen:t,onClose:o,onSubmit:l,userData:s,onEdit:c,resetUserData:u,role:p}=e;const[k,O]=(0,a.useState)({username:"",email:"",password:"",confirmpassword:"",phone:"",role:"",department:"",usertype:"",hospital:"DB Tena tabiya"}),[I,w]=(0,a.useState)(""),[N,S]=(0,a.useState)(""),[M,P]=(0,a.useState)(""),[D,R]=(0,a.useState)(""),T=(0,n.A)(),E=()=>{O({username:"",email:"",password:"",confirmpassword:"",phone:"",role:"",department:"",usertype:"",hospital:"DB Tena tabiya"}),R(""),S(""),w(""),u(),o()};(0,a.useEffect)((()=>{s&&O({username:(null===s||void 0===s?void 0:s.username)||"",email:(null===s||void 0===s?void 0:s.email)||"",password:"",confirmpassword:"",phone:(null===s||void 0===s?void 0:s.phoneNumber)||"",role:(null===s||void 0===s?void 0:s.role)||"",department:(null===s||void 0===s?void 0:s.departement)||"",usertype:(null===s||void 0===s?void 0:s.userType)||"",hospital:(null===s||void 0===s?void 0:s.hospital)||"DB Tena tabiya"})}),[s]);const W=e=>{O((0,r.A)((0,r.A)({},k),{},{[e.target.name]:e.target.value})),"email"===e.target.name&&q(e.target.value),"phone"===e.target.name&&z(e.target.value),"username"===e.target.name&&L(e.target.value),"confirmpassword"===e.target.name&&R("")},L=e=>{w(/^[A-Za-z][A-Za-z0-9]{3,}$/.test(e)?"":"Username must start with a letter and be at least 4 characters.")},q=e=>{S(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e)?"":"Invalid email format.")},z=e=>{/^(?:\+251|09|07)\d+$/.test(e)?e.startsWith("+251")&&13!==e.length?P("+251 numbers must be 13 digits."):(e.startsWith("09")||e.startsWith("07"))&&10!==e.length?P("09 or 07 numbers must be 10 digits."):P(""):P("Start with +251, 09, or 07 and use only digits.")};return(0,a.useEffect)((()=>{t||E()}),[t]),(0,j.jsx)(m.A,{open:t,onClose:(e,t)=>{"backdropClick"!==t&&"escapeKeyDown"!==t&&E()},disableEscapeKeyDown:!0,closeAfterTransition:!0,BackdropComponent:f.A,BackdropProps:{timeout:500},children:(0,j.jsxs)(h.A,{sx:C,bgcolor:"light"===T.palette.mode?T.palette.background.paper:T.palette.background.default,children:[(0,j.jsxs)(h.A,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[(0,j.jsx)(v.A,{variant:"h6",children:s?"Edit User":"Add New User"}),(0,j.jsx)(i.A,{onClick:E,children:(0,j.jsx)(b.A,{})})]}),(0,j.jsxs)(h.A,{component:"form",onSubmit:e=>{if(e.preventDefault(),I||N||M)alert("Please fix the errors before submitting.");else{if(k.password!==k.confirmpassword)return void R("Passwords do not match.");if("Tsedey Bank"===k.department&&"Cashier"===k.usertype)return void y.oR.error("Bank can't have Cashier user type.");s?c(k):l(k)}},children:[(0,j.jsxs)(x.Ay,{container:!0,spacing:2,children:[(0,j.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,j.jsx)(g.A,{fullWidth:!0,label:"Username",name:"username",value:k.username,onChange:W,required:!0,disabled:!!s,error:!!I,helperText:I,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},color:"dark"===T.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===T.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===T.palette.mode?"#fff":"#000"}}}})}),(0,j.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,j.jsx)(g.A,{fullWidth:!0,label:"Email",name:"email",type:"email",value:k.email,onChange:W,required:!0,disabled:!!s,error:!!N,helperText:N,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},color:"dark"===T.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===T.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===T.palette.mode?"#fff":"#000"}}}})}),(0,j.jsx)(x.Ay,{item:!0,xs:12,children:(0,j.jsx)(g.A,{fullWidth:!0,label:"Phone Number",name:"phone",type:"tel",value:k.phone,onChange:W,error:!!M,helperText:M,disabled:!!s,required:!0,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},color:"dark"===T.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===T.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===T.palette.mode?"#fff":"#000"}}}})}),(0,j.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,j.jsx)(g.A,{select:!0,fullWidth:!0,label:"User Type",name:"usertype",value:k.usertype,onChange:W,disabled:!!s,required:!0,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},color:"dark"===T.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===T.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===T.palette.mode?"#fff":"#000"}}},children:["Cashier","Supervisor","Admin","MLT","Radiology","Doctor","Pharmacy"].map((e=>(0,j.jsx)(A.A,{value:e,children:e},e)))})}),(0,j.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,j.jsx)(g.A,{select:!0,fullWidth:!0,label:"Department",name:"department",value:k.department,onChange:W,disabled:!!s,required:!0,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},color:"dark"===T.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===T.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===T.palette.mode?"#fff":"#000"}}},children:["Card","Pharmacy","Hospital","Tsedey Bank","OPD 20","OPD 21","OPD 22","OPD 23","OPD 44","OPD 63","ANC","FAMILY PLANNING","DELIVERY","SURGICAL","NICU","ART"].map((e=>(0,j.jsx)(A.A,{value:e,children:e},e)))})}),(0,j.jsx)(x.Ay,{item:!0,xs:12,children:(0,j.jsx)(g.A,{select:!0,fullWidth:!0,label:"Hospital Name",name:"hospital",value:k.hospital,onChange:W,disabled:!!s,required:!0,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},color:"dark"===T.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===T.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===T.palette.mode?"#fff":"#000"}}},children:["DB Tena tabiya"].map((e=>(0,j.jsx)(A.A,{value:e,children:e},e)))})}),(0,j.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,j.jsx)(g.A,{fullWidth:!0,label:"Password",name:"password",type:"password",value:k.password,onChange:W,required:!0,disabled:!!s,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},color:"dark"===T.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===T.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===T.palette.mode?"#fff":"#000"}}}})}),(0,j.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,j.jsx)(g.A,{fullWidth:!0,label:"Confirm Password",name:"confirmpassword",type:"password",value:k.confirmpassword,onChange:W,required:!0,disabled:!!s,error:!!D,helperText:D,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},color:"dark"===T.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===T.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===T.palette.mode?"#fff":"#000"}}}})}),(0,j.jsx)(x.Ay,{item:!0,xs:12,children:(0,j.jsx)(g.A,{select:!0,fullWidth:!0,label:"Role",name:"role",value:s?k.role:"User",onChange:W,required:!0,disabled:!s,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===T.palette.mode?"#fff":"#000"},color:"dark"===T.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===T.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===T.palette.mode?"#fff":"#000"}}},children:p.map((e=>(0,j.jsx)(A.A,{value:e,children:e},e)))})})]}),(0,j.jsxs)(h.A,{display:"flex",justifyContent:"flex-end",mt:3,children:[(0,j.jsx)(d.A,{onClick:E,variant:"outlined",color:"error",sx:{mr:2},children:"Close"}),(0,j.jsx)(d.A,{type:"submit",variant:"contained",color:"light"===T.palette.mode?"primary":"secondary",children:s?"Save Changes":"Add User"})]})]})]})})};var O=o(16005),I=(o(92342),o(77265));const w={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,padding:4,borderRadius:2,boxShadow:24},N={position:"absolute",top:10,right:10},S=e=>{let{open:t,onClose:o,username:l,onSubmit:s,clearUserData:c}=e;const[u,p]=(0,a.useState)(""),[f,x]=(0,a.useState)(""),[A,C]=(0,a.useState)(""),[k,O]=(0,a.useState)({newPassword:"",confirmPassword:""}),I=(0,n.A)();(0,a.useEffect)((()=>{t||M()}),[t]);const S=(e,t)=>{const o=[];t.length<6&&o.push("Passwords must be at least 6 characters."),/[^\w\s]/.test(t)||o.push("Passwords must have at least one non-alphanumeric character."),/[a-z]/.test(t)||o.push("Passwords must have at least one lowercase ('a'-'z')."),/[A-Z]/.test(t)||o.push("Passwords must have at least one uppercase ('A'-'Z')."),O((t=>(0,r.A)((0,r.A)({},t),{},{[e]:o.join(", ")})))},M=()=>{x(""),p(""),C(""),O({newPassword:"",confirmPassword:""}),c(),o()};return(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(m.A,{open:t,onClose:(e,t)=>{"backdropClick"!==t&&"escapeKeyDown"!==t&&M()},children:(0,j.jsxs)(h.A,{sx:w,bgcolor:"light"===I.palette.mode?I.palette.background.paper:I.palette.background.default,children:[(0,j.jsx)(i.A,{sx:N,onClick:o,children:(0,j.jsx)(b.A,{})}),(0,j.jsxs)(v.A,{variant:"h6",gutterBottom:!0,children:["Set Password for ",(0,j.jsx)("strong",{children:l})]}),(0,j.jsx)(g.A,{label:"Username",fullWidth:!0,value:l,disabled:!0,sx:{marginBottom:2},InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===I.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===I.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===I.palette.mode?"#fff":"#000"},color:"dark"===I.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===I.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===I.palette.mode?"#fff":"#000"}}}}),(0,j.jsx)(g.A,{label:"Password",type:"password",name:"newPassword",fullWidth:!0,value:u,onChange:e=>{p(e.target.value),S(e.target.name,e.target.value)},error:!!k.newPassword,helperText:k.newPassword,sx:{marginBottom:2},InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===I.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===I.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===I.palette.mode?"#fff":"#000"},color:"dark"===I.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===I.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===I.palette.mode?"#fff":"#000"}}}}),(0,j.jsx)(g.A,{label:"Confirm Password",type:"password",name:"confirmPassword",fullWidth:!0,value:f,onChange:e=>{x(e.target.value),S(e.target.name,e.target.value)},error:!!k.confirmPassword,helperText:k.confirmPassword,sx:{marginBottom:2},InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===I.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===I.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===I.palette.mode?"#fff":"#000"},color:"dark"===I.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===I.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===I.palette.mode?"#fff":"#000"}}}}),A&&(0,j.jsx)(v.A,{color:"error",variant:"body2",sx:{marginBottom:2},children:A}),(0,j.jsxs)(h.A,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,j.jsx)(d.A,{variant:"outlined",onClick:M,children:"Cancel"}),(0,j.jsx)(d.A,{variant:"contained",color:"light"===I.palette.mode?"primary":"secondary",onClick:()=>(()=>{if((null===u||void 0===u?void 0:u.length)<=0&&(null===f||void 0===f?void 0:f.length)<=0)return y.oR.error("Please fill the required fields."),void O({newPassword:"Please fill this field.",confirmPassword:"Please fill this field."});if(u===f){if(k.newPassword||k.confirmPassword)return void y.oR.error("Please fix the errors before submitting.");s(l,u,f),C(""),O({newPassword:"",confirmPassword:""})}else C("Passwords do not match!")})(),children:"Submit"})]})]})})})},M=()=>{const[e,t]=(0,a.useState)(!1),[o,m]=(0,a.useState)(!1),[f,h]=(0,a.useState)(!1),[v,x]=(0,a.useState)(null),[g,A]=(0,a.useState)([]),[b,C]=(0,a.useState)(!1),[w,N]=(0,a.useState)([]),[M,P]=(0,a.useState)(""),[D,R]=(0,a.useState)(""),[T,E]=(0,a.useState)(""),W=(0,n.A)(),L=async()=>{x(null)},q=async()=>{E("")},z=[{field:"orderNumber",headerName:"ID",flex:1},{field:"username",headerName:"UserName",flex:1},{field:"email",headerName:"Email",flex:1},{field:"phoneNumber",headerName:"PhoneNumber",flex:1},{field:"roles",headerName:"Role",flex:1},{field:"departement",headerName:"Department",flex:1},{field:"userType",headerName:"User Type",flex:1},{field:"hospital",headerName:"Hospital Name",flex:1},{field:"actions",headerName:"Actions",width:150,renderCell:e=>(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(i.A,{onClick:()=>(async e=>{try{x(e.row),t(!0)}catch(o){console.error(o.message)}})(e),"aria-label":"edit",className:"text-info",children:(0,j.jsx)(s.A,{})}),(0,j.jsx)(i.A,{color:"danger",onClick:()=>(async e=>{h(!0),R(e.row.username),P(e.row.id)})(e),"aria-label":"delete",className:"text-danger",children:(0,j.jsx)(c.A,{})}),(0,j.jsx)(i.A,{color:"warning",onClick:()=>(async e=>{try{E(e.row.username),m(!0)}catch(t){console.error(t.message)}})(e),"aria-label":"reset password",className:"text-warnning",children:(0,j.jsx)(u.A,{})})]})}];(0,a.useEffect)((()=>{(async()=>{try{var e;const t=await I.A.get("/Admin/users"),o=(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.sort(((e,t)=>e.username.localeCompare(t.username)))).map(((e,t)=>(0,r.A)((0,r.A)({},e),{},{orderNumber:t+1})));A(o)}catch(t){console.error(t.message)}})()}),[b]),(0,a.useEffect)((()=>{(async()=>{try{var e;const t=await I.A.get("/Admin/roles");N(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.map((e=>e.name)))}catch(r){var t,o;console.error("fetchrole>>",r.message),y.oR.error((null===r||void 0===r||null===(t=r.response)||void 0===t||null===(o=t.data)||void 0===o?void 0:o.message)||"Internal Server Error on Role Fetch;")}})()}),[]);return(0,j.jsxs)("div",{className:"user-management-container",children:[(0,j.jsx)("h1",{className:"hed",children:"User Management"}),(0,j.jsx)(d.A,{variant:"contained",color:"light"===W.palette.mode?"primary":"secondary",startIcon:(0,j.jsx)(p.A,{}),onClick:()=>t(!0),children:"Add User"}),(0,j.jsx)(k,{isOpen:e,onClose:()=>t(!1),onSubmit:async e=>{try{const r=await I.A.post("/Admin/users",{username:e.username,email:e.email,password:e.password,phoneNumber:e.phone,userType:e.usertype,departement:e.department,hospital:e.hospital});var o;if(200===(null===r||void 0===r?void 0:r.status))y.oR.success(null===r||void 0===r||null===(o=r.data)||void 0===o?void 0:o.message),C((e=>!e)),L(),t(!1)}catch(d){var r,a,l,n,i;if(console.error(d),Array.isArray(null===d||void 0===d||null===(r=d.response)||void 0===r?void 0:r.data))null===d||void 0===d||null===(a=d.response)||void 0===a||null===(l=a.data)||void 0===l||l.map((e=>y.oR.error(e.description)));else y.oR.error((null===d||void 0===d||null===(n=d.response)||void 0===n||null===(i=n.data)||void 0===i?void 0:i.message)||"Internal Server Error.")}},onEdit:async e=>{try{const t=await I.A.post("/Admin/change-user-role",{userName:e.username,newRole:e.role});200===(null===t||void 0===t?void 0:t.status)&&(y.oR.success("Role Changed Success Fully!!"),C((e=>!e)),L())}catch(o){console.error(o.message),y.oR.error("Internal Server Error.")}finally{t(!1)}},userData:v,resetUserData:L,role:w}),(0,j.jsx)(O.A,{isOpen:f,onClose:()=>h(!1),userData:D,onConfirm:()=>(async()=>{try{const e=await I.A.delete("/Admin/users/".concat(M));200===e.status&&(y.oR.success(e.data.message),C((e=>!e)),h(!1))}catch(o){var e,t;console.error(o.message),y.oR.error(null===o||void 0===o||null===(e=o.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)}finally{P(""),R("")}})()}),(0,j.jsx)(S,{open:o,onClose:()=>m(!1),username:T,onSubmit:async(e,t,o)=>{try{var r;const o=await I.A.post("/Admin/reset-password",{username:e,newPassword:t});y.oR.success(null===o||void 0===o||null===(r=o.data)||void 0===r?void 0:r.message),q()}catch(n){var a,l;console.error(n.message),y.oR.error((null===n||void 0===n||null===(a=n.response)||void 0===a||null===(l=a.data)||void 0===l?void 0:l.message)||"Internal Server Error")}finally{m(!1)}},clearUserData:q}),(0,j.jsx)("div",{className:"data-grid-container",children:(0,j.jsx)(l.z,{rows:g,columns:z,autoHeight:!0,sx:{minWidth:320}})}),(0,j.jsx)(y.N9,{})]})}},92135:(e,t,o)=>{o.r(t),o.d(t,{default:()=>v});var r=o(65043),a=o(46946),l=o(8591),n=o(78632),i=o(17642),d=o(17434),s=o(94814),c=o(42788),u=o(61976),p=o(70579);const m=[{id:1,name:"John",age:25},{id:2,name:"Alice",age:30},{id:3,name:"Bob",age:20},{id:4,name:"Eve",age:35}],f=[{field:"id",headerName:"ID",width:70},{field:"name",headerName:"Name",width:150},{field:"age",headerName:"Age",width:100}],h=[{label:"Equal to",value:"="},{label:"Greater than",value:">"},{label:"Less than",value:"<"},{label:"Greater or equal",value:">="},{label:"Less or equal",value:"<="},{label:"Not equal",value:"!="},{label:"Between",value:"between"}];function v(){const[e,t]=(0,r.useState)("="),[o,v]=(0,r.useState)(""),[x,g]=(0,r.useState)(""),[A,b]=(0,r.useState)(""),y=(0,r.useMemo)((()=>{const t=parseInt(o),r=parseInt(x),a=parseInt(A);return"between"===e?isNaN(r)||isNaN(a)?m:m.filter((e=>e.age>=r&&e.age<=a)):isNaN(t)?m:m.filter((o=>{switch(e){case">":return o.age>t;case"<":return o.age<t;case"=":return o.age===t;case">=":return o.age>=t;case"<=":return o.age<=t;case"!=":return o.age!==t;default:return!0}}))}),[e,o,x,A]);return(0,p.jsxs)(a.A,{sx:{p:2},children:[(0,p.jsxs)(l.Ay,{container:!0,spacing:2,alignItems:"center",mb:2,children:[(0,p.jsx)(l.Ay,{item:!0,xs:12,sm:4,children:(0,p.jsxs)(n.A,{fullWidth:!0,children:[(0,p.jsx)(i.A,{children:"Filter Type"}),(0,p.jsx)(d.A,{value:e,label:"Filter Type",onChange:e=>t(e.target.value),children:h.map((e=>(0,p.jsx)(s.A,{value:e.value,children:e.label},e.value)))})]})}),"between"===e?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(l.Ay,{item:!0,xs:6,sm:4,children:(0,p.jsx)(c.A,{label:"Min Age",type:"number",value:x,onChange:e=>g(e.target.value),fullWidth:!0})}),(0,p.jsx)(l.Ay,{item:!0,xs:6,sm:4,children:(0,p.jsx)(c.A,{label:"Max Age",type:"number",value:A,onChange:e=>b(e.target.value),fullWidth:!0})})]}):(0,p.jsx)(l.Ay,{item:!0,xs:12,sm:4,children:(0,p.jsx)(c.A,{type:"number",label:"Age",value:o,onChange:e=>v(e.target.value),fullWidth:!0})})]}),(0,p.jsx)(u.z,{rows:y,columns:f,autoHeight:!0,sx:{minWidth:320}})]})}},92654:(e,t,o)=>{o.r(t),o.d(t,{default:()=>i});var r=o(46946),a=o(37660),l=o(10665),n=o(70579);const i=()=>(0,n.jsxs)(r.A,{m:"20px",children:[(0,n.jsx)(a.A,{title:"Pie Chart",subtitle:"Simple Pie Chart"}),(0,n.jsx)(r.A,{height:"75vh",children:(0,n.jsx)(l.A,{})})]})},96164:(e,t,o)=>{o.r(t),o.d(t,{default:()=>M});var r=o(89379),a=o(80045),l=o(65043),n=o(26240),i=o(59314),d=o(98056),s=o(94496),c=o(19955),u=o(40360),p=o(46946),m=o(42788),f=o(72882),h=o(97334),v=o(61976),x=o(56776),g=o(65311),A=o(77265),b=o(9551),y=o(57488),j=(o(92342),o(17555)),C=o(11238),k=o(70579);const O=["patientCardNumber","hospitalName","department","registeredBy"],I=["id","isCollected","collectionID"],w=["rowId"],N=["rowId"],S=new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2,useGrouping:!0}),M=()=>{const[e,t]=(0,l.useState)(0),[o,M]=(0,l.useState)(""),[P,D]=(0,l.useState)(""),[R,T]=(0,l.useState)(!1),[E,W]=(0,l.useState)([]),[L,q]=(0,l.useState)([]),[z,B]=(0,l.useState)(""),[F,U]=(0,l.useState)(!1),H=(0,n.A)(),G=/^[a-zA-Z0-9-]+$/,Y=[{field:"id",headerName:"ID",flex:1},{field:"registeredOn",headerName:"Date",flex:1},{field:"referenceNo",headerName:"Reciept Number",flex:1},{field:"patientCardNumber",headerName:"Card Number",flex:1},{field:"patientName",headerName:"Patient Name",flex:1},{field:"paymentAmount",headerName:"Amount",flex:1,renderCell:e=>(e=>{const t=S.format(Math.abs(e));return e<0?"(".concat(t,")"):t})(e.row.paymentAmount)},{field:"paymentType",headerName:"Payment Method",flex:1},{field:"paymentReason",headerName:"Reason",flex:1},{field:"isReversed",headerName:"IsReversed",flex:1,renderCell:e=>{var t;return(null===e||void 0===e||null===(t=e.row)||void 0===t?void 0:t.isReversed)&&(0,k.jsxs)("p",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start",padding:0,marginTop:"0",color:"red",gap:"3px"},children:[(0,k.jsx)(j.A,{color:"error",fontSize:"small"}),(0,k.jsx)("span",{children:"Reversed"})]})}}],_=async()=>{try{if(0===e&&o)E.length>0?(e=>{try{if(!e||0===e.length)return;const{patientCardNumber:t,hospitalName:r,department:l,registeredBy:n}=e[0],i=[["Card Number",t],["Hospital Name",r],["Department",l],["Cashier",n],[]],d=e.map((e=>{let{patientCardNumber:t,hospitalName:o,department:r,registeredBy:l}=e;return(0,a.A)(e,O)})),s=C.Wp.aoa_to_sheet(i);C.Wp.sheet_add_json(s,d,{origin:{r:i.length,c:0},skipHeader:!1});const c=C.Wp.decode_range(s["!ref"]);for(let e=c.s.c;e<=c.e.c;++e){const t=C.Wp.encode_cell({r:i.length,c:e});s[t]&&(s[t].s={font:{bold:!0},alignment:{horizontal:"center"},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}}}})}const u=C.Wp.book_new();C.Wp.book_append_sheet(u,s,"Patient Report of ".concat(o)),C._h(u,"Patient Report ".concat((new Date).toISOString().slice(0,10),".xlsx"))}catch(t){console.error("Excel export failed:",t)}})(E.map((e=>{let{id:t,isCollected:o,collectionID:r}=e;return(0,a.A)(e,I)}))):y.oR.error("Data is Empty.");else if(1===e&&P)if(L.length>0){if(null!==L&&void 0!==L&&L.some((e=>!0===e.isReversed)))return void y.oR.error("Reversed receipt can't be printed.");const e=await Z(L||[]);(0,b.generatePDF)(e)}else y.oR.error("Data is Empty.")}catch(t){console.error("Printing Task Erro: ",t)}},Z=async e=>{if(!e||0===e.length)return null;const t=e[0];return{refNo:null===t||void 0===t?void 0:t.referenceNo,id:null===t||void 0===t?void 0:t.id,cardNumber:null===t||void 0===t?void 0:t.patientCardNumber,recipt:null===t||void 0===t?void 0:t.recipt,patientName:null===t||void 0===t?void 0:t.patientName,hospitalName:null===t||void 0===t?void 0:t.hospitalName,department:null===t||void 0===t?void 0:t.department,amount:e.map((e=>({purpose:e.paymentReason,amount:e.paymentAmount}))),cbhiId:null===t||void 0===t?void 0:t.patientCBHI_ID,createdby:null===t||void 0===t?void 0:t.registeredBy,method:null===t||void 0===t?void 0:t.paymentType,digitalChannel:null===t||void 0===t?void 0:t.paymentChannel,trxref:null===t||void 0===t?void 0:t.paymentVerifingID,patientLoaction:null===t||void 0===t?void 0:t.patientWoreda,organization:null===t||void 0===t?void 0:t.patientWorkingPlace,employeeId:null===t||void 0===t?void 0:t.patientWorkID,description:null===t||void 0===t?void 0:t.paymentDescription,createdOn:null===t||void 0===t?void 0:t.registeredOn}};(0,l.useEffect)((()=>{M(""),D(""),U(!1),B(""),W([]),q([])}),[e]);return(0,k.jsxs)(i.A,{sx:{p:3,borderRadius:"2xl",boxShadow:3,marginInline:"15px"},children:[(0,k.jsxs)(d.A,{children:[(0,k.jsx)(s.A,{variant:"h5",gutterBottom:!0,children:0===e?"Find Patient By Card Number":"Generate Receipt by Receipt Number"}),(0,k.jsxs)(c.A,{value:e,onChange:(e,o)=>t(o),sx:{mb:2},TabIndicatorProps:{style:{backgroundColor:"#1976d2"}},children:[(0,k.jsx)(u.A,{icon:(0,k.jsx)(g.A,{}),label:"Report by Card Number",sx:{"&.Mui-selected":{color:"#a2b9f5"}}}),(0,k.jsx)(u.A,{icon:(0,k.jsx)(x.A,{}),label:"Receipt",sx:{"&.Mui-selected":{color:"#a2b9f5"}}})]}),(0,k.jsxs)(p.A,{display:"flex",alignItems:"center",gap:2,mb:3,children:[0===e?(0,k.jsx)(m.A,{label:"Card Number",variant:"outlined",value:o,onChange:e=>{U(!1),W([]),M(e.target.value)},fullWidth:!0,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===H.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===H.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===H.palette.mode?"#fff":"#000"},color:"dark"===H.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===H.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===H.palette.mode?"#fff":"#000"}}}}):(0,k.jsx)(m.A,{label:"Receipt Number",variant:"outlined",value:P,onChange:e=>{q([]),U(!1);const t=e.target.value;var o;o=t,!G.test(o)&&(null===o||void 0===o?void 0:o.length)>0?B("Please Insert Valid Receipt Number."):B(""),D(t)},fullWidth:!0,error:!!z,helperText:z,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===H.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===H.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===H.palette.mode?"#fff":"#000"},color:"dark"===H.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===H.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===H.palette.mode?"#fff":"#000"}}}}),!F&&(0,k.jsx)(f.A,{variant:"contained",size:"large",onClick:()=>(async()=>{try{if(T(!0),0===e&&o){var t,l;const e=await A.A.put("/Payment/payment-by-cardNumber",{patientCardNumber:o});if((null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.length)>0){var n;U(!0);const t=null===(n=e.data)||void 0===n?void 0:n.map((e=>{let{rowId:t}=e,o=(0,a.A)(e,w);return(0,r.A)({id:t},o)}));W(t)}else(null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.length)<=0&&y.oR.info("Card Number Not Found.")}else if(1===e&&P){var i,d;const e=await A.A.put("/Payment/payment-by-refno",{paymentId:P});if((null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.length)>0){var s;U(!0);const t=null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.map((e=>{let{rowId:t}=e,o=(0,a.A)(e,N);return(0,r.A)({id:t},o)}));q(t)}else(null===e||void 0===e||null===(d=e.data)||void 0===d?void 0:d.length)<=0&&y.oR.info("Receipt Not Found.")}}catch(u){var c;console.error(u),y.oR.error((null===u||void 0===u||null===(c=u.response)||void 0===c?void 0:c.data)||"Internal Server Error."),U(!1)}finally{T(!1)}})(),disabled:R||(0===e?!o:!P)||!!z,children:R?(0,k.jsx)(h.A,{size:24}):"Search"}),F&&(0,k.jsx)(f.A,{variant:"contained",color:"secondary",size:"large",onClick:()=>_(),children:R?(0,k.jsx)(h.A,{size:24}):"Print"})]}),(0,k.jsx)(v.z,{autoHeight:!0,rows:0===e?E:L,columns:Y,disableRowSelectionOnClick:!0,sx:{minWidth:320}})]}),(0,k.jsx)(y.N9,{})]})}},96724:(e,t,o)=>{o.d(t,{A:()=>x});var r=o(89379),a=o(65043),l=o(57556),n=o(46946),i=o(94496),d=o(88911),s=o(71716),c=o(72882),u=o(97334),p=o(61976),m=o(11238),f=o(57488),h=o(33086),v=o(70579);const x=e=>{let{isOpen:t=!1,setIsOpen:o,onSubmit:x,loading:g,setLoading:A}=e;const[b,y]=(0,a.useState)([]),j=(0,a.useRef)(null),C=()=>{try{o(!1),y([]),A(!1)}catch(e){console.error("Close error",e)}};(0,a.useEffect)((()=>{t||C()}),[t]);return(0,v.jsx)(l.A,{open:t,onClose:(e,t)=>{"backdropClick"!==t&&"escapeKeyDown"!==t&&C()},"aria-labelledby":"modal-title",children:(0,v.jsxs)(n.A,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"80%",maxHeight:"90vh",overflowY:"auto",bgcolor:"background.paper",boxShadow:24,p:4,borderRadius:3},children:[(0,v.jsx)(i.A,{variant:"h6",gutterBottom:!0,id:"modal-title",children:"Upload Hospital Services (Excel)"}),(0,v.jsxs)(d.A,{direction:"row",spacing:2,alignItems:"center",mb:2,children:[(0,v.jsx)("input",{ref:j,type:"file",accept:".xlsx, .xls",onChange:e=>{try{const t=e.target.files[0];if(!t)return;const o=new FileReader;o.onload=e=>{const t=new Uint8Array(e.target.result),o=m.LF(t,{type:"array"}),a=o.SheetNames[0],l=o.Sheets[a],n=m.Wp.sheet_to_json(l).map(((e,t)=>(0,r.A)({id:t+1},e)));y(n)},o.readAsArrayBuffer(t)}catch(t){console.error("File Upload Error: ",t)}}}),(0,v.jsx)(s.A,{onClick:()=>{y([]),j.current.value=null},color:"error",sx:{marginLeft:2},children:(0,v.jsx)(h.A,{})}),(0,v.jsx)(c.A,{variant:"contained",disabled:!b.length||g,onClick:async()=>{try{x({purpose:b.map((e=>e.Name)),amount:b.map((e=>e.Amount)),shortCode:b.map((e=>e.ShortCode)),group:b.map((e=>e.Group)),subgroup:b.map((e=>e.SubGroup))})}catch(e){console.error(e),f.oR.error("Upload failed.")}},children:g?(0,v.jsx)(u.A,{size:24}):"Upload to Database"})]}),(0,v.jsx)(n.A,{sx:{height:400,width:"100%"},children:(0,v.jsx)(p.z,{rows:b,columns:[{field:"Name",headerName:"Hospital Services",flex:1},{field:"ShortCode",headerName:"Short Code",flex:1},{field:"Group",headerName:"Group",flex:1},{field:"SubGroup",headerName:"SubGroup",flex:1},{field:"Amount",headerName:"Amount",flex:1}],autoHeight:!0,sx:{minWidth:320}})}),(0,v.jsx)(n.A,{sx:{display:"flex",justifyContent:"right",width:"100%"},children:(0,v.jsx)(c.A,{variant:"contained",sx:{margin:"10px"},onClick:()=>C(),color:"error",children:"Cancel"})})]})})}},97352:(e,t,o)=>{o.r(t),o.d(t,{default:()=>W});var r=o(80045),a=o(89379),l=o(65043),n=o(26240),i=o(46946),d=o(94496),s=o(72882),c=o(83462),u=o(4219),p=o(97368),m=o(8591),f=o(78632),h=o(17642),v=o(17434),x=o(94814),g=o(66124),A=o(42788),b=o(56894),y=o(97334),j=o(92064),C=o(61976),k=o(70141),O=o(57488),I=(o(92342),o(27073)),w=o.n(I),N=o(77265),S=o(83074),M=o(48292),P=o(70579);const D=["patientFirstName","patientMiddleName","patientLastName","rowID"],R={mrn:"",id:"",goth:"",kebele:"",expDate:"",referralNumber:"",letterNumber:"",examination:""},T=(e,t)=>"Reset"===t.name?R:(0,a.A)((0,a.A)({},e),{},{[t.name]:t.values}),E={mrn:"MRN",id:"ID",kebele:"Woreda/Kebele",expDate:"Expiration Date"};const W=function(){const[e,t]=(0,l.useState)([]),[o,I]=(0,l.useState)(!1),[W,L]=(0,l.useState)(R),[q,z]=(0,l.useReducer)(T,R),[B,F]=(0,l.useState)(!1),[U,H]=(0,l.useState)([]),[G,Y]=(0,l.useState)(!1),[_,Z]=(0,l.useState)(!1),[$,K]=(0,l.useState)(""),V=(0,n.A)();(0,l.useEffect)((()=>{(async()=>{try{const t=await N.A.get("/Providers/list-providers");var e;if(200===t.status)H(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.map((e=>e.provider)))}catch(t){console.error("Fetch woredas error:",t)}})()}),[]),(0,l.useEffect)((()=>{(async()=>{try{const l=await N.A.post("/Patient/get-patient-cbhi");if(200===l.status){var e,o;const n=Array.isArray(null===l||void 0===l||null===(e=l.data)||void 0===e||null===(o=e.data)||void 0===o?void 0:o.value)&&l.data.data.value.length>0?l.data.data.value.map(((e,t)=>{let{patientFirstName:o="",patientMiddleName:l="",patientLastName:n="",rowID:i}=e,d=(0,r.A)(e,D);return(0,a.A)((0,a.A)({},d),{},{patientFName:"".concat(o," ").concat(l," ").concat(n).trim(),id:t+1})})).sort(((e,t)=>t.id-e.id)):[];t(n)}}catch(l){console.error("Fetch woredas error:",l)}})()}),[G]);const X=()=>{I(!1),L(R),z({name:"Reset"}),K("")},Q=e=>{const{name:t,value:o}=e.target;"mrn"===t?(K(""),ee(t,o)):te(t,o),L((e=>(0,a.A)((0,a.A)({},e),{},{[t]:o})))},J=[{field:"patientCardNumber",headerName:"MRN",flex:1},{field:"patientFName",headerName:"Patient Name",flex:1},{field:"idNo",headerName:"ID",flex:1},{field:"woreda",headerName:"Woreda/Kebele",flex:1},{field:"goth",headerName:"Goth",flex:1},{field:"referalNo",headerName:"Referral No.",flex:1},{field:"letterNo",headerName:"Letter No.",flex:1},{field:"examination",headerName:"Examination",flex:1},{field:"expDate",headerName:"Expired Date",flex:1,renderCell:e=>{var t;return(0,M.renderETDateAtCell)(null===e||void 0===e||null===(t=e.row)||void 0===t?void 0:t.expDate)}}],ee=(e,t)=>{const o=/^[0-9a-zA-Z\s\_\-]{5,}$/.test(t);z({name:e,values:o?"":"Please enter valid MRN (5+ digits)."})},te=(e,t)=>{const o=/^[a-zA-Z0-9\u1200-\u137F\s/\\]+$/.test(t);z({name:e,values:o?"":"Letters and numbers and \\ / only."})};return(0,P.jsxs)(i.A,{p:4,children:[(0,P.jsx)(O.N9,{}),(0,P.jsxs)(i.A,{display:"flex",justifyContent:"space-between",mb:2,children:[(0,P.jsx)(d.A,{variant:"h5",fontWeight:"bold",children:"CBHI Users Management"}),(0,P.jsx)(s.A,{variant:"contained",color:"light"===V.palette.mode?"info":"success",startIcon:(0,P.jsx)(k.A,{}),onClick:()=>function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null!==e){const t={mrn:null===e||void 0===e?void 0:e.mrn,id:null===e||void 0===e?void 0:e.idNo,goth:null===e||void 0===e?void 0:e.goth,kebele:null===e||void 0===e?void 0:e.provider,expDate:null===e||void 0===e?void 0:e.expDate,referralNumber:null===e||void 0===e?void 0:e.referalNo,letterNumber:null===e||void 0===e?void 0:e.letterNo,examination:null===e||void 0===e?void 0:e.examination};L(t)}else L(R);I(!0)}(),children:"Add CBHI User"})]}),(0,P.jsx)(C.z,{autoHeight:!0,rows:e,columns:J,sx:{boxShadow:3,borderRadius:2,minWidth:320}}),(0,P.jsxs)(c.A,{open:o,onClose:(e,t)=>{"backdropClick"!==t&&"escapeKeyDown"!==t&&X()},fullWidth:!0,maxWidth:"md",disableEnforceFocus:!0,children:[(0,P.jsx)(u.A,{children:"Add CBHI User"}),(0,P.jsx)(p.A,{children:(0,P.jsx)(m.Ay,{container:!0,spacing:2,mt:1,children:[{label:"MRN",name:"mrn"},{label:"ID",name:"id"},{label:"Woreda/Kebele",name:"kebele"},{label:"Goth",name:"goth"},{label:"Expired Date",name:"expDate"},{label:"Referral Number",name:"referralNumber"},{label:"Letter Number",name:"letterNumber"},{label:"Examination",name:"examination"}].map((e=>{var t;let{label:o,name:r}=e;return(0,P.jsx)(m.Ay,{item:!0,xs:12,sm:6,children:"expDate"===r?(0,P.jsx)(w(),{label:o,name:r,required:!0,error:!!q[r],helperText:q[r],value:W[r]?new Date(W[r]):null,onChange:e=>((e,t)=>{const o=new Date(t);if(isNaN(o.getTime()))return;const r=o.getTimezoneOffset(),l="".concat(r<=0?"+":"-").concat(String(Math.abs(r/60)).padStart(2,"0"),":").concat(String(Math.abs(r%60)).padStart(2,"0")),n=new Date(o.getTime()-6e4*r).toISOString().slice(0,19).replace("T"," "),i="".concat(n," ").concat(l);L((t=>(0,a.A)((0,a.A)({},t),{},{[e]:i}))),z({name:e,values:""})})(r,e),sx:{width:"100%"},InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===V.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===V.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===V.palette.mode?"#fff":"#000"},color:"dark"===V.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===V.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===V.palette.mode?"#fff":"#000"}}}}):"kebele"===r?(0,P.jsxs)(f.A,{required:!0,fullWidth:!0,error:!!q[r],sx:{"& .MuiInputLabel-root":{color:"dark"===V.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===V.palette.mode?"#fff":"#000"}},"& .MuiOutlinedInput-root":{color:"dark"===V.palette.mode?"#fff":"#000","& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===V.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===V.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===V.palette.mode?"#fff":"#000"}}},children:[(0,P.jsx)(h.A,{children:o}),(0,P.jsx)(v.A,{name:r,value:W[r],onChange:Q,label:o,children:U.map((e=>(0,P.jsx)(x.A,{value:e,children:e},e)))}),(0,P.jsx)(g.A,{children:q[r]})]}):"mrn"===r?(0,P.jsx)(A.A,{fullWidth:!0,label:o,name:r,value:W[r],onChange:Q,required:["mrn","id","kebele"].includes(r),error:!!q[r],helperText:(null===(t=q[r])||void 0===t?void 0:t.length)>0?q[r]:$,InputProps:{endAdornment:(0,P.jsx)(b.A,{position:"end",children:_&&(0,P.jsx)(y.A,{size:24,color:"inherit"})}),sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===V.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===V.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===V.palette.mode?"#fff":"#000"},color:"dark"===V.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===V.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===V.palette.mode?"#fff":"#000"}}},FormHelperTextProps:{style:{color:null!==q&&void 0!==q&&q.mrn?"red":"green",fontSize:"14px"}},onBlurCapture:()=>(async()=>{try{var e,t;if(Z(!0),(null===$||void 0===$?void 0:$.length)<=0&&(null===q||void 0===q||null===(e=q.mrn)||void 0===e?void 0:e.length)<=0&&(null===W||void 0===W||null===(t=W.mrn)||void 0===t?void 0:t.length)>0){const e=await(0,S.rA)(null===W||void 0===W?void 0:W.mrn);(null===e||void 0===e?void 0:e.length)>0?K(e):O.oR.error("Card Number Not Registered.")}}catch(o){console.error(o)}finally{Z(!1)}})()}):(0,P.jsx)(A.A,{fullWidth:!0,label:o,name:r,value:W[r],onChange:Q,multiline:"examination"===r,rows:"examination"===r?4:1,required:["mrn","id","kebele"].includes(r),error:!!q[r],helperText:q[r],InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===V.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===V.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===V.palette.mode?"#fff":"#000"},color:"dark"===V.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===V.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===V.palette.mode?"#fff":"#000"}}}})},r)}))})}),(0,P.jsxs)(j.A,{children:[(0,P.jsx)(s.A,{onClick:X,variant:"outlined",color:"error",children:"Cancel"}),(0,P.jsx)(s.A,{variant:"contained",onClick:async()=>{F(!0);try{const t=Object.keys(E).filter((e=>!W[e]));if((null===t||void 0===t?void 0:t.length)>0){const e=t.map((e=>E[e])).join(", ");return null===t||void 0===t||t.map((e=>{z({name:e,values:"Please fill this field"})})),void O.oR.error("Please fill in the following required fields: ".concat(e))}if(Object.values(q).some((e=>e.length>0)))return void O.oR.error("Please fix the errors.");const o={provider:null===W||void 0===W?void 0:W.kebele,service:"CBHI",kebele:null===W||void 0===W?void 0:W.kebele,goth:null===W||void 0===W?void 0:W.goth,idNo:null===W||void 0===W?void 0:W.id,referalNo:null===W||void 0===W?void 0:W.referralNumber,letterNo:null===W||void 0===W?void 0:W.letterNumber,examination:null===W||void 0===W?void 0:W.examination,expDate:null===W||void 0===W?void 0:W.expDate,cardNumber:"".concat(Number(null===W||void 0===W?void 0:W.mrn))},r=await N.A.post("/Patient/add-patient-cbhi",o);var e;if(201===(null===r||void 0===r?void 0:r.status))O.oR.success((null===r||void 0===r||null===(e=r.data)||void 0===e?void 0:e.msg)||"CBHI User Regustered Success Fully."),Y((e=>!e)),K(""),X()}catch(t){console.error("Save error:",t),O.oR.error("Failed to save user.")}finally{F(!1)}},color:"dark"===V.palette.mode?"secondary":"primary",disabled:B,children:B?(0,P.jsx)(y.A,{size:20}):"Save"})]})]})]})}}}]);
//# sourceMappingURL=5735.6640a15b.chunk.js.map