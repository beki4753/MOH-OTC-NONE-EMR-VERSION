"use strict";(self.webpackChunkreact_admin=self.webpackChunkreact_admin||[]).push([[603,5841,7378,8222],{17555:(e,t,o)=>{var r=o(24994);t.A=void 0;var a=r(o(40039)),n=o(70579);t.A=(0,a.default)((0,n.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1z"}),"Lock")},51152:(e,t,o)=>{o.d(t,{A:()=>i,T:()=>n});var r=o(92532),a=o(72372);function n(e){return(0,a.Ay)("MuiCard",e)}const i=(0,r.A)("MuiCard",["root"])},56776:(e,t,o)=>{var r=o(24994);t.A=void 0;var a=r(o(40039)),n=o(70579);t.A=(0,a.default)([(0,n.jsx)("path",{d:"M19.5 3.5 18 2l-1.5 1.5L15 2l-1.5 1.5L12 2l-1.5 1.5L9 2 7.5 3.5 6 2v14H3v3c0 1.66 1.34 3 3 3h12c1.66 0 3-1.34 3-3V2zM19 19c0 .55-.45 1-1 1s-1-.45-1-1v-3H8V5h11z"},"0"),(0,n.jsx)("path",{d:"M9 7h6v2H9zm7 0h2v2h-2zm-7 3h6v2H9zm7 0h2v2h-2z"},"1")],"ReceiptLong")},59314:(e,t,o)=>{o.d(t,{A:()=>f});var r=o(58168),a=o(98587),n=o(65043),i=o(58387),d=o(98610),l=o(34535),s=o(98206),c=o(65204),u=o(51152),p=o(70579);const m=["className","raised"],v=(0,l.Ay)(c.A,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({overflow:"hidden"}))),f=n.forwardRef((function(e,t){const o=(0,s.b)({props:e,name:"MuiCard"}),{className:n,raised:l=!1}=o,c=(0,a.A)(o,m),f=(0,r.A)({},o,{raised:l}),h=(e=>{const{classes:t}=e;return(0,d.A)({root:["root"]},u.T,t)})(f);return(0,p.jsx)(v,(0,r.A)({className:(0,i.A)(h.root,n),elevation:l?8:void 0,ref:t,ownerState:f},c))}))},65311:(e,t,o)=>{var r=o(24994);t.A=void 0;var a=r(o(40039)),n=o(70579);t.A=(0,a.default)((0,n.jsx)("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2m0 14H4v-6h16zm0-10H4V6h16z"}),"CreditCard")},91066:(e,t,o)=>{o.d(t,{A:()=>i,h:()=>n});var r=o(92532),a=o(72372);function n(e){return(0,a.Ay)("MuiCardContent",e)}const i=(0,r.A)("MuiCardContent",["root"])},96164:(e,t,o)=>{o.r(t),o.d(t,{default:()=>S});var r=o(89379),a=o(80045),n=o(65043),i=o(26240),d=o(59314),l=o(98056),s=o(94496),c=o(19955),u=o(40360),p=o(46946),m=o(42788),v=o(72882),f=o(97334),h=o(61976),b=o(56776),x=o(65311),A=o(77265),g=o(9551),y=o(57488),C=(o(92342),o(17555)),N=o(11238),R=o(70579);const I=["patientCardNumber","hospitalName","department","registeredBy"],j=["id","isCollected","collectionID"],k=["rowId"],M=["rowId"],w=new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2,useGrouping:!0}),S=()=>{const[e,t]=(0,n.useState)(0),[o,S]=(0,n.useState)(""),[z,O]=(0,n.useState)(""),[P,D]=(0,n.useState)(!1),[H,_]=(0,n.useState)([]),[W,L]=(0,n.useState)([]),[V,B]=(0,n.useState)(""),[T,F]=(0,n.useState)(!1),E=(0,i.A)(),G=/^[a-zA-Z0-9-]+$/,U=[{field:"id",headerName:"ID",flex:1},{field:"registeredOn",headerName:"Date",flex:1},{field:"referenceNo",headerName:"Reciept Number",flex:1},{field:"patientCardNumber",headerName:"Card Number",flex:1},{field:"patientName",headerName:"Patient Name",flex:1},{field:"paymentAmount",headerName:"Amount",flex:1,renderCell:e=>(e=>{const t=w.format(Math.abs(e));return e<0?"(".concat(t,")"):t})(e.row.paymentAmount)},{field:"paymentType",headerName:"Payment Method",flex:1},{field:"paymentReason",headerName:"Reason",flex:1},{field:"isReversed",headerName:"IsReversed",flex:1,renderCell:e=>{var t;return(null===e||void 0===e||null===(t=e.row)||void 0===t?void 0:t.isReversed)&&(0,R.jsxs)("p",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start",padding:0,marginTop:"0",color:"red",gap:"3px"},children:[(0,R.jsx)(C.A,{color:"error",fontSize:"small"}),(0,R.jsx)("span",{children:"Reversed"})]})}}],Z=async()=>{try{if(0===e&&o)H.length>0?(e=>{try{if(!e||0===e.length)return;const{patientCardNumber:t,hospitalName:r,department:n,registeredBy:i}=e[0],d=[["Card Number",t],["Hospital Name",r],["Department",n],["Cashier",i],[]],l=e.map((e=>{let{patientCardNumber:t,hospitalName:o,department:r,registeredBy:n}=e;return(0,a.A)(e,I)})),s=N.Wp.aoa_to_sheet(d);N.Wp.sheet_add_json(s,l,{origin:{r:d.length,c:0},skipHeader:!1});const c=N.Wp.decode_range(s["!ref"]);for(let e=c.s.c;e<=c.e.c;++e){const t=N.Wp.encode_cell({r:d.length,c:e});s[t]&&(s[t].s={font:{bold:!0},alignment:{horizontal:"center"},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}}}})}const u=N.Wp.book_new();N.Wp.book_append_sheet(u,s,"Patient Report of ".concat(o)),N._h(u,"Patient Report ".concat((new Date).toISOString().slice(0,10),".xlsx"))}catch(t){console.error("Excel export failed:",t)}})(H.map((e=>{let{id:t,isCollected:o,collectionID:r}=e;return(0,a.A)(e,j)}))):y.oR.error("Data is Empty.");else if(1===e&&z)if(W.length>0){if(null!==W&&void 0!==W&&W.some((e=>!0===e.isReversed)))return void y.oR.error("Reversed receipt can't be printed.");const e=await $(W||[]);(0,g.generatePDF)(e)}else y.oR.error("Data is Empty.")}catch(t){console.error("Printing Task Erro: ",t)}},$=async e=>{if(!e||0===e.length)return null;const t=e[0];return{refNo:null===t||void 0===t?void 0:t.referenceNo,id:null===t||void 0===t?void 0:t.id,cardNumber:null===t||void 0===t?void 0:t.patientCardNumber,recipt:null===t||void 0===t?void 0:t.recipt,patientName:null===t||void 0===t?void 0:t.patientName,hospitalName:null===t||void 0===t?void 0:t.hospitalName,department:null===t||void 0===t?void 0:t.department,amount:e.map((e=>({purpose:e.paymentReason,amount:e.paymentAmount}))),cbhiId:null===t||void 0===t?void 0:t.patientCBHI_ID,createdby:null===t||void 0===t?void 0:t.registeredBy,method:null===t||void 0===t?void 0:t.paymentType,digitalChannel:null===t||void 0===t?void 0:t.paymentChannel,trxref:null===t||void 0===t?void 0:t.paymentVerifingID,patientLoaction:null===t||void 0===t?void 0:t.patientWoreda,organization:null===t||void 0===t?void 0:t.patientWorkingPlace,employeeId:null===t||void 0===t?void 0:t.patientWorkID,description:null===t||void 0===t?void 0:t.paymentDescription,createdOn:null===t||void 0===t?void 0:t.registeredOn}};(0,n.useEffect)((()=>{S(""),O(""),F(!1),B(""),_([]),L([])}),[e]);return(0,R.jsxs)(d.A,{sx:{p:3,borderRadius:"2xl",boxShadow:3,marginInline:"15px"},children:[(0,R.jsxs)(l.A,{children:[(0,R.jsx)(s.A,{variant:"h5",gutterBottom:!0,children:0===e?"Find Patient By Card Number":"Generate Receipt by Receipt Number"}),(0,R.jsxs)(c.A,{value:e,onChange:(e,o)=>t(o),sx:{mb:2},TabIndicatorProps:{style:{backgroundColor:"#1976d2"}},children:[(0,R.jsx)(u.A,{icon:(0,R.jsx)(x.A,{}),label:"Report by Card Number",sx:{"&.Mui-selected":{color:"#a2b9f5"}}}),(0,R.jsx)(u.A,{icon:(0,R.jsx)(b.A,{}),label:"Receipt",sx:{"&.Mui-selected":{color:"#a2b9f5"}}})]}),(0,R.jsxs)(p.A,{display:"flex",alignItems:"center",gap:2,mb:3,children:[0===e?(0,R.jsx)(m.A,{label:"Card Number",variant:"outlined",value:o,onChange:e=>{F(!1),_([]),S(e.target.value)},fullWidth:!0,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===E.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===E.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===E.palette.mode?"#fff":"#000"},color:"dark"===E.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===E.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===E.palette.mode?"#fff":"#000"}}}}):(0,R.jsx)(m.A,{label:"Receipt Number",variant:"outlined",value:z,onChange:e=>{L([]),F(!1);const t=e.target.value;var o;o=t,!G.test(o)&&(null===o||void 0===o?void 0:o.length)>0?B("Please Insert Valid Receipt Number."):B(""),O(t)},fullWidth:!0,error:!!V,helperText:V,InputProps:{sx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===E.palette.mode?"#fff":"#000"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===E.palette.mode?"#fff":"#000"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"dark"===E.palette.mode?"#fff":"#000"},color:"dark"===E.palette.mode?"#fff":"#000"}},InputLabelProps:{sx:{color:"dark"===E.palette.mode?"#ccc":"#555","&.Mui-focused":{color:"dark"===E.palette.mode?"#fff":"#000"}}}}),!T&&(0,R.jsx)(v.A,{variant:"contained",size:"large",onClick:()=>(async()=>{try{if(D(!0),0===e&&o){var t,n;const e=await A.A.put("/Payment/payment-by-cardNumber",{patientCardNumber:o});if((null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.length)>0){var i;F(!0);const t=null===(i=e.data)||void 0===i?void 0:i.map((e=>{let{rowId:t}=e,o=(0,a.A)(e,k);return(0,r.A)({id:t},o)}));_(t)}else(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.length)<=0&&y.oR.info("Card Number Not Found.")}else if(1===e&&z){var d,l;const e=await A.A.put("/Payment/payment-by-refno",{paymentId:z});if((null===e||void 0===e||null===(d=e.data)||void 0===d?void 0:d.length)>0){var s;F(!0);const t=null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.map((e=>{let{rowId:t}=e,o=(0,a.A)(e,M);return(0,r.A)({id:t},o)}));L(t)}else(null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.length)<=0&&y.oR.info("Receipt Not Found.")}}catch(u){var c;console.error(u),y.oR.error((null===u||void 0===u||null===(c=u.response)||void 0===c?void 0:c.data)||"Internal Server Error."),F(!1)}finally{D(!1)}})(),disabled:P||(0===e?!o:!z)||!!V,children:P?(0,R.jsx)(f.A,{size:24}):"Search"}),T&&(0,R.jsx)(v.A,{variant:"contained",color:"secondary",size:"large",onClick:()=>Z(),children:P?(0,R.jsx)(f.A,{size:24}):"Print"})]}),(0,R.jsx)(h.z,{autoHeight:!0,rows:0===e?H:W,columns:U,disableRowSelectionOnClick:!0,sx:{minWidth:320}})]}),(0,R.jsx)(y.N9,{})]})}},98056:(e,t,o)=>{o.d(t,{A:()=>v});var r=o(58168),a=o(98587),n=o(65043),i=o(58387),d=o(98610),l=o(34535),s=o(98206),c=o(91066),u=o(70579);const p=["className","component"],m=(0,l.Ay)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({padding:16,"&:last-child":{paddingBottom:24}}))),v=n.forwardRef((function(e,t){const o=(0,s.b)({props:e,name:"MuiCardContent"}),{className:n,component:l="div"}=o,v=(0,a.A)(o,p),f=(0,r.A)({},o,{component:l}),h=(e=>{const{classes:t}=e;return(0,d.A)({root:["root"]},c.h,t)})(f);return(0,u.jsx)(m,(0,r.A)({as:l,className:(0,i.A)(h.root,n),ownerState:f,ref:t},v))}))}}]);
//# sourceMappingURL=7378.422a9f63.chunk.js.map